/** Copyright © 2005-2020 Apple Inc. All Rights Reserved. **/
experimentData={log_host:"log.optimizely.com",goal_expressions:{341615730:["^engagement$"]},experiments:{17260463425:{audiences:[17309783189],variation_weights:{17281613222:5001,17281482174:4999},name:"USAPCopyAdditions_Desk_CON_20200109p",enabled:!0,variation_ids:["17281613222","17281482174"],site_catalyst_evar:52,urls:[{match:"regex",value:".apple.com/shop/apw/checkout"}],enabled_variation_ids:["17281613222","17281482174"]},17266093545:{audiences:[17264466144],variation_weights:{17413630596:5e3,17273875841:5e3},name:"USAPCopyAdditions_MOW_CON_20200109p",enabled:!0,variation_ids:["17413630596","17273875841"],site_catalyst_evar:52,urls:[{match:"regex",value:".apple.com/shop/apw/checkout"}],enabled_variation_ids:["17413630596","17273875841"]}},audiences:{17264466144:{conditions:["and",["or",["or",{dimension_id:856271453,value:"var optlyaovtm = 0; //1 = ALWAYS ON, 0 = OBEY TIMER\nvar optlytmb = 1578559089000; //BEGIN TIME IN MILLISECONDS 05/05/2017 12:00:00 AM\nvar optlytme = 1582271999000; //END TIME IN MILLISECONDS 2/20/2020 11:59:59 PM PDT\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n//soft time logic \nvar optlytm = false; \nif(window.optimizely_tm >= optlytmb && window.optimizely_tm <= optlytme){\n\toptlytm = true;\n} \n\n//return val \noptlytm || optlyaovtm;"}]],["or",["or",{dimension_id:696316307,value:"android"},{dimension_id:696316307,value:"blackberry"},{dimension_id:696316307,value:"windows phone"},{dimension_id:696316307,value:"iphone"},{dimension_id:696316307,value:"mobile"}]],["or",["not",["or",{dimension_id:7973551847,value:"ipad"}]]]],name:"US AP Copy Add MOW"},862060009:{conditions:["and",{dimension_id:856271453,value:'window.optimizely.push(["activate"]);\nfalse;'}],name:"Trigger Manual Activation Call",segment_id:856540696},17309783189:{conditions:["and",["or",["or",{dimension_id:856271453,value:"var optlyaovtm = 0; //1 = ALWAYS ON, 0 = OBEY TIMER\nvar optlytmb = 1578559089000; //BEGIN TIME IN MILLISECONDS 02/06/2019 12:00:01 AM PST\nvar optlytme = 1582271999000; //END TIME IN MILLISECONDS 2/20/2020 11:59:59 PM PDT\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n//soft time logic \nvar optlytm = false; \nif(window.optimizely_tm >= optlytmb && window.optimizely_tm <= optlytme){\n\toptlytm = true;\n} \n\n//return val \noptlytm || optlyaovtm;"}]],["or",["or",{dimension_id:696316307,value:"ff"},{dimension_id:696316307,value:"ff2"},{dimension_id:696316307,value:"ff3"},{dimension_id:696316307,value:"ff4"},{dimension_id:696316307,value:"gc"},{dimension_id:696316307,value:"ie10"},{dimension_id:696316307,value:"ie8"},{dimension_id:696316307,value:"ie9"},{dimension_id:696316307,value:"opera"},{dimension_id:696316307,value:"safari3"},{dimension_id:696316307,value:"safari4"},{dimension_id:696316307,value:"safari5"},{dimension_id:696316307,value:"safari6"},{dimension_id:696316307,value:"safari7"},{dimension_id:696316307,value:"safari8"}],["or",{dimension_id:856271453,value:"window.navigator.userAgent.indexOf('Version/9') !== -1"}],["or",{dimension_id:856271453,value:"window.navigator.userAgent.indexOf('Version/10') !== -1"}],["or",{dimension_id:7973551847,value:"tablet"},{dimension_id:7973551847,value:"ipad"}],["or",{dimension_id:856271453,value:"window.navigator.userAgent.indexOf('Version/11') !== -1"}],["or",{dimension_id:856271453,value:"window.navigator.userAgent.indexOf('Version/12') !== -1"}],["or",{dimension_id:11498235908,value:"safari"}]],["or",["not",["or",{dimension_id:7973551847,value:"mobile"},{dimension_id:7973551847,value:"iphone"}]]]],name:"US AP Copy Add Desk"}},www_host:"app.optimizely.com",public_suffixes:{"apple.com":["secure2.store.apple.com"]},dimensions:{1464880010:{api_name:"LZ",condition_type:"custom_dimension",name:"Landing Zone",segment_id:1469580014},696316307:{condition_type:"browser"},11498235908:{condition_type:"browser_version"},856271453:{condition_type:"code"},7973551847:{condition_type:"device"}},version:"master-89-39-2.423775646656746440",admin_account_id:199382811,blacklisted_experiments:[15135280705,16866333634,14394740291,15106210180,15505690725,15517280519,16964280520,15299830431,14436940174,16852634575,16860903732,15291840726,16967870745,16887571727,16924820028,16934956197],project_id:341800575,revision:1272,summary_revenue_goal_id:341892035,installation_verified:!0,preview_host:"//optimizely.s3.amazonaws.com",api_host:"api.optimizely.com",variations:{17273875841:{code:"/* _optimizely_evaluate=force */\noptimizely.$('<style>.as-l-container.rs-checkout-action > .row > div > div{display: flex; flex-direction: column;} .as-l-container.rs-checkout-action > .row > div > div > .rs-checkout-applepay-button{order: 2} .as-l-container.rs-checkout-action > .row > div > div > #mvt-checkout-continuedisclaimer{order: 1} .as-l-container.rs-checkout-action > .row > div > div > .rs-checkout-continuedisclaimer{order: 3}.rs-checkout-action div + #mvt-checkout-continuedisclaimer{display: none;}.rs-checkout-action div .rs-checkout-applepay-button ~ #mvt-checkout-continuedisclaimer{display: block; padding-top: 0; padding-bottom: 14px;}</style>').appendTo('head');\n/* _optimizely_evaluate=safe */\n\noptimizely.$(\"<div class='rs-checkout-continuedisclaimer' id='mvt-checkout-continuedisclaimer'>Continue with Apple Pay to review and edit your order details. Don't worry, your card won't be charged yet.</div>\").insertAfter(optimizely.$('.rs-checkout-action .rs-checkout-applepay-button + #rs-checkout-continuedisclaimer-bottom'));",name:"Variation #1"},17413630596:{name:"Original"},17281482174:{code:"/* _optimizely_evaluate=force */\noptimizely.$('<style>.as-l-container.rs-checkout-action > .row > div > div{display: flex; flex-direction: column;} .as-l-container.rs-checkout-action > .row > div > div > .rs-checkout-applepay-button{order: 2} .as-l-container.rs-checkout-action > .row > div > div > #mvt-checkout-continuedisclaimer{order: 1} .as-l-container.rs-checkout-action > .row > div > div > .rs-checkout-continuedisclaimer{order: 3}.rs-checkout-action div + #mvt-checkout-continuedisclaimer{display: none;}.rs-checkout-action div .rs-checkout-applepay-button ~ #mvt-checkout-continuedisclaimer{display: block; padding-top: 0; padding-bottom: 14px;}</style>').appendTo('head');\n/* _optimizely_evaluate=safe */\n\noptimizely.$(\"<div class='rs-checkout-continuedisclaimer' id='mvt-checkout-continuedisclaimer'>Continue with Apple Pay to review and edit your order details. Don't worry, your card won't be charged yet.</div>\").insertAfter(optimizely.$('.rs-checkout-action .rs-checkout-applepay-button + #rs-checkout-continuedisclaimer-bottom'));",name:"Variation #1"},17281613222:{name:"Original"}},project_js:"\n",segments:{341793217:{segment_value_type:"source_type",api_name:"optimizely_source_type",id:341793217,name:"Source Type"},1469580014:{api_name:"LZ",is_api_only:!0,dimension_id:1464880010,id:1469580014,name:"Landing Zone"},856540696:{audience_id:862060009,api_name:"trigger_manual_activation_call_2_2_3_1",id:856540696,name:"Trigger Manual Activation Call"},341824156:{segment_value_type:"browser",api_name:"optimizely_browser",id:341824156,name:"Browser"},341794206:{segment_value_type:"mobile",api_name:"optimizely_mobile",id:341794206,name:"Mobile Visitors"},341932127:{segment_value_type:"campaign",api_name:"optimizely_campaign",id:341932127,name:"Campaign"}}},function(){var asyncRequest={},preview_loader={},integrator={},api={},distributor={},query={},id={},redirect={},detect={},directive={},json={},tracker={},condition={facade:{}},template={},visitor={},activator={},rule_builder={},main={},rules={},feature_detect={},cookie={},user={},iapi={},evaluator={},data={},dcp={},asyncInfo={},segmenter={},timer={},optly={murmur3:{},Visitor:{},taint:{},nativity:{},timeAndDayInterval:{},client:{third_party:{},geolocation:{},rum:{RumCollector:{}},storage:{Storage:{}},diagnostic:{},Facade:{},preview:{Logger:{}}},CIDR:{},Cleanse:{},match:{},hashing:{}},common={},behavior={Policy:{},FIELDS:{},Store:{},Event:{},EventBase:{}},useragent={},plan={};geolocation={},optly.client.geolocation.makeRequest=function(e,t,i){geolocation.cdn3Requested=+new Date,optly.client.geolocation.addScriptTag(e)},optly.client.geolocation.addScriptTag=function(e){var t=document.head||document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,t.insertBefore(i,t.firstChild)},geolocation.requestGeo=optly.client.geolocation.makeRequest,optly.nativity.getNativeGetElementsByClassName=function(){var e=document.getElementsByClassName;if(!optly.nativity.isNativeFunction(e)){var t=(window.optimizely||{}).getElementsByClassName,i=(window.optly||{}).getElementsByClassName;e=optly.nativity.isNativeFunction(t)?t:optly.nativity.isNativeFunction(i)?i:null}return e},optly.nativity.isNativeFunction=function(e){return e&&-1!==String(e).indexOf("[native code]")},optly.Cleanse.each=function(e,t,i){var n=!!Object.prototype.__lookupGetter__,r=!!Object.prototype.__lookupSetter__;for(var a in e)if(e.hasOwnProperty(a)){var o=n?e.__lookupGetter__(a):null,s=r?e.__lookupSetter__(a):null;try{var c=o?null:e[a];t.call(i,a,c,o,s)}catch(e){}}},optly.Cleanse.finish=function(){if(optly.Cleanse.running){optly.Cleanse.running=!1,optly.Cleanse.each(optly.Cleanse.types,function(i,n){if(Object.prototype.__defineGetter__){var e=optly.Cleanse.getters[i];optly.Cleanse.each(e,function(e,t){n.prototype.__defineGetter__(e,t),optly.Cleanse.log("restored getter",i,e)})}if(Object.prototype.__defineSetter__){var t=optly.Cleanse.setters[i];optly.Cleanse.each(t,function(e,t){n.prototype.__defineSetter__(e,t),optly.Cleanse.log("restored setter",i,e)})}var r=optly.Cleanse.properties[i];optly.Cleanse.each(r,function(e,t){n.prototype[e]=t,optly.Cleanse.log("restored property",i,e)})}),optly.Cleanse.unfixGetElementsByClassName(),optly.Cleanse.log("finish");var e=window.console,t="optimizely_log=true";if((-1!==window.location.hash.indexOf(t)||-1!==window.location.search.indexOf(t))&&e&&e.log)for(var i=optly.Cleanse.logs,n=0;n<i.length;n++)e.log(i[n])}},optly.Cleanse.log=function(e,t,i){t?(t=t.replace(/_/g,""),optly.Cleanse.logs.push("Optimizely / Info / Cleanse / "+e+": "+t+"."+i)):optly.Cleanse.logs.push("Optimizely / Info / Cleanse / "+e)},optly.Cleanse.start=function(){var e=window.location.hostname;if(-1===e.indexOf("optimizely")||-1!==e.indexOf("edit")||-1!==e.indexOf("preview")||-1!==e.indexOf("test"))if(optly.Cleanse.running)optly.Cleanse.log("already running so didn't start");else{for(var t in optly.Cleanse.log("start"),optly.Cleanse.running=!0,optly.Cleanse.types)optly.Cleanse.types[t]||delete optly.Cleanse.types[t];optly.Cleanse.each(optly.Cleanse.types,function(r,a){optly.Cleanse.getters[r]={},optly.Cleanse.properties[r]={},optly.Cleanse.setters[r]={},optly.Cleanse.each(a.prototype,function(e,t,i,n){optly.nativity.isNativeFunction(t)||optly.nativity.isNativeFunction(i)||optly.nativity.isNativeFunction(n)?optly.Cleanse.log("ignore native code",r,e):(i?(optly.Cleanse.getters[r][e]=i,optly.Cleanse.log("cleansed getter",r,e)):(optly.Cleanse.properties[r][e]=t,optly.Cleanse.log("cleansed property",r,e)),n&&(optly.Cleanse.setters[r][e]=n,optly.Cleanse.log("cleansed setter",r,e)),delete a.prototype[e])})}),optly.Cleanse.fixGetElementsByClassName(),optly.Cleanse.hasRunStart=!0}},optly.Cleanse.fixGetElementsByClassName=function(){if(!optly.nativity.isNativeFunction(document.getElementsByClassName)){var e=optly.nativity.getNativeGetElementsByClassName();e?(optly.Cleanse.getElementsByClassName=document.getElementsByClassName,document.getElementsByClassName=e):optly.Cleanse.log("Error: native HTMLElement.prototype.getElementsByClassName missing")}},optly.Cleanse.unfixGetElementsByClassName=function(){optly.Cleanse.getElementsByClassName&&(document.getElementsByClassName=optly.Cleanse.getElementsByClassName,optly.Cleanse.getElementsByClassName=null)},optly.Cleanse.getElementsByClassName=null,optly.Cleanse.getters={},optly.Cleanse.logs=[],optly.Cleanse.properties={},optly.Cleanse.setters={},optly.Cleanse.types={Object_:Object},window.optly=window.optly||{},window.optly.Cleanse={finish:optly.Cleanse.finish,logs:optly.Cleanse.logs,start:optly.Cleanse.start},optly.Cleanse.start();var $=jQuery,optimizelyCode=function(){var DATA=experimentData,asyncRequest={},preview_loader={},integrator={},api={},distributor={},query={},id={},redirect={},detect={},directive={},json={},tracker={},condition={facade:{}},template={},visitor={},activator={},rule_builder={},main={},rules={},feature_detect={},cookie={},user={},iapi={},evaluator={},data={},dcp={},asyncInfo={},segmenter={},timer={},optly={murmur3:{},Visitor:{},taint:{},nativity:{},timeAndDayInterval:{},client:{third_party:{},geolocation:{},rum:{RumCollector:{}},storage:{Storage:{}},diagnostic:{},Facade:{},preview:{Logger:{}}},CIDR:{},Cleanse:{},match:{},hashing:{}},common={},behavior={Policy:{},FIELDS:{},Store:{},Event:{},EventBase:{}},useragent={},plan={},COMPILED=!1,goog=goog||{};goog.global=this,goog.DEBUG=!0,goog.LOCALE="en",goog.provide=function(e){if(!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e];for(var t=e;(t=t.substring(0,t.lastIndexOf(".")))&&!goog.getObjectByName(t);)goog.implicitNamespaces_[t]=!0}goog.exportPath_(e)},goog.setTestOnly=function(e){if(COMPILED&&!goog.DEBUG)throw e=e||"",Error(": "+e)},COMPILED||(goog.isProvided_=function(e){return!goog.implicitNamespaces_[e]&&!!goog.getObjectByName(e)},goog.implicitNamespaces_={}),goog.exportPath_=function(e,t,i){var n,r=e.split("."),a=i||goog.global;r[0]in a||!a.execScript||a.execScript("var "+r[0]);for(;r.length&&(n=r.shift());)!r.length&&goog.isDef(t)?a[n]=t:a=a[n]?a[n]:a[n]={}},goog.getObjectByName=function(e,t){for(var i,n=e.split("."),r=t||goog.global;i=n.shift();){if(!goog.isDefAndNotNull(r[i]))return null;r=r[i]}return r},goog.globalize=function(e,t){var i=t||goog.global;for(var n in e)i[n]=e[n]},goog.addDependency=function(e,t,i){if(!COMPILED){for(var n,r,a=e.replace(/\\/g,"/"),o=goog.dependencies_,s=0;n=t[s];s++)(o.nameToPath[n]=a)in o.pathToNames||(o.pathToNames[a]={}),o.pathToNames[a][n]=!0;for(var c=0;r=i[c];c++)a in o.requires||(o.requires[a]={}),o.requires[a][r]=!0}},goog.ENABLE_DEBUG_LOADER=!0,goog.require=function(e){if(!COMPILED){if(goog.isProvided_(e))return;if(goog.ENABLE_DEBUG_LOADER){var t=goog.getPathFromDeps_(e);if(t)return goog.included_[t]=!0,void goog.writeScripts_()}var i="goog.require could not find: "+e;throw goog.global.console&&goog.global.console.error(i),Error(i)}},goog.basePath="",goog.global.CLOSURE_BASE_PATH,goog.global.CLOSURE_NO_DEPS=!0,goog.global.CLOSURE_IMPORT_SCRIPT,goog.nullFunction=function(){},goog.identityFunction=function(e,t){return e},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],!COMPILED&&goog.ENABLE_DEBUG_LOADER&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var e=goog.global.document;return void 0!==e&&"write"in e},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var e=goog.global.document.getElementsByTagName("script"),t=e.length-1;0<=t;--t){var i=e[t].src,n=i.lastIndexOf("?"),r=-1==n?i.length:n;if("base.js"==i.substr(r-7,7))return void(goog.basePath=i.substr(0,r-7))}},goog.importScript_=function(e){var t=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[e]&&t(e)&&(goog.dependencies_.written[e]=!0)},goog.writeScriptTag_=function(e){return!!goog.inHtmlDocument_()&&(goog.global.document.write('<script type="text/javascript" src="'+e+'"><\/script>'),!0)},goog.writeScripts_=function(){var i=[],n={},r=goog.dependencies_;function a(e){if(!(e in r.written))if(e in r.visited)e in n||(n[e]=!0,i.push(e));else{if(r.visited[e]=!0,e in r.requires)for(var t in r.requires[e])if(!goog.isProvided_(t)){if(!(t in r.nameToPath))throw Error("Undefined nameToPath for "+t);a(r.nameToPath[t])}e in n||(n[e]=!0,i.push(e))}}for(var e in goog.included_)r.written[e]||a(e);for(var t=0;t<i.length;t++){if(!i[t])throw Error("Undefined script input");goog.importScript_(goog.basePath+i[t])}},goog.getPathFromDeps_=function(e){return e in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[e]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js")),goog.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var i=Object.prototype.toString.call(e);if("[object Window]"==i)return"object";if("[object Array]"==i||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==i||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t},goog.isDef=function(e){return void 0!==e},goog.isNull=function(e){return null===e},goog.isDefAndNotNull=function(e){return null!=e},goog.isArray=function(e){return"array"==goog.typeOf(e)},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isString=function(e){return"string"==typeof e},goog.isBoolean=function(e){return"boolean"==typeof e},goog.isNumber=function(e){return"number"==typeof e},goog.isFunction=function(e){return"function"==goog.typeOf(e)},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.removeUid=function(e){"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_)
/** @preserveTry */;try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();var i="array"==t?[]:{};for(var n in e)i[n]=goog.cloneObject(e[n]);return i}return e},goog.bindNative_=function(e,t,i){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(t,i,e){if(!t)throw new Error;if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,n),t.apply(i,e)}}return function(){return t.apply(i,arguments)}},goog.bind=function(e,t,i){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var e=Array.prototype.slice.call(arguments);return e.unshift.apply(e,i),t.apply(this,e)}},goog.mixin=function(e,t){for(var i in t)e[i]=t[i]},goog.now=Date.now||function(){return+new Date},goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),void 0!==goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(e);else{var t=goog.global.document,i=t.createElement("script");i.type="text/javascript",i.defer=!1,i.appendChild(t.createTextNode(e)),t.body.appendChild(i),t.body.removeChild(i)}}},goog.evalWorksForGlobals_=null,goog.cssNameMapping_,goog.cssNameMappingStyle_,goog.getCssName=function(e,t){var i,r=function(e){return goog.cssNameMapping_[e]||e};return i=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?r:function(e){for(var t=e.split("-"),i=[],n=0;n<t.length;n++)i.push(r(t[n]));return i.join("-")}:function(e){return e},t?e+"-"+i(t):i(e)},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},goog.global.CLOSURE_CSS_NAME_MAPPING,!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.getMsg=function(e,t){var i=t||{};for(var n in i){var r=(""+i[n]).replace(/\$/g,"$$$$");e=e.replace(new RegExp("\\{\\$"+n+"\\}","gi"),r)}return e},goog.exportSymbol=function(e,t,i){goog.exportPath_(e,t,i)},goog.exportProperty=function(e,t,i){e[t]=i},goog.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new i,e.prototype.constructor=e},goog.base=function(e,t,i){var n=arguments.callee.caller;if(n.superClass_)return n.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1));for(var r=Array.prototype.slice.call(arguments,2),a=!1,o=e.constructor;o;o=o.superClass_&&o.superClass_.constructor)if(o.prototype[t]===n)a=!0;else if(a)return o.prototype[t].apply(e,r);if(e[t]===n)return e.constructor.prototype[t].apply(e,r);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(e){e.call(goog.global)},json.stringify=function(e){try{return window.JSON.stringify(e)}catch(e){throw new Error("JSON: Unable to stringify ("+e.message+")")}},json.parse=function(e){try{return window.JSON.parse(e)}catch(e){throw new Error("JSON: Unable to parse ("+e.message+")")}},optly.client.preview.ENABLED=!1,optly.client.preview.Logger.log=[],optly.client.preview.Logger.reasons={},optly.client.preview.Logger.addEvent=optly.client.preview.ENABLED?function(e,t){t=extend(t||{},{message:e,date:(new Date).getTime()}),optly.client.preview.Logger.log.push(t)}:goog.nullFunction,optly.client.preview.Logger.setReason=optly.client.preview.ENABLED?function(e,t){optly.client.preview.Logger.reasons[e]=t}:goog.nullFunction,optly.client.preview.Logger.getReason=optly.client.preview.ENABLED?function(e){return optly.client.preview.Logger.reasons[e]}:goog.nullFunction,optly.client.preview.Logger.deleteReason=optly.client.preview.ENABLED?function(e){delete optly.client.preview.Logger.reasons[e]}:goog.nullFunction,optly.client.preview.Logger.clear=optly.client.preview.ENABLED?function(){optly.client.preview.Logger.log=[]}:goog.nullFunction,data.getAdminAccountId=function(){return data.getProperty("admin_account_id")},data.getAudience=function(e){return data.getProperty("audiences",e)},data.getAudienceProperty=function(e,t){return data.getProperty("audiences",e,t)},data.getAudiences=function(){return data.getProperty("audiences")},data.getAudienceSegmentId=function(e){var t=data.getAudienceProperty(e,"segment_id");return t||null},data.getClickGoals=function(){if(!data.clickGoalsWithSeparatedSelectors){var e=data.getProperty("click_goals")||[];data.clickGoalsWithSeparatedSelectors=[];for(var t=0,i=e.length;t<i;t++)for(var n=e[t],r=n.selector.split(SELECTOR_DELIMITER),a=0,o=r.length;a<o;a++){var s=r[a];if(s){var c={event_name:n.event_name,selector:s};"experiments"in n?c.experiments=n.experiments:"url_conditions"in n&&(c.url_conditions=n.url_conditions),"revenue"in n&&(c.revenue=n.revenue),data.clickGoalsWithSeparatedSelectors.push(c)}}}return data.clickGoalsWithSeparatedSelectors},data.getConditions=function(e,t){switch(t){case"experiment":return data.getExperimentConditions(e);case"segment":return data.getSegmentConditions(e);default:return[]}},data.usesAudiences=function(e){return!(data.getExperimentConditions(e)||data.getSegmentConditions(e))},data.getCustomRevenueGoals=function(){return data.getProperty("custom_revenue_goals")},data.getDCPServiceId=function(){return data.getProperty("dcp_service_id")||null},data.dcpKeyfieldLocator,data.getDCPKeyfieldLocators=function(){return data.getProperty("dcp_keyfield_locators")||[]},data.getSummaryRevenueGoalId=function(){return data.getProperty("summary_revenue_goal_id")||null},data.getDimension=function(e){return data.getProperty("dimensions",e)},data.getDimensions=function(){return data.getProperty("dimensions")||{}},data.getDimensionIdByApiName=function(e){for(var t in data.getDimensions())if(e===data.getDimensionApiName(t))return t;return null},data.getDimensionProperty=function(e,t){return data.getProperty("dimensions",e,t)},data.getDimensionApiName=function(e){var t=data.getDimensionProperty(e,"api_name");return t||null},data.getDimensionType=function(e){var t=data.getDimensionProperty(e,"condition_type");return t||null},data.getDimensionName=function(e){var t=data.getDimensionProperty(e,"name");return t||null},data.getDimensionSegmentId=function(e){var t=data.getDimensionProperty(e,"segment_id");return t||null},data.getEnabledExperimentIds=function(){return data.cachedEnabledExperimentIds||(data.cachedEnabledExperimentIds=filter(data.getExperimentIds(),data.isExperimentEnabled)),data.cachedEnabledExperimentIds},data.getEnabledVariationIds=function(e){return data.getExperimentProperty(e,"enabled_variation_ids")||[]},data.getExperimentAudienceIds=function(e){return data.getExperimentProperty(e,"audiences")||[]},data.getExperimentCode=function(e){return data.getExperimentProperty(e,"code")||""},data.getExperimentStatus=optly.client.preview.ENABLED?function(e){return data.getExperimentProperty(e,"status")}:goog.nullFunction,data.getExperimentConditions=function(e){return data.getExperimentProperty(e,"conditions")},data.getExperimentUrls=function(e){return data.getExperimentProperty(e,"urls")},data.getGoalExpressions=function(){return data.getProperty("goal_expressions")},data.getLegacyUUID=function(){return data.getProperty("legacy_uuid")||!1},data.getMatchingGoalIds=function(e){var t=data.getGoalExpressions(),i=[];for(var n in t)if(t.hasOwnProperty(n))for(var r=t[n],a=0;a<r.length;a++)try{if(new RegExp(r[a],"i").test(e)){i.push(n);break}}catch(e){}return i},data.getProjectClickGoalsWithCustomTargeting=function(){return filter(data.getClickGoals(),function(e){return!e.experiments&&condition.testUrls(e.url_conditions||[])})},data.getSegmentIdByIdentifier=function(e){var t=data.getSegments();for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];if(n&&n.api_name===e)return String(i)}return null},data.getSegementIsDefault=optly.client.preview.ENABLED?function(e){return data.getSegmentProperty(e,"is_default")||!1}:goog.nullFunction,data.getSegment=function(e){return data.getSegments()[e]},data.getSegmentAPIOnly=function(e){return data.getSegmentProperty(e,"is_api_only")||!1},data.getSegmentAudienceId=function(e){return data.getSegmentProperty(e,"audience_id")},data.getSegmentConditions=function(e){return data.getSegmentProperty(e,"add_condition")},data.getSegmentIdentifier=function(e){return data.getSegmentProperty(e,"api_name")||""},data.getSegmentName=function(e){return data.getSegmentProperty(e,"name")||"Seg "+e},data.getSegmentValueType=function(e){return data.getSegmentProperty(e,"segment_value_type")||""},data.getUrlConditions=function(e){var t=data.getExperimentConditions(e),i=[];return each(t,function(e){"url"===e.type&&i.push(t)}),i},data.getExperimentCss=function(e){return data.getExperimentProperty(e,"css")||""},data.getExperimentEvents=function(t){var i={};each(data.getExperimentProperty(t,"events")||{},function(e,t){i[e]=[t]});for(var e=filter(data.getClickGoals(),function(e){return"experiments"in e&&t in e.experiments}),n=0;n<e.length;n++){var r=e[n];i[r.selector]||(i[r.selector]=[]),i[r.selector].push({eventName:r.event_name,revenue:r.revenue,experimentIds:r.experiments})}return i},data.getExperiments=function(){return data.getProperty("experiments")||{}},data.getBlacklistedExperiments=function(){return data.getProperty("blacklisted_experiments")||{}},data.getExperimentIds=function(){return keys(data.getProperty("experiments")||{})},data.getExperimentIgnorePercentage=function(e){return data.getExperimentProperty(e,"ignore")||0},data.isExperimentManuallyActivated=function(e){return"manual"===data.getExperimentProperty(e,"activation_mode")},data.isExperimentConditionallyActivated=function(e){return"conditional"===data.getExperimentProperty(e,"activation_mode")},data.getConditionalActivationCode=function(e){return data.getExperimentProperty(e,"conditional_code")},data.getExperimentName=function(e){return data.getExperimentProperty(e,"name")||"Exp "+e},data.getExperimentString=function(e){return'experiment "'+data.getExperimentName(e)+'" ('+e+")"},data.getExperimentSectionIds=function(e){return data.getExperimentProperty(e,"section_ids")||[]},data.getExperimentVariationIds=function(e){return data.getExperimentProperty(e,"variation_ids")||[]},data.getExperimentVariationWeights=function(e){return data.getExperimentProperty(e,"variation_weights")||{}},data.getExperimentSteps=function(e){return data.getExperimentProperty(e,"steps")},data.getGoogleAnalyticsSlot=function(e){var t=data.getGoogleAnalyticsProperty(e),i=0;return isDefined(t)&&(i=t.slot||i),i},data.getGoogleAnalyticsTracker=function(e){var t=data.getGoogleAnalyticsProperty(e),i="";return isDefined(t)&&(i=t.tracker||i),i},data.getInsecurePreview=function(){return!!data.getProperty("insecure_preview")},data.getIPAnonymization=function(){return!!data.getProperty("ip_anonymization")},data.getListTargetedKey=function(e){return data.getListTargetedKeys()[e]},data.getListTargetedKeys=function(){return data.getProperty("list_targeted_keys")||{}},data.getLogUrlRoot=function(){return data.getUrlRoot("log_host",data.getProjectId())+"/event"},data.getPreviewHost=function(){return data.getProperty("preview_host")},data.getProjectId=function(){return data.getProperty("project_id")},data.getProjectCode=function(){return data.getProperty("project_js")},data.getRevision=function(){return data.getProperty("revision")},data.getSectionIds=function(){return keys(data.getProperty("sections")||{})},data.getSegments=function(){return data.getProperty("segments")||{}},data.getSegmentIds=function(){return keys(data.getSegments())},data.getExperimentVariationSectionId=function(e,t){for(var i=data.getExperimentSectionIds(e),n=0;n<i.length;n++){if(arrayContains(data.getSectionVariationIds(i[n]),t))return i[n]}return""},data.getPublicSuffix=function(e){var i={};return each(data.getProperty("public_suffixes")||{},function(t,e){each(e,function(e){i[e]=t})}),data.getPublicSuffix=function(e){return i[e]||""},data.getPublicSuffix.call(null,e)},data.getSectionName=function(e){return data.getSectionProperty(e,"name")||"Sec "+e},data.getSectionVariationIds=function(e){return data.getSectionProperty(e,"variation_ids")||[]},data.getSiteCatalystEVar=function(e){return data.getExperimentProperty(e,"site_catalyst_evar")||null},data.getSiteCatalystProp=function(e){return data.getExperimentProperty(e,"site_catalyst_prop")||null},data.getVariations=function(){return data.getProperty("variations")||{}},data.getVariationIds=function(){return keys(data.getProperty("variations")||{})},data.getVariationCode=function(e){var i=[];return each(e.split(VARIATION_ID_DELIMITER),function(e){var t=data.getVariationProperty(e,"code");t&&i.push(t)}),i.join("\n")},data.UrlMatchCondition,data.VariationPage,data.getVariationPages=function(e){return data.getVariationProperty(e,"pages")},data.getVariationExperimentId=function(e){if(!data.cachedVariationExperimentIds){var i={};each(data.getExperimentIds(),function(t){each(data.getExperimentSectionIds(t),function(e){each(data.getSectionVariationIds(e),function(e){i[e]=t})}),each(data.getExperimentVariationIds(t),function(e){i[e]=t})}),data.cachedVariationExperimentIds=i}var t=e.split(VARIATION_ID_DELIMITER);return data.cachedVariationExperimentIds[t[0]]||""},data.getVariationIdByIndex=function(e,t){var i=data.getExperimentVariationIds(e),n=null;try{n=i[t]}catch(e){}return n},data.getVariationIndex=function(e){var t=data.getVariationExperimentId(e),i=data.getExperimentSectionIds(t);if(0===i.length){for(var n=data.getExperimentVariationIds(t),r=0;r<n.length;r++)if(n[r]===e)return r}else{for(var a=e.split(VARIATION_ID_DELIMITER),o=[],s=0;s<i.length;s++)for(var c=i[s],l=data.getSectionVariationIds(c),d=0;d<l.length;d++){l[d]===a[s]&&o.push(d)}if(o!==[])return o}return-1},data.getVariationName=function(e,t){return t=t||", ",data.getVariationNamesArray(e).join(t)},data.getVariationNamesArray=function(e){var t=[];return each(e.split(VARIATION_ID_DELIMITER),function(e){t.push(data.getVariationProperty(e,"name")||"Var "+e)}),t},data.getVariationSectionId=function(e){var i={};return each(data.getSectionIds(),function(t){each(data.getSectionVariationIds(t),function(e){i[e]=t})}),data.getVariationSectionId=function(e){var t=e.split(VARIATION_ID_DELIMITER);return i[t[0]]||""},data.getVariationSectionId.call(null,e)},data.getVersion=function(){return data.getProperty("version")},data.getWebHost=function(){return data.getProperty("www_host")},data.isProductionHost=function(){return/\.optimizely\.(?!test)[^.]+$/.test(data.getWebHost())},data.isExperimentEnabled=function(e){return!!data.getExperimentProperty(e,"enabled")},data.isChartbeatEnabled=function(e){return!!data.getChartbeatProperty(e)},data.isClickTaleEnabled=function(e){return!!data.getClickTaleProperty(e)},data.isComscoreEnabled=function(e){return!!data.getComscoreProperty(e,"url")},data.isCrazyEggEnabled=function(e){return!!data.getCrazyEggProperty(e)},data.isForceVariationEnabled=function(){return!!data.getProperty("force_variation")},data.isGeotargetingEnabled=function(e){return!!data.getGeotargetingProperty(e)},data.isGoogleAnalyticsEnabled=function(e){return!!data.getGoogleAnalyticsProperty(e)},data.isUniversalAnalyticsEnabled=function(e){return!!data.getUniversalAnalyticsProperty(e,"slot")},data.isInstallationVerified=function(){return!!data.getProperty("installation_verified")},data.isInspectletEnabled=function(e){return!!data.getInspectletProperty(e)},data.isKissMetricsEnabled=function(){return!!data.getProperty("kissmetrics")},data.isListTargetingEnabled=function(){return!!data.getProperty("uses_list_targeting")},data.isMixpanelEnabled=function(e){return!!data.getMixpanelProperty(e)},data.isMoatEnabled=function(e){return!!data.getMoatProperty(e)},data.isSessioncamEnabled=function(e){return!!data.getSessioncamProperty(e)},data.isATInternetEnabled=function(e){return!!data.getExperimentProperty(e,"at_internet")},data.isRemotePublicSuffixEnabled=function(){return!!data.getProperty("remote_public_suffix")},data.isSimpleCookiesEnabled=function(){return!!data.getProperty("simple_cookies")},data.isStagingLogEnabled=function(){return!!data.getProperty("use_staging_log")},data.isDynamicCustomerProfileTargetingEnabled=function(){return!!data.getProperty("uses_dynamic_customer_profile_targeting")},data.getExperimentProperty=function(e,t){return data.getProperty("experiments",e,t)},data.getChartbeatProperty=function(e){return data.getExperimentProperty(e,"chartbeat")},data.getRedirectTimeout=function(){return data.getProperty("redirect_timeout")||REDIRECT_COOKIE_SECONDS},data.getClickTaleProperty=function(e){return data.getExperimentProperty(e,"clicktale")},data.getComscoreProperty=function(e,t){var i=data.getExperimentProperty(e,"comscore");return isDefined(i)?i[t]:null},data.getCrazyEggProperty=function(e){return data.getExperimentProperty(e,"crazyegg")},data.getGeotargetingProperty=function(e){var t="uses_geotargeting";return data.getExperimentProperty(e,t)||data.getSegmentProperty(e,t)},data.getGoogleAnalyticsProperty=function(e){return data.getExperimentProperty(e,"google_analytics")},data.getUniversalAnalyticsProperty=function(e,t){var i=data.getExperimentProperty(e,"universal_analytics");return isDefined(i)?i[t]:null},data.getInspectletProperty=function(e){return data.getExperimentProperty(e,"inspectlet")},data.getMixpanelProperty=function(e){return data.getExperimentProperty(e,"mixpanel")},data.getMoatProperty=function(e){return data.getExperimentProperty(e,"moat")},data.getSessioncamProperty=function(e){return data.getExperimentProperty(e,"sessioncam")},data.getProperty=function(e){var i=DATA;if(null!==each(arguments,function(e){var t=i[e];if(!isDefined(t))return null;i=t}))return i},data.getSectionProperty=function(e,t){return data.getProperty("sections",e,t)},data.getSegmentProperty=function(e,t){return data.getProperty("segments",e,t)},data.getUrlRoot=function(e,t){var i=data.getProperty(e);return t&&(i=t.toString()+"."+i),"https://"+i},data.getVariationProperty=function(e,t){return data.getProperty("variations",e,t)},data.rumSamplingRate=function(){var e=data.getProperty("rum_sampling_rate");return isDefined(e)?e:.003},data.isBehaviorEnabled=function(){return!!data.getProperty("is_behavior_enabled")},data.hasSlave=function(){return!!data.getProperty("slave")},data.clickGoalsWithSeparatedSelectors=null,data.cachedEnabledExperimentIds=null,data.cachedVariationExperimentIds=null,cookie.delimiterPattern=/\s*;\s*/,cookie.valuePattern=/^([^=]+)=?(.*)$/,cookie.get=function(t){var i=[];return each(cookie.getAll(),function(e){t===e.name&&i.push(safeDecodeUriComponent(e.value))}),0===i.length?null:(1<i.length&&log("Cookie","Values found for %s: %s",t,i.length),i.pop())},cookie.initialized=!1,cookie.initialize=function(){if(cookie.initialized)log("Cookie","Already initialized.");else{log("Cookie","Initializing.");var e=document.location.hostname;data.isSimpleCookiesEnabled()?(cookie.highestLevelDomain=e,cookie.possibleDomains=cookie.findPossibleDomains(),0<cookie.possibleDomains.length?(cookie.highestLevelDomain=cookie.possibleDomains[0],log("Cookie","Highest level domain: %s",cookie.highestLevelDomain)):(log("Cookie","Disabling event tracking because cookies could not be set"),directive.shouldTrackEvents=!1)):(cookie.guessedPublicSuffix=cookie.guessPublicSuffix(e),log("Cookie","Guessed public suffix: %s",cookie.guessedPublicSuffix),cookie.publicSuffix=data.getPublicSuffix(e),log("Cookie","Public suffix (from data): %s",cookie.publicSuffix)),cookie.apiPublicSuffix&&log("Cookie","Domain specified by API: %s",cookie.apiPublicSuffix),cookie.initialized=!0,log("Cookie","Done initializing.")}},cookie.remove=function(e){cookie.deleteFromDomain(e,cookie.getCurrentSuffix())},cookie.getAll=function(i){var n=[];return i=i||"",each((document.cookie||"").split(cookie.delimiterPattern),function(e){var t=e.match(cookie.valuePattern);t&&0===t[1].indexOf(i)&&n.push({name:t[1],value:t[2],raw:e})}),n},cookie.set=function(e,t,i){if(cookie.initialize(),t=t||"",data.isSimpleCookiesEnabled())cookie.setUsingSimpleLogic(e,t,i);else{var n=cookie.getCurrentSuffix(),r=document.location.hostname;!cookie.publicSuffix&&data.isRemotePublicSuffixEnabled()&&cookie.queue.push({age:i,name:e,value:t}),n&&n===cookie.publicSuffix&&n!==cookie.guessedPublicSuffix&&(cookie.deleteFromDomain(e,r),cookie.deleteFromDomain(e,cookie.guessedPublicSuffix)),cookie.setOnDomain(e,t,n,i);var a=cookie.get(e);a===t?log("Cookie","Successfully set %s=%s on %s",e,t,n):(log("Cookie","Setting %s on %s apparently failed (%s != %s)",e,n,a,t),log("Cookie","Setting %s on %s",e,r),cookie.setOnDomain(e,t,r,i),(a=cookie.get(e))===t?(log("Cookie","Setting %s on %s worked; saving as new public suffix",e,r),cookie.guessedPublicSuffix=r):(log("Cookie","Could not set cookie %s, disabling event tracking.",e),directive.shouldTrackEvents=!1))}},cookie.deleteFromDomain=function(e,t){var i=[e,"=","; ",cookie.formatDomainString(t),"; path=/","; expires=",new Date(0).toUTCString()];document.cookie=i.join("")},cookie.findPossibleDomains=function(){for(var e=document.location.hostname.split("."),t=[],i=e.length-1;0<=i;--i){var n=e.slice(i).join("."),r=DOMAIN_TEST_COOKIE_NAME_PREFIX+generateRandomHexString(),a=generateRandomHexString();cookie.setOnDomain(r,a,n,DOMAIN_TEST_COOKIE_EXPIRATION),cookie.get(r)===a&&t.push(n)}return t},cookie.getCurrentSuffix=function(){return data.isSimpleCookiesEnabled()?cookie.apiPublicSuffix||cookie.highestLevelDomain:cookie.apiPublicSuffix||cookie.publicSuffix||cookie.guessedPublicSuffix},cookie.formatDomainString=function(e){var t=[];return t.push("domain="),"localhost"!==e&&(t.push("."),t.push(e)),t.join("")},cookie.guessPublicSuffix=function(e){var t=e.split("."),i=e,n=t[t.length-1];return 2<t.length&&"appspot"===t[t.length-2]&&"com"===n?i=t[t.length-3]+".appspot.com":1<t.length&&inArray(n,TOP_LEVEL_DOMAINS)&&(i=t[t.length-2]+"."+n),i},cookie.setOnDomain=function(e,t,i,n){var r=[e,"=",encodeURIComponent(t),"; ",cookie.formatDomainString(i),"; path=/"];if(n){var a=new Date(+new Date+1e3*n);r.push("; expires=",a.toUTCString())}document.cookie=r.join("")},cookie.setUsingSimpleLogic=function(t,e,i){each(cookie.possibleDomains,function(e){cookie.deleteFromDomain(t,e)});var n=cookie.getCurrentSuffix();cookie.setOnDomain(t,e,n,i);var r=cookie.get(t);log("Cookie","%s setting %s=%s on %s",r===e?"Succeeded":"Failed",t,e,n)},cookie.setApiPublicSuffix=function(e){cookie.getCurrentSuffix()!==e&&(cookie.apiPublicSuffix=String(e)||"",log("Cookie","Api public suffix set to: %s",cookie.apiPublicSuffix))},cookie.guessedPublicSuffix="",cookie.apiPublicSuffix="",cookie.highestLevelDomain="",cookie.possibleDomains=[],cookie.publicSuffix="",cookie.queue=[];var AUDIENCE_COOKIE_NAME="optimizelyAudiences",DAY_IN_SECONDS=86400,DEFAULT_TRACKING_COOKIE_EXPIRATION=365*DAY_IN_SECONDS*10,MINIMUM_TRACKING_COOKIE_EXPIRATION=90*DAY_IN_SECONDS,BEHAVIOR_EVENT_HASH_SEED=2716770798,BUCKET_COOKIE_NAME="optimizelyBuckets",CUSTOM_EVENTS_COOKIE_NAME="optimizelyCustomEvents",CUSTOM_EVENTS_STORAGE_NAME="customEvents",DOMAIN_TEST_COOKIE_EXPIRATION=3,DOMAIN_TEST_COOKIE_NAME_PREFIX="optimizelyDomainTest-",EVALUATION_WAIT_INTERVAL=50,FIRST_EVALUATION_WAIT_INTERVAL=10,GLOBAL="optimizely",GLOBAL_DATA="data",GEO_CONDITION_WAIT_INTERVAL=1e3,GEO_TIMEOUT=2e3,IGNORED_VARIATION_ID="0",OPT_OUT_COOKIE_NAME="optimizelyOptOut",PENDING_LOG_EVENTS_COOKIE_AGE=15,PENDING_LOG_EVENTS_COOKIE_MAX_LENGTH=1536,PENDING_LOG_EVENTS_COOKIE_NAME="optimizelyPendingLogEvents",PREVIEW_COOKIE_NAME="optimizelyPreview",REDIRECT_COOKIE_FALSE="false",REDIRECT_COOKIE_SECONDS=5,REDIRECT_COOKIE_TRUE="true",REDIRECT_COOKIE_NAME="optimizelyRedirect",REFERRAL_CHARTBEAT_COOKIE_NAME="optimizelyChartbeat",REFERRER_REDIRECT_COOKIE_NAME="optimizelyReferrer",SEGMENTS_COOKIE_NAME="optimizelySegments",SELECTOR_DELIMITER=",",SOURCE_COOKIE_AGE=3,SOURCE_COOKIE_DELIMITER="|||",SOURCE_COOKIE_NAME="sourceCookie",TEST_MODULE=window.OPTIMIZELY_TEST_MODULE,TOKEN_COOKIE_KEEP_ALIVE=15,TOKEN_COOKIE_NAME="optimizelyToken",TOP_LEVEL_DOMAINS=["com","local","net","org","xxx","edu","es","gov","biz","info","fr","nl","ca","de","kr","it","me","ly","tv","mx","cn","jp","il","in","iq","test"],USER_ID_COOKIE_NAME="optimizelyEndUserId",PPID_COOKIE_NAME="optimizelyPPID",VARIATION_CODE_DELIMITER="\n",VARIATION_ID_DELIMITER="_",VARIATION_URL_DELIMITER=" ",VARIATION_URL_START="_optimizely_variation_url",VARIATION_URL_START_RE=/\/\*\s*_optimizely_variation_url( +include="([^"]*)")?( +exclude="([^"]*)")?( +match_type="([^"]*)")?( +include_match_types="([^"]*)")?( +exclude_match_types="([^"]*)")?( +id="([^"]*)")?\s*\*\//,VARIATION_URL_END="/* _optimizely_variation_url_end */",VARIATION_URL_END_RE=/\/\*\s*_optimizely_variation_url_end\s*\*\//,SIGNED_IN_BODY_CLASS="signed-in",HOTFIX_ENG_1636_COOKIE="optimizelyReportableFix";directive.delayPageviewTracking=0,directive.forceTracking=!1,directive.isSomeClientEnabled=function(){return directive.isEnabled||directive.isNewClientEnabled},directive.isEnabled=!0,directive.isNewClientEnabled=!0,directive.isEditor=!1,directive.isPersonalizationEditor=!1,directive.isDesktopAppEditor=!1,directive.optOutThirdPartyCookies=!1,directive.previewScriptName="",directive.previewVerified=!1,directive.requestedInvalidForceParameters=!1,directive.shouldLoadPreview=!1,directive.shouldLog=!1,directive.shouldLogVerbosely=!1,directive.shouldOverrideThirdPartyCookie=!1,directive.shouldSkipPageTracking=!1,directive.shouldTrackEvents=!0,directive.trackingCookieExpiration=DEFAULT_TRACKING_COOKIE_EXPIRATION,id.getId=function(){return cookie.get(USER_ID_COOKIE_NAME)},id.getOrGenerateId=function(){var e=cookie.get(USER_ID_COOKIE_NAME);return e||(e="oeu"+ +new Date+"r"+Math.random(),cookie.set(USER_ID_COOKIE_NAME,e,directive.trackingCookieExpiration)),e},id.getPPID=function(){return data.getLegacyUUID()?cookie.get(PPID_COOKIE_NAME):(id.unsetPPID(),null)},id.setPPID=function(e){data.getLegacyUUID()&&cookie.set(PPID_COOKIE_NAME,e,directive.trackingCookieExpiration)},id.unsetPPID=function(){cookie.remove(PPID_COOKIE_NAME)},id.hasPPID=function(){return null!==id.getPPID()};var every=function(e,t){var i=!0;return each(e,function(e){if(!t(e))return i=!1}),i},any=function(e,t){var i=!1;return each(e,function(e){if(t(e))return i=!0}),i};function appendArray(e,t){e.push.apply(e,t)}function arrayContains(e,t){for(var i=0;i<e.length;i++)if(t==e[i])return!0;return!1}function containsString(e,t){return-1!==e.indexOf(t)}function containsRegEx(e,t){return Boolean(e.match(t))}function curry(t,e){var i=slice(arguments,1);return function(){var e=slice(arguments);return prependArray(e,i),t.apply(this,e)}}function each(e,t,i){var n=null;if(isArrayLike(e)){for(var r=e.length,a=0;a<r;++a)if(isDefined(n=t.call(i,e[a],a)))return n}else for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&isDefined(n=t.call(i,o,e[o])))return n;return n}function map(e,t){if("function"==typeof e.map)return e.map(t);for(var i=[],n=0;n<e.length;n++)i.push(t(e[n],n));return i}function extend(i,e){return each(e,function(e,t){i[e]=t}),i}function getFieldValue(e,t){if(isArrayLike(t)){for(var i=e,n=0;n<t.length;n++){var r=t[n];if(!goog.isObject(i)||!i.hasOwnProperty(r))return;i=i[r]}return i}}function filter(e,t){for(var i=[],n=0,r=e.length;n<r;n++){var a=e[n];t(a)&&i.push(a)}return i}function format(e,t){var i=arguments,n=1;return e.replace(/%s/g,function(){return i[n++]})}function generateRandomHexString(){return Math.random().toString(16).replace("0.","")}function inArray(t,e){return each(e,function(e){if(e===t)return!0})||!1}function isArrayLike(e){return!!e&&"object"==typeof e&&"number"==typeof e.length}function isDefined(e){return void 0!==e}function isNonNullObject(e){return"object"==typeof e&&null!==e}function isNumberLike(e){return("number"==typeof e||"string"==typeof e)&&Number(e)==e}function isString(e){return"string"==typeof e}var keys=function(e){return(keys=Object.keys||function(e){var t=[];return each(e,function(e){t.push(e)}),t}).call(null,e)},loadScript=function(scriptUrl,attemptSynchronousLoad){var loadScriptAsynchronously=function(){var e=document.head||document.getElementsByTagName("head")[0]||document.documentElement,t=document.createElement("script");t.src=scriptUrl,t.type="text/javascript",e.appendChild(t)};if(attemptSynchronousLoad)try{if(!safeToAttemptDocumentWrite())throw new Error(goog.DEBUG&&"Not safe to attempt document.write");var id="optimizely_synchronous_script_"+Math.floor(1e5*Math.random());if(-1!==scriptUrl.indexOf('"'))return void timer.addEvent("loadScript","Blocked attempt to load unsafe script: "+scriptUrl);if(document.write('<script id="'+id+'" src="'+scriptUrl+'"><\/script>'),1!==$("#"+id).length)throw new Error(goog.DEBUG&&"Document.write failed to append script")}catch(e){try{var request=new XMLHttpRequest;request.open("GET",scriptUrl,!1),request.onload=function(){eval(request.responseText)},request.onerror=function(){throw new Error},request.send()}catch(e){log("Common","Failed to load %s synchronously",scriptUrl),loadScriptAsynchronously()}}else loadScriptAsynchronously()},log=function(e,t,i){var n=window.console;if(directive.shouldLog&&n&&n.log){var r=slice(arguments,1);r[0]="Optimizely / "+e+" / "+t,Function.prototype.apply.call(n.log,n,r)}};function prependArray(e,t){e.unshift.apply(e,t)}function quote(e){return e.replace(/([\f\n\r\t\\'"])/g,"\\$1")}function safeDecodeUriComponent(t){try{return decodeURIComponent(t)}catch(e){return t}}function slice(e,t,i){return Array.prototype.slice.call(e,t||0,i||e.length)}function trim(e){return e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function safeToAttemptDocumentWrite(){return"loading"===document.readyState}function beginsWith(e,t){return 0===e.indexOf(t)}optly.client.storage.StorageMetrics,optly.client.storage.Storage=function(e){this.storage=e,this.metrics_={totalGets:0,totalGetLength:0,totalGetTime:0,totalSets:0,totalSetLength:0,totalSetTime:0,numKeys:0,totalSize:0}},optly.client.storage.Storage.prototype.getKeyPath=function(e){return[optly.client.storage.LOCAL_STORAGE_KEY,e].join("$$")},optly.client.storage.Storage.prototype.get=function(e){try{var t=+new Date,i=this.storage.getItem(this.getKeyPath(e)),n=json.parse(i);return this.metrics_.totalGetTime+=+new Date-t,this.metrics_.totalGets++,this.metrics_.totalGetLength+=(i||"").length,n}catch(e){return null}},optly.client.storage.Storage.prototype.set=function(e,t){try{var i=+new Date,n=json.stringify(t);isDefined(t)?this.storage.setItem(this.getKeyPath(e),n):this.storage.removeItem(this.getKeyPath(e)),this.metrics_.totalSetTime+=+new Date-i,this.metrics_.totalSets++,this.metrics_.totalSetLength+=n.length}catch(e){}},optly.client.storage.Storage.prototype.metrics=function(){var e=0,t=0;for(var i in this.storage)if(beginsWith(i,optly.client.storage.LOCAL_STORAGE_KEY)){t++;var n=this.storage.getItem(i);e+=i.length+(n?n.length:0)}return this.metrics_.numKeys=t,this.metrics_.totalSize=e,this.metrics_},optly.client.storage.Storage.prototype.migrateIfNecessary=function(){var t=this.storage.getItem(optly.client.storage.LOCAL_STORAGE_KEY),e={};try{e=json.parse(t)||{}}catch(e){}if(0!==keys(e).length){var i=id.getPPID()||id.getId(),n=e[i]||{};for(var r in n)if(n.hasOwnProperty(r)){var a=[i,r].join("$$");null===this.get(a)&&this.set(a,n[r])}for(r in delete e[i],e)e.hasOwnProperty(r)&&(null===this.get(r)&&this.set(r,e[r]),delete e[r]);try{t=json.stringify(e)}catch(e){t={}}this.storage.setItem(optly.client.storage.LOCAL_STORAGE_KEY,t)}},optly.client.storage.initialize=function(){try{optly.client.storage.localStorage=new optly.client.storage.Storage(window.localStorage),optly.client.storage.sessionStorage=new optly.client.storage.Storage(window.sessionStorage),optly.client.storage.localStorage.migrateIfNecessary()}catch(e){}},optly.client.storage.MockStorageInterface={get:function(e){},set:function(e,t){},metrics:function(){return{}}},optly.client.storage.LOCAL_STORAGE_KEY="optimizely_data",optly.client.storage.localStorage=optly.client.storage.MockStorageInterface,optly.client.storage.sessionStorage=optly.client.storage.MockStorageInterface,optly.client.storage.initialize(),optly.murmur3.hash32=function(e,t){function i(e,t){var i=65535&t;return((t-i)*e|0)+(i*e|0)|0}t=t||0;for(var n,r=3432918353,a=461845907,o=e.length,s=t,c=-4&o,l=0;l<c;l+=4)s=5*(s=(524287&(s^=n=i(n=(131071&(n=i(n=255&e.charCodeAt(l)|(255&e.charCodeAt(l+1))<<8|(255&e.charCodeAt(l+2))<<16|(255&e.charCodeAt(l+3))<<24,r)))<<15|n>>>17,a)))<<13|s>>>19)+3864292196|0;switch(n=0,o%4){case 3:n=(255&e.charCodeAt(c+2))<<16;case 2:n|=(255&e.charCodeAt(c+1))<<8;case 1:s^=n=i(n=(131071&(n=i(n|=255&e.charCodeAt(c),r)))<<15|n>>>17,a)}return s^=o,s=i(s^=s>>>16,2246822507),s=i(s^=s>>>13,3266489909),s^=s>>>16},optly.hashing.HashSeed={IGNORING:0,BUCKETING:1,FALLBACK:2},optly.hashing.MAX_HASH_VALUE=Math.pow(2,32),optly.hashing.hashToReal=function(e,t){return(optly.murmur3.hash32(e,t)>>>0)/optly.hashing.MAX_HASH_VALUE},optly.hashing.hashToHex=function(e,t){var i=optly.murmur3.hash32(e,t);return(i>>>16).toString(16)+(65535&i).toString(16)},optly.hashing.toByteString=function(e){var i=String.fromCharCode;return e.replace(/[\S\s]/gi,function(e){e=e.charCodeAt(0);var t=i(255&e);return 255<e&&(t=i(e>>>8&255)+t),65535<e&&(t=i(e>>>16)+t),t})},optly.hashing.experimentUserHash=function(e,t,i){return optly.hashing.hashToReal(e+t,i)},optly.hashing.hashToInt=function(e,t,i,n){return Math.floor(optly.hashing.experimentUserHash(e,t,i)*n)},user.LEGACY_BROWSER=!0,user.getBrowser=function(){return user.detectionResults=user.detectionResults||detect.detect(),user.detectionResults},user.getBrowserId=function(){return user.getBrowser().browserId},user.getBrowserLanguage=function(){var t="";try{t=(t=navigator.userLanguage||window.navigator.language).toLowerCase()}catch(e){t=""}return t},user.getBrowserVersion=function(){return user.getBrowser().browserVersion},user.getCurrentUrl=function(){return user.currentUrl||window.location.href},user.getDevice=function(){return user.getBrowser().device},user.getDeviceId=function(){return user.getDevice().id},user.getDomain=function(e){if(!e)return"";try{return e.match(/:\/\/(?:www[0-9]?\.)?(.[^/:]+)/)[1]}catch(e){return""}},user.getPlatform=function(){return user.getBrowser().platform},user.getReferrer=function(){return cookie.get(REFERRER_REDIRECT_COOKIE_NAME)||document.referrer||""},user.getKeyPath=function(e){return[id.getPPID()||id.getOrGenerateId(),e].join("$$")},user.getUserData=function(e){return optly.client.storage.localStorage.get(user.getKeyPath(e))},user.setUserData=function(e,t){optly.client.storage.localStorage.set(user.getKeyPath(e),t)},user.getMobileId=user.LEGACY_BROWSER?function(){var e=["android","blackberry","ipad","iphone","ipod","windows phone"];return arrayContains(e,user.getDeviceId())?user.getDeviceId():arrayContains(e,user.getPlatform().id)?user.getPlatform().id:user.isMobile()?"mobile":"unknown"}:goog.nullFunction,user.isMobile=function(){return user.getDevice().isMobile},user.getNewVsReturning=function(){return user.isReturningUser?"returning":"new"},user.isFirstSession=function(){return!user.isReturningUser||!!optly.client.storage.sessionStorage.get(user.FIRST_SESSION_KEY)},user.getPlatform=function(){return user.getBrowser().platform},user.isBot=function(e){var t=["googlebot","yahoo! slurp","bingbot","bingpreview","msnbot","keynote","ktxn","khte","gomezagent","alertsite","yottaamonitor","pingdom.com_bot","aihitbot","baiduspider","adsbot-google","mediapartners-google","applebot"],i=e||navigator.userAgent;i=i.toLowerCase();for(var n=0;n<t.length;n++){var r=t[n];if(-1!==i.indexOf(r))return!0}return!1},user.initialize=function(){if(directive.isEnabled){var e=id.getId();user.isReturningUser=null!=e,user.isBot()?directive.shouldTrackEvents=!1:user.isReturningUser||optly.client.storage.sessionStorage.set(user.FIRST_SESSION_KEY,!0)}},user.setCurrentUrl=function(e){log("User","Setting current URL to %s",e),user.currentUrl=e},user.FIRST_SESSION_KEY="first_session",user.currentUrl=void 0,user.detectionResults=void 0,user.isReturningUser=void 0,timer.addEvent=function(e,t,i){timer.eventQueue.push({date:new Date,category:e,message:t,isVerbose:i||!1}),timer.shouldOutputImmediately&&timer.flushLogs()},timer.enableLogging=function(){directive.shouldLog=!0},timer.enableVerboseLogging=function(){directive.shouldLog=!0,directive.shouldLogVerbosely=!0},timer.flushLogs=function(){directive.shouldLog&&(each(timer.eventQueue,function(e){if(!(e.logged||e.isVerbose&&e.isVerbose!==directive.shouldLogVerbosely)){var t=+e.date,i=timer.lastTime?t-timer.lastTime:0,n=" [time "+(timer.startTime?t-timer.startTime:0)+" +"+i+"]";log(e.category,e.message+n),timer.lastTime=t,timer.startTime||(timer.startTime=t),e.logged=!0}}),timer.shouldOutputImmediately=!0)},timer.lastTime=null,timer.startTime=null,timer.eventQueue=[],timer.shouldOutputImmediately=!1,asyncInfo.AsyncInfo,asyncInfo.STORAGE_KEY="asyncInfo",asyncInfo.Source={AKAMAI:"cdn3",ODDS:"odds",DCPS:"dcps"},asyncInfo.asyncInfos={},asyncInfo.get=function(e){return asyncInfo.asyncInfos[e]||null},asyncInfo.set=function(e,t){asyncInfo.asyncInfos[e]=t},asyncInfo.maybeMigrateAndCleanupStore=function(){var e=optly.client.storage.localStorage.get(asyncInfo.STORAGE_KEY);e&&(user.getUserData(asyncInfo.STORAGE_KEY)||user.setUserData(asyncInfo.STORAGE_KEY,e),optly.client.storage.localStorage.set(asyncInfo.STORAGE_KEY,null))},asyncInfo.loadFromStore=function(){asyncInfo.maybeMigrateAndCleanupStore();var e=user.getUserData(asyncInfo.STORAGE_KEY);e&&each(e,asyncInfo.set)},asyncInfo.writeAroundToStore=function(e,t){var i=user.getUserData(asyncInfo.STORAGE_KEY)||{};i[e]=t,user.setUserData(asyncInfo.STORAGE_KEY,i)},asyncInfo.getIP=function(){var e=asyncInfo.get(asyncInfo.Source.ODDS)&&asyncInfo.get(asyncInfo.Source.ODDS).ip||asyncInfo.get(asyncInfo.Source.AKAMAI)&&asyncInfo.get(asyncInfo.Source.AKAMAI).ip;return e?asyncInfo.formatGeoField(e):null},asyncInfo.getLists=function(){return asyncInfo.get(asyncInfo.Source.ODDS)?asyncInfo.get(asyncInfo.Source.ODDS).lists||{}:null},asyncInfo.getListsMetadata=function(){return asyncInfo.get(asyncInfo.Source.ODDS)?asyncInfo.get(asyncInfo.Source.ODDS).lists_metadata||{}:null},asyncInfo.getValueForListTargetedKeyWhenCachePopulated=function(e){if(!asyncInfo.getLists())return timer.addEvent("Async Info","Invalid response from ODDS"),{value:void 0,isKnown:!1};if(!asyncInfo.getLists().hasOwnProperty(e))return timer.addEvent("Async Info","Deduced cachetime value that was checked for presence in list: "+e),{value:void 0,isKnown:!0};var t=asyncInfo.getListsMetadata();return t&&t[e]&&t[e][0]?(timer.addEvent("Async Info","Found cachetime value that was checked for presence in list: "+e),{value:t[e][0].value,isKnown:!0}):(timer.addEvent("Async Info","Can't find cachetime value that was checked for presence in list: "+e),{value:void 0,isKnown:!1})},asyncInfo.getListMembershipStatus=function(e){var t=data.getListTargetedKey(e),i=isDefined(t)&&asyncRequest.isListTargetedKeyWithVariableValue(t);if(i){var n=asyncRequest.getCurrentValueForListTargetedKey(t);if(null===n)return timer.addEvent("Async Info","Deduced membership status (false) for list: "+e),!1;timer.addEvent("Async Info","Found current value to check for presence in list: "+e)}var r=asyncInfo.getLists();if(!r)return timer.addEvent("Async Info","No list membership info."),null;if(i){var a=asyncInfo.getValueForListTargetedKeyWhenCachePopulated(e);if(a.isKnown&&a.value!==n)return timer.addEvent("Async Info","Ignoring out-of-date membership status for list: "+e),null}var o=!!r[e];return timer.addEvent("Async Info","Found membership status ("+o+") for list: "+e),o},asyncInfo.getListMembershipStatuses=function(){var t={};return each(data.getListTargetedKeys(),function(e){t[e]=asyncInfo.getListMembershipStatus(e)}),t},asyncInfo.getLocation=function(){if(!asyncInfo.get(asyncInfo.Source.AKAMAI))return null;var e=asyncInfo.get(asyncInfo.Source.AKAMAI).location||{};return{continent:asyncInfo.formatGeoField(e.continent),country:asyncInfo.formatGeoField(e.country),region:asyncInfo.formatGeoField(e.region),city:asyncInfo.formatGeoField(e.city)}},asyncInfo.cache,asyncInfo.dcpCache={get:function(){return asyncInfo.get(asyncInfo.Source.DCPS)},set:function(e){asyncInfo.writeAroundToStore(asyncInfo.Source.DCPS,e),asyncInfo.set(asyncInfo.Source.DCPS,e)}},asyncInfo.getDynamicCustomerProfileConditions=function(){var e=asyncInfo.dcpCache.get();return e?null===e.rulesResults?null:e.rulesResults||{}:null},asyncInfo.formatGeoField=function(e){return"string"!=typeof e?null:"N/A"===e.toUpperCase()?null:e.toUpperCase()};var ENABLED_UNIVERSAL_ANALYTICS=!0,ENABLED_AT_INTERNET=!0,ENABLED_COMSCORE=!0,ENABLED_MOAT=!0,ENABLED_INSPECTLET=!0,UA_EXPERIMENT_MAX_CHARACTERS=80,UA_DIMENSION_MAX_CHARACTERS=150,INTERNAL_LIST_NAME_PREFIX="_",INTERNAL_LIST_NAME_PART_DELIMITER="__";integrator.activateSiteCatalyst=function(e){if(e=e||{},directive.shouldTrackEvents){e&&e.sVariable&&integrator.setSiteCatalystSVar(e.sVariable);var r=integrator.getSiteCatalystSVar();r?integrator.hasIntegratedThirdParties?(integrator.fixSiteCatalystReferrer(r),log("Integrator","Tracking with SiteCatalyst"),each(integrator.getRelevantVariationIds(),function(e){var t=data.getVariationExperimentId(e),i=integrator.makeSendableNames(t,e,100,100,25,!0),n=i.key+": "+i.value;each(integrator.getSiteCatalystKeys(t),function(e){log("Integrator","Setting SiteCatalyst %s='%s'",e,n),r[e]=n})})):integrator.alsoActivateSiteCatalyst=!0:timer.addEvent("Integrator","Error with SiteCatalyst integration: 's' variable not defined")}},integrator.googleAnalyticsCustomVariableScope=function(e){if(e=isNumberLike(e)?Number(e):-1,-1===[1,2,3].indexOf(e))return integrator._googleAnalyticsCustomVariableScope;integrator._googleAnalyticsCustomVariableScope=e},integrator.loadThirdPartySegments=function(e){timer.addEvent("Integrator","Loading third-party segments."),window.bk_results&&integrator.loadBlueKaiSegments(window.bk_results,e)},integrator.makeThirdPartyRequests=function(){if(directive.shouldTrackEvents){integrator.fixGoogleAnalyticsReferrer();var i=[];each(integrator.getRelevantVariationIds(),function(e){var t=data.getVariationExperimentId(e);data.isChartbeatEnabled(t)&&integrator.makeChartbeatRequest(t,e),data.isComscoreEnabled(t)&&integrator.makeComscoreRequest(t,e),data.isCrazyEggEnabled(t)&&integrator.makeCrazyEggRequest(t,e),data.isGoogleAnalyticsEnabled(t)&&integrator.makeGoogleAnalyticsRequest(t,e),data.isInspectletEnabled(t)&&integrator.makeInspectletRequest(t,e),data.isKissMetricsEnabled()&&integrator.makeKissMetricsRequest(t,e),data.isMixpanelEnabled(t)&&integrator.makeMixpanelRequest(t,e),data.isMoatEnabled(t)&&integrator.makeMoatRequest(t,e),data.isSessioncamEnabled(t)&&(i=i.concat(integrator.createSessioncamData(t,e))),data.isATInternetEnabled(t)&&integrator.queueATInternetRequest(t,e)}),0<i.length&&integrator.makeSessioncamRequest(i),0<keys(integrator.ATInternetExperimentValues).length&&("function"==typeof window.xt_mvt?integrator.ATInternetOnloadHandler():$(window).bind("load.ATInternet",integrator.ATInternetOnloadHandler)),integrator.makeChartbeatReferralRequest(),integrator.hasIntegratedThirdParties=!0,integrator.alsoActivateUniversalAnalytics&&(integrator.activateUniversalAnalytics(),integrator.alsoActivateUniversalAnalytics=!1),integrator.alsoActivateSiteCatalyst&&(integrator.activateSiteCatalyst(),integrator.alsoActivateSiteCatalyst=!1)}},integrator.playbackClickTale=function(){if(window.ClickTaleContext){try{window.ClickTaleContext.getAggregationContextAsync("1",function(e){for(var t in e.Location&&window.optimizely.push(["overrideUrl",e.Location]),e.PageEvents){var i=e.PageEvents[t][2].match(/x[0-9]+=[0-9_]+/g);log("Integrator","Playback ClickTale Integration - %s",i);for(t=0;t<i.length;t++){log("Integrator","Playback ClickTale Integration - %s",i[t]);for(var n=i[t].split("=")[0].substr(1),r=i[t].split("=")[1].split("_"),a=0;a<r.length;a++)integrator.getRedirectURL(r[a])?log("Integrator","Skip activation for redirect."):window.optimizely.push(["activate",n,r[a],{force:!0}])}}})}catch(e){log("Integrator","Playback ClickTale Aggregation Integration failed.")}try{window.ClickTaleContext.getRecordingContextAsync("1.1",function(e){if(e.inSingleRecordingScope)for(var t in e.location&&window.optimizely.push(["overrideUrl",e.location]),log("Integrator","Playback ClickTale getRecordingContextAsync callback"),e.fields)log("Integrator","Playback ClickTale Integration - %s=%s",t,e.fields[t]),integrator.getRedirectURL(e.fields[t])?log("Integrator","Skip activation for redirect."):window.optimizely.push(["activate",t,e.fields[t],{force:!0}])})}catch(e){log("Integrator","Playback ClickTale Recording Integration failed.")}}else log("Integrator","ClickTaleContext not defined.")},integrator.recordClickTale=function(e){log("Integrator","Tracking with ClickTale."),"function"==typeof window.ClickTaleField?each(integrator.getRelevantVariationIds(),function(e){var t=data.getVariationExperimentId(e),i=integrator.makeSendableNames(t,e,100,100,15,!1),n=i.key+": "+i.value+" (x"+t+"="+e+")";log("Integrator","Setting ClickTale - %s",n),window.ClickTaleField(t,e),window.ClickTaleEvent(n)}):log("Integrator","ClickTaleField() not defined.")},integrator.setPrefix=function(e){integrator.prefix=e},integrator.setSiteCatalystSVar=function(e){integrator.siteCatalystObject=e},integrator.cleanSegmentString=function(e,t){return e.replace(/[^a-zA-Z0-9\.\~\!\*\(\)\']+/g,"_").substring(0,t)},integrator.fixGoogleAnalyticsReferrer=function(){var e=redirect.getRedirectReferrer();if(null!==e)try{log("Integrator","Fixing _gaq._setReferrerOverride with %s",e),_gaq.push(["_setReferrerOverride",e])}catch(e){log("Integrator","Error setting Google Analytics referrer: %s",e)}},integrator.fixUniversalAnalyticsReferrer=ENABLED_UNIVERSAL_ANALYTICS?function(){var e=redirect.getRedirectReferrer();if(null!==e)try{log("Integrator","Fixing Universal Analytics set referrer with %s",e);var t=window.GoogleAnalyticsObject||"ga";(0,window[t])("set","referrer",e)}catch(e){log("Integrator","Error setting Universal Analytics referrer: %s",e)}}:goog.nullFunction,integrator.fixSiteCatalystReferrer=function(e){var t=redirect.getRedirectReferrer();if(null!==t&&e)try{log("Integrator","Fixing SiteCatalyst referrer to %s",t),e.referrer=String(t)}catch(e){log("Integrator","Error setting SiteCatalyst referrer: %s",e)}},integrator.getRelevantVariationIds=function(){var r=evaluator.getActiveExperimentIds(),a=[];each(plan.getVariationIds(),function(e){var t=data.getVariationExperimentId(e),i=!1;if(data.isExperimentEnabled(t)){var n=data.getVariationName(e);arrayContains(r,t)&&(log("Integrator",'"%s" relevant because experiment active',n),i=!0),i&&a.push(e)}});var e=redirect.getRedirectVariationId();return e&&a.push(e),a},integrator.getSiteCatalystKeys=function(e){var t=[],i=data.getSiteCatalystEVar(e),n=data.getSiteCatalystProp(e);return null!==i&&t.push("eVar"+i),null!==n&&t.push("prop"+n),t},integrator.getSiteCatalystSVar=function(){return integrator.siteCatalystObject||(void 0!==window.s?window.s:null)},integrator.getRedirectURL=function(e){var t=data.getVariationCode(e);if(t){var i=redirect.getRedirectURL(t.toString());if(i)return i[1]}return null},integrator.loadBlueKaiSegments=function(e,i){timer.addEvent("Integrator","Loading BlueKai segments.");try{each(e.campaigns,function(e){var t=e.seg_id;data.getSegment(t)?segmenter.addToSegment(t,!0):data.getAudience(t)&&i.addToAudience(t)})}catch(e){timer.addEvent("Integrator","Error loading BlueKai segments.")}},integrator.makeChartbeatReferralRequest=function(){var t=cookie.get(REFERRAL_CHARTBEAT_COOKIE_NAME)||"";try{t&&integrator.currentChartbeatExperiment!=t&&(log("Integrator","Calling _cbq.push for referral"),_cbq.push(["_optlyr",t])),integrator.currentChartbeatExperiment!=t&&(log("Integrator","Set new Chartbeat referral cookie."),cookie.set(REFERRAL_CHARTBEAT_COOKIE_NAME,integrator.currentChartbeatExperiment))}catch(e){timer.addEvent("Integrator","Error sending Chartbeat referral for "+t)}},integrator.makeChartbeatRequest=function(t,e){var i=integrator.prefix;integrator.setPrefix("");var n=integrator.makeSendableNames(t,e,10,10,5,!1);integrator.setPrefix(i);var r=data.getVariationIndex(e);integrator.currentChartbeatExperiment=n.key+": "+String(r);try{log("Integrator","Calling _cbq.push"),_cbq.push(["_optlyx",integrator.currentChartbeatExperiment])}catch(e){timer.addEvent("Integrator","Error sending Chartbeat data for "+data.getExperimentString(t))}},integrator.makeComscoreRequest=ENABLED_COMSCORE?function(t,e){var i=data.getComscoreProperty(t,"url"),n=integrator.makeSendableNames(t,e,100,100,25,!0),r=i+(containsString(i,"?")?"&":"?")+"optimizely_experiment_id="+t+"&optimizely_experiment_name="+encodeURIComponent(n.key)+"&optimizely_variation_id="+e+"&optimizely_variation_name="+encodeURIComponent(n.value)+"&ns_m_exp=("+t+") "+encodeURIComponent(n.key)+"&ns_m_chs=("+e+") "+encodeURIComponent(n.value)+"&type=hidden";try{$(window).load(function(){timer.addEvent("Integrator","Sending comScore log call"),tracker.makeRequest(r,null)})}catch(e){timer.addEvent("Integrator","Error sending comScore data for "+data.getExperimentString(t))}}:goog.nullFunction,integrator.makeCrazyEggRequest=function(t,e){var i=integrator.makeSendableNames(t,e,100,100,15,!1);try{log("Integrator","Defining CE_SNAPSHOT_NAME"),window.CE_SNAPSHOT_NAME=i.key+": "+i.value}catch(e){timer.addEvent("Integrator","Error sending CrazyEgg data for "+data.getExperimentString(t))}},integrator.makeGoogleAnalyticsRequest=function(t,e){var i=data.getGoogleAnalyticsSlot(t),n=data.getGoogleAnalyticsTracker(t),r=integrator.makeSendableNames(t,e,28,24,5,!0);try{var a="";""!==n&&(a=n+"."),log("Integrator","Calling _gaq._setCustomVar for slot %d and scope %d",i,integrator._googleAnalyticsCustomVariableScope),_gaq.push([a+"_setCustomVar",i,r.key,r.value,integrator._googleAnalyticsCustomVariableScope])}catch(e){timer.addEvent("Integrator","Error sending Google Analytics data for "+data.getExperimentString(t))}},integrator.activateUniversalAnalytics=ENABLED_UNIVERSAL_ANALYTICS?function(){if(directive.shouldTrackEvents)if(integrator.hasIntegratedThirdParties){var e=window.GoogleAnalyticsObject||"ga",s=window[e];s?(integrator.fixUniversalAnalyticsReferrer(),log("Integrator","Tracking with Universal Analytics"),each(integrator.getRelevantVariationIds(),function(e){var t=data.getVariationExperimentId(e);if(data.isUniversalAnalyticsEnabled(t)){var i=data.getUniversalAnalyticsProperty(t,"slot"),n=data.getUniversalAnalyticsProperty(t,"tracker"),r=integrator.makeSendableNames(t,e,100,100,25,!0),a=r.key+" ("+t+"): "+r.value;if(a.length>UA_DIMENSION_MAX_CHARACTERS)a=(a=r.key.substring(0,UA_EXPERIMENT_MAX_CHARACTERS)+" ("+t+"): "+r.value).substring(0,UA_DIMENSION_MAX_CHARACTERS-1);var o=n?n+".":"";log("Integrator","Calling ua set dimension - ga(%sset, dimension%d, %s)",o,i,a),s(o+"set","dimension"+i,a)}})):timer.addEvent("Integrator","Error with Universal Analytics integration: 'GoogleAnalyticsObject' not defined")}else integrator.alsoActivateUniversalAnalytics=!0}:goog.nullFunction,integrator.makeInspectletRequest=ENABLED_INSPECTLET?function(t,e){var i=integrator.prefix;integrator.setPrefix("");var n=integrator.makeSendableNames(t,e,100,100,25,!1);integrator.setPrefix(i);try{timer.addEvent("Integrator","Calling __insp.push for sending data to Inspectlet"),window.__insp=window.__insp||[],window.__insp.push(["tagSession",{"Optimizely Experiment Name":n.key,"Optimizely Variation Name":n.value,"Optimizely Experiment ID":t,"Optimizely Variation ID":e}])}catch(e){timer.addEvent("Integrator","Error sending Inspectlet data for "+data.getExperimentString(t))}}:goog.nullFunction,integrator.makeKissMetricsRequest=function(t,e){var i=integrator.makeSendableNames(t,e,100,100,15,!0),n={};n[i.key]=i.value;try{log("Integrator","Calling _kmq.set"),_kmq.push(["set",n])}catch(e){timer.addEvent("Integrator","Error sending KISSmetrics data for "+data.getExperimentString(t))}},integrator.makeMixpanelRequest=function(t,e){var i=integrator.makeSendableNames(t,e,100,100,15,!1),n={};n[i.key]=i.value;try{log("Integrator","Calling mixpanel.push"),mixpanel.push(["register",n])}catch(e){timer.addEvent("Integrator","Error sending Mixpanel data for "+data.getExperimentString(t))}},integrator.makeMoatRequest=ENABLED_MOAT?function(t,e){var i=integrator.makeSendableNames(t,e,100,100,15,!1),n=i.key+": "+i.value;try{log("Integrator","Calling optimizelyMoat.push"),optimizelyMoat.push(n)}catch(e){timer.addEvent("Integrator","Error sending Moat data for "+data.getExperimentString(t))}}:goog.nullFunction,integrator.makeSessioncamRequest=function(t){try{timer.addEvent("Integrator","Calling sessioncamConfiguration object"),window.sessioncamConfiguration=window.sessioncamConfiguration||{},window.sessioncamConfiguration.customDataObjects=window.sessioncamConfiguration.customDataObjects||[],window.sessioncamConfiguration.customDataObjects=window.sessioncamConfiguration.customDataObjects.concat(t)}catch(e){timer.addEvent("Integrator","Error sending sessioncam data "+t)}},integrator.createSessioncamData=function(e,t){return timer.addEvent("Integrator","Preparing to send data to Sessioncam"),[integrator.makeSendableNames(e,t,100,100,15,!1),{key:"Optimizely Exp "+e,value:"Optimizely Var "+t}]},integrator.queueATInternetRequest=ENABLED_AT_INTERNET?function(e,t){var i=integrator.makeSendableNames(e,t,28,24,5,!0),n=e+"["+encodeURIComponent(i.key)+"]-0-"+t+"["+encodeURIComponent(i.value)+"]";n in integrator.ATInternetExperimentValues||(log("Integrator","Queueing AT Internet log call: %s",n),integrator.ATInternetExperimentValues[n]=!1)}:goog.nullFunction,integrator.ATInternetOnloadHandler=ENABLED_AT_INTERNET?function(){try{$(window).unbind("load.ATInternet"),window.xt_mvt&&each(integrator.ATInternetExperimentValues,function(e,t){t||(log("Integrator","Sending AT Internet log call: %s",e),window.xt_mvt("","",e),integrator.ATInternetExperimentValues[e]=!0)})}catch(e){timer.addEvent("Integrator","Error sending AT Internet data: "+e.toString())}}:goog.nullFunction,integrator.makeSendableNames=function(e,t,i,n,r,a){var o,s=integrator.prefix+data.getExperimentName(e),c=data.getVariationNamesArray(t);return o=1<c.length?(c=$.map(c,function(e){return e.substr(0,r-1)})).join("~"):c[0],a?(s=integrator.cleanSegmentString(s,i),o=integrator.cleanSegmentString(o.replace("#",""),n)):(s=s.substring(0,i),o=o.substring(0,n)),{key:s,value:o}},integrator.getAllThirdPartyData=function(){return optly.client.storage.localStorage.get(integrator.THIRD_PARTY_KEY)||{}},integrator.unionThirdPartyConditionValue=function(e,t){isArrayLike(e)||(e=[e]),isArrayLike(t)||(t=[t]);var i,n=[].concat(e);for(i=0;i<t.length;i++)inArray(t[i],n)||n.push(t[i]);return n},integrator.mergeThirdPartyData=function(e,t){var i,n={};if(e)for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);if(t)for(i in t)t.hasOwnProperty(i)&&(n[i]?n[i]=integrator.unionThirdPartyConditionValue(n[i],t[i]):n[i]=t[i]);return n},integrator.storeThirdPartyData=function(e,t,i){try{var n=integrator.getAllThirdPartyData(),r=n[e];n[e]=i&&r?integrator.mergeThirdPartyData(r,t):t,optly.client.storage.localStorage.set(integrator.THIRD_PARTY_KEY,n)}catch(e){}},integrator.getAllThirdPartyDataForProvider=function(e){return integrator.getAllThirdPartyData()[e]},integrator.getThirdPartyData=function(e,t){for(var i=integrator.getAllThirdPartyDataForProvider(e),n=0,r=t.length;n<r;n++){if(!goog.isObject(i)||!i.hasOwnProperty(t[n]))return;i=i[t[n]]}return i},integrator.storeThirdPartyListData=function(e){var t,i,n,r,a,o=e&&e.lists||{},s={};for(var c in o)o.hasOwnProperty(c)&&beginsWith(c,INTERNAL_LIST_NAME_PREFIX)&&o[c]&&(i=(t=c.substring(INTERNAL_LIST_NAME_PREFIX.length).split(INTERNAL_LIST_NAME_PART_DELIMITER)).shift(),n=t.shift(),r=t.join(INTERNAL_LIST_NAME_PART_DELIMITER),i&&n&&r&&((a=s)[i]||(a[i]={}),(a=a[i])[n]||(a[n]=[]),(a=a[n]).push(r)));for(i in s)integrator.storeThirdPartyData(i,s[i],!1)},integrator.alsoActivateUniversalAnalytics=!1,integrator.alsoActivateSiteCatalyst=!1,integrator.ATInternetExperimentValues={},integrator.currentChartbeatExperiment="",integrator._googleAnalyticsCustomVariableScope=2,integrator.hasIntegratedThirdParties=!1,integrator.prefix="Optimizely ",integrator.siteCatalystObject=null,integrator.THIRD_PARTY_KEY="thirdParty",activator.Options,activator.activate=function(e,t,i,n){if(!directive.isEnabled)return!1;var r="number"==typeof i||"string"==typeof i?String(i):null,a=!!(!0===i||i&&!0===i.force||n&&!0===n.force),o=!0===(n=("object"==typeof i?i:n)||{}).skip,s=!0===n.skipPageview,c=n.enabledStatus;if(r)try{api.bucketUser(t,r,!0)}catch(e){timer.addEvent("Activator","Error while activating experiment "+t+" for variation "+r+" -- proceeding without bucketing user.")}var l=[];isNumberLike(t)?l.push(t):each(data.getExperimentIds(),function(e){data.isExperimentManuallyActivated(e)&&l.push(e)}),activator.tryToEvaluateExperiments(e,l,{forcedActivation:a,manualActivation:!0,enabledStatus:c,skipBucketing:o,skipPageviewTracking:s}),optly.client.preview.ENABLED&&directive.shouldLoadPreview&&(timer.addEvent("Activator"," Activate - Updating preview data object asynchronously."),window.optimizelyPreview=window.optimizelyPreview||{},each(l,function(e){window.optimizelyPreview.updatePreviewData(e)}))},activator.activateGeoDelayedExperiments=function(e,t,i){if(!directive.isEnabled)return!1;if("object"==typeof t&&"string"==typeof i);else if("object"!=typeof t||isDefined(i)){if(isDefined(t)||isDefined(i))return void timer.addEvent("Activator","Unrecognized arguments to activateGeoDelayedExperiment: "+arguments)}else i=t.hasOwnProperty("lists")?asyncInfo.Source.ODDS:asyncInfo.Source.AKAMAI;if("object"!=typeof t||"string"!=typeof i)return timer.addEvent("Activator","Timeout: will not act on future async info."),optly.client.rum.instance.recordEvent("geoTimeout"),void(activator.hasTimedOut=!0);if(timer.addEvent("Activator","Saving async info from '"+i+"'"),i===asyncInfo.Source.AKAMAI&&optly.client.rum.instance.recordEvent("geoArrive"),asyncInfo.writeAroundToStore(i,t),asyncInfo.set(i,t),integrator.storeThirdPartyListData(t),activator.hasTimedOut)return timer.addEvent("Activator","Post-timeout; too late to act on new async info."),void(geolocation.cdn3Requested&&optly.client.rum.instance.recordEvent("geoFailed"));var n=activator.delayedSegments.slice();timer.addEvent("Activator","Trying to activate "+n.length+" delayed segments");activator.tryToEvaluateSegments(n);var r=activator.delayedExperiments.slice();timer.addEvent("Activator","Trying to activate "+r.length+" experiments");activator.tryToEvaluateExperiments(e,r,{skipPageviewTracking:directive.shouldSkipPageTracking});api.setPublicObjects(),"object"==typeof t&&"string"==typeof i&&i===asyncInfo.Source.AKAMAI&&optly.client.rum.instance.recordEvent("geoSuccess")},activator.tryToEvaluateExperiments=function(e,t,i){var n=activator.triageExperiments(e,t,i);each(n.pending,activator.addDelayedExperiment),activator.removeDelayedExperiments(n.passing),activator.removeDelayedExperiments(n.failing);var r=[];return each(n.passing,function(e){distributor.distributeExperiment(e,i.skipBucketing)&&r.push(e)}),evaluator.evaluate(r,t),plan.writeCookie(),integrator.makeThirdPartyRequests(),directive.isEnabled&&!i.skipPageviewTracking&&tracker.addActivationEvent(document.location.href),n},activator.triageExperiments=function(t,e,i){timer.addEvent("Activator","Triaging "+e.length+" experiments.");var n=[],r=[],a=[];return each(e,function(e){i.forcedActivation?(timer.addEvent("Activator","Force-ignoring conditions for experiment "+e),n.push(e)):condition.isReadyToTest(e)?condition.test(e,{manualActivation:i.manualActivation,objectType:"experiment",enabledStatus:i.enabledStatus,visitor:t})?(timer.addEvent("Activator","Passed conditions for experiment "+e),n.push(e)):(timer.addEvent("Activator","Failed conditions for experiment "+e),a.push(e)):(timer.addEvent("Activator","Can't test conditions for experiment "+e),r.push(e))}),{passing:n,pending:r,failing:a}},activator.tryToEvaluateSegments=function(e){var t=activator.triageSegments(e);return each(t.pending,activator.addDelayedSegment),activator.removeDelayedSegments(t.passing),activator.removeDelayedSegments(t.failing),activator.removeDelayedSegments(t.apiOnly),each(t.passing,segmenter.evaluateSegment),t},activator.triageSegments=function(e){timer.addEvent("Activator","Triaging "+e.length+" segments.");var t=[],i=[],n=[],r=[];return each(e,function(e){data.getSegmentAPIOnly(e)?(timer.addEvent("Activator","Ignoring API-only segment "+e),r.push(e)):condition.isReadyToTest(e)?condition.test(e,{objectType:"segment"})?(timer.addEvent("Activator","Passed conditions for segment "+e),t.push(e)):(timer.addEvent("Activator","Failed conditions for segment "+e),n.push(e)):(timer.addEvent("Activator","Can't test conditions for segment "+e),i.push(e))}),{passing:t,pending:i,failing:n,apiOnly:r}},activator.addDelayedExperiment=function(e){timer.addEvent("Activator","Deferring test for experiment "+e),arrayContains(activator.delayedExperiments,e)||activator.delayedExperiments.push(e)},activator.addDelayedSegment=function(e){timer.addEvent("Activator","Deferring test for segment "+e),arrayContains(activator.delayedSegments,e)||activator.delayedSegments.push(e)},activator.hasDelayedExperiments=function(){return 0<activator.delayedExperiments.length},activator.removeDelayedExperiments=function(t){activator.delayedExperiments=filter(activator.delayedExperiments,function(e){return!inArray(e,t)})},activator.removeDelayedSegments=function(t){activator.delayedSegments=filter(activator.delayedSegments,function(e){return!inArray(e,t)})},activator.delayedExperiments=[],activator.delayedSegments=[],activator.hasTimedOut=!1,
/**
         * @license
         *
         * UAParser.js v0.7.12
         * Lightweight JavaScript-based User-Agent string parser
         * https://github.com/faisalman/ua-parser-js
         *
         * Copyright © 2012-2016 Faisal Salman <fyzlman@gmail.com>
         * Dual licensed under GPLv2 & MIT
         */
useragent=function(){},function(r,u){"use strict";var g="function",p="object",e="model",t="name",i="type",n="vendor",a="version",o="architecture",s="console",c="mobile",l="tablet",d="smarttv",m="wearable",v={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:u},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},f={rgx:function(){for(var e,t,i,n,r,a,o,s=0,c=arguments;s<c.length&&!a;){var l=c[s],d=c[s+1];if(void 0===e)for(n in e={},d)d.hasOwnProperty(n)&&(typeof(r=d[n])===p?e[r[0]]=u:e[r]=u);for(t=i=0;t<l.length&&!a;)if(a=l[t++].exec(this.getUA()))for(n=0;n<d.length;n++)o=a[++i],typeof(r=d[n])===p&&0<r.length?2==r.length?typeof r[1]==g?e[r[0]]=r[1].call(this,o):e[r[0]]=r[1]:3==r.length?typeof r[1]!==g||r[1].exec&&r[1].test?e[r[0]]=o?o.replace(r[1],r[2]):u:e[r[0]]=o?r[1].call(this,o,r[2]):u:4==r.length&&(e[r[0]]=o?r[3].call(this,o.replace(r[1],r[2])):u):e[r]=o||u;s+=2}return e},str:function(e,t){for(var i in t)if(typeof t[i]===p&&0<t[i].length){for(var n=0;n<t[i].length;n++)if(v.has(t[i][n],e))return"?"===i?u:i}else if(v.has(t[i],e))return"?"===i?u:i;return e}},y={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},E={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[t,a],[/(opios)[\/\s]+([\w\.]+)/i],[[t,"Opera Mini"],a],[/\s(opr)\/([\w\.]+)/i],[[t,"Opera"],a],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[t,a],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[t,"IE"],a],[/(edge)\/((\d+)?[\w\.]+)/i],[t,a],[/(yabrowser)\/([\w\.]+)/i],[[t,"Yandex"],a],[/(comodo_dragon)\/([\w\.]+)/i],[[t,/_/g," "],a],[/(micromessenger)\/([\w\.]+)/i],[[t,"WeChat"],a],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[a,[t,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[t,/(.+)/,"$1 WebView"],a],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[a,[t,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[t,a],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[t,"UCBrowser"],a],[/(dolfin)\/([\w\.]+)/i],[[t,"Dolphin"],a],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[t,"Chrome"],a],[/;fbav\/([\w\.]+);/i],[a,[t,"Facebook"]],[/fxios\/([\w\.-]+)/i],[a,[t,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[a,[t,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[a,t],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[t,[a,f.str,y.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[t,a],[/(navigator|netscape)\/([\w\.-]+)/i],[[t,"Netscape"],a],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[t,a]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[o,"amd64"]],[/(ia32(?=;))/i],[[o,v.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[o,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[o,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[o,/ower/,"",v.lowerize]],[/(sun4\w)[;\)]/i],[[o,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[o,v.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[e,n,[i,l]],[/applecoremedia\/[\w\.]+ \((ipad)/],[e,[n,"Apple"],[i,l]],[/(apple\s{0,1}tv)/i],[[e,"Apple TV"],[n,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[n,e,[i,l]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[e,[n,"Amazon"],[i,l]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[e,f.str,y.device.amazon.model],[n,"Amazon"],[i,c]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[e,n,[i,c]],[/\((ip[honed|\s\w*]+);/i],[e,[n,"Apple"],[i,c]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[n,e,[i,c]],[/\(bb10;\s(\w+)/i],[e,[n,"BlackBerry"],[i,c]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[e,[n,"Asus"],[i,l]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[n,"Sony"],[e,"Xperia Tablet"],[i,l]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[n,"Sony"],[e,"Xperia Phone"],[i,c]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[n,e,[i,s]],[/android.+;\s(shield)\sbuild/i],[e,[n,"Nvidia"],[i,s]],[/(playstation\s[34portablevi]+)/i],[e,[n,"Sony"],[i,s]],[/(sprint\s(\w+))/i],[[n,f.str,y.device.sprint.vendor],[e,f.str,y.device.sprint.model],[i,c]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[n,e,[i,l]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[n,[e,/_/g," "],[i,c]],[/(nexus\s9)/i],[e,[n,"HTC"],[i,l]],[/(nexus\s6p)/i],[e,[n,"Huawei"],[i,c]],[/(microsoft);\s(lumia[\s\w]+)/i],[n,e,[i,c]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[e,[n,"Microsoft"],[i,s]],[/(kin\.[onetw]{3})/i],[[e,/\./g," "],[n,"Microsoft"],[i,c]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[e,[n,"Motorola"],[i,c]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[e,[n,"Motorola"],[i,l]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[n,v.trim],[e,v.trim],[i,d]],[/hbbtv.+maple;(\d+)/i],[[e,/^/,"SmartTV"],[n,"Samsung"],[i,d]],[/\(dtv[\);].+(aquos)/i],[e,[n,"Sharp"],[i,d]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[n,"Samsung"],e,[i,l]],[/smart-tv.+(samsung)/i],[n,[i,d],e],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[n,"Samsung"],e,[i,c]],[/sie-(\w+)*/i],[e,[n,"Siemens"],[i,c]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[n,"Nokia"],e,[i,c]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[e,[n,"Acer"],[i,l]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[n,"LG"],e,[i,l]],[/(lg) netcast\.tv/i],[n,e,[i,d]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[e,[n,"LG"],[i,c]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[e,[n,"Lenovo"],[i,l]],[/linux;.+((jolla));/i],[n,e,[i,c]],[/((pebble))app\/[\d\.]+\s/i],[n,e,[i,m]],[/android.+;\s(glass)\s\d/i],[e,[n,"Google"],[i,m]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[e,/_/g," "],[n,"Xiaomi"],[i,c]],[/android.+a000(1)\s+build/i],[e,[n,"OnePlus"],[i,c]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[i,v.lowerize],n,e]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[a,[t,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[t,a],[/rv\:([\w\.]+).*(gecko)/i],[a,t]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[t,a],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[t,[a,f.str,y.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[t,"Windows"],[a,f.str,y.os.windows.version]],[/\((bb)(10);/i],[[t,"BlackBerry"],a],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[t,a],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[t,"Symbian"],a],[/\((series40);/i],[t],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[t,"Firefox OS"],a],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[t,a],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[t,"Chromium OS"],a],[/(sunos)\s?([\w\.]+\d)*/i],[[t,"Solaris"],a],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[t,a],[/(haiku)\s(\w+)/i],[t,a],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[t,"iOS"],[a,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[t,"Mac OS"],[a,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[t,a]]},h=function(e,t){if(!(this instanceof h))return new h(e,t).getResult();var i=e||(r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),n=t?v.extend(E,t):E;return this.getBrowser=function(){var e=f.rgx.apply(this,n.browser);return e.major=v.major(e.version),e},this.getCPU=function(){return f.rgx.apply(this,n.cpu)},this.getDevice=function(){return f.rgx.apply(this,n.device)},this.getEngine=function(){return f.rgx.apply(this,n.engine)},this.getOS=function(){return f.rgx.apply(this,n.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};h.VERSION="0.7.12",h.BROWSER={NAME:t,MAJOR:"major",VERSION:a},h.CPU={ARCHITECTURE:o},h.DEVICE={MODEL:e,VENDOR:n,TYPE:i,CONSOLE:s,MOBILE:c,SMARTTV:d,TABLET:l,WEARABLE:m,EMBEDDED:"embedded"},h.ENGINE={NAME:t,VERSION:a},h.OS={NAME:t,VERSION:a},r.UAParser=h}(useragent),detect.detect=function(e){var t=e||window.navigator,i=new useragent.UAParser(t.userAgent),n=i.getBrowser(),r=i.getOS(),a=i.getDevice(),o=detect.normalizeDevice(a),s=detect.normalizePlatformName(r.name),c=detect.isMobile(a.type,o,s);return{browserId:detect.getBrowserCode(n.name),browserVersion:n.version,platform:{id:s,version:r.version},device:{id:o,type:a.type||(c?"mobile":"desktop"),isMobile:c}}},detect.getBrowserCode=function(t){if((t=(t||"").toLowerCase())in detect.browserMap)return t;for(var e in detect.browserMap)if(any(detect.browserMap[e]||[],function(e){return e.toLowerCase()===t}))return e;return"unknown"},detect.getBrowserName=function(e){return detect.browserMap[e]?detect.browserMap[e][0]:e},detect.isMobile=function(e,t,i){if(arrayContains(["mobile","tablet"],e))return!0;if(t&&"unknown"!==t)for(var n in detect.mobileDeviceMap)if(t===detect.mobileDeviceMap[n])return!0;return!!arrayContains(["android","blackberry","ios","windows phone"],i)},detect.normalizeDevice=function(e){return e.model in detect.mobileDeviceMap?detect.mobileDeviceMap[e.model]:"unknown"},detect.normalizePlatformName=function(e){return(e||"unknown").toLowerCase()},detect.browserMap={gc:["Chrome","chromium","silk","yandex","maxthon"],ie:["Internet Explorer","iemobile"],edge:["Edge"],ff:["Firefox","iceweasel"],opera:["Opera","opera mini","opera tablet"],safari:["Safari","mobile safari","webkit"],ucbrowser:["UC Browser"]},detect.mobileDeviceMap={iPhone:"iphone",iPad:"ipad"},redirect.initialize=function(){redirect.initializeRedirectVariationId(),redirect.initializeRedirectReferrerUrl()},redirect.getRedirectURL=function(e){return e.match(/_optimizely_redirect(?:_no_cookie)?=(\S+)/)},redirect.getRedirectReferrer=function(){return redirect.referrer},redirect.getRedirectVariationId=function(){return redirect.variationId},redirect.detectNoCookieRedirect=function(e){return containsString(e,"_optimizely_redirect_no_cookie")},redirect.okToRedirect=function(e){e=e||"";var t=redirect.getRedirectCookie();return!!redirect.detectNoCookieRedirect(e)||(!t||!(!t||t.split("|")[1]!==REDIRECT_COOKIE_TRUE))},redirect.getRedirectCookie=function(){return cookie.get(REDIRECT_COOKIE_NAME)},redirect.initializeRedirectVariationId=function(){var e=redirect.getRedirectCookie()||"|";redirect.variationId=e.split("|")[0]},redirect.initializeRedirectReferrerUrl=function(){var e=cookie.get(REFERRER_REDIRECT_COOKIE_NAME);null!==e&&(redirect.referrer=0==e.length?"":e,cookie.set(REFERRER_REDIRECT_COOKIE_NAME,""))},redirect.setRedirectCookie=function(e,t){var i=e?REDIRECT_COOKIE_TRUE:REDIRECT_COOKIE_FALSE;cookie.set(REDIRECT_COOKIE_NAME,(t||"unknown variation")+"|"+i,data.getRedirectTimeout())},redirect.setReferrerCookie=function(e){e=isDefined(e)?e:document.referrer,cookie.set(REFERRER_REDIRECT_COOKIE_NAME,e,data.getRedirectTimeout())},redirect.referrer=null,redirect.variationId="",redirect.redirectRegex=/^\/\* _optimizely_redirect.+\*\/[ ]*\nwindow\.location\.replace\(_optly\.redir\.href.*\)[ ]*[;]?$/,redirect.redirectRegexParams=/^\/\* _optimizely_redirect.+\*\/[ ]*\nvar[ ]*_optly[ ]*=[ ]*\{[ ]*redir:document\.createElement\("a"\)\}[;]?\n_optly\.redir\.href=.*\n_optly\.cur=.+\nif \(_optly.cur\)[ ]?\{.+\}[ ]*\nwindow\.location\.replace\(_optly\.redir\.href.*\)[ ]*[;]?$/,redirect.redirectRegexLegacy=/^\/\* _optimizely_redirect.+\*\/[ ]*[\n]+window\.location\.replace\([ ]*redirectFirst.*\)[ ]*[;]?$/,api.includeRemoveFromAllReportable=!0,api.initializePriorityOneApiCalls=function(){var e={disable:api.disable,optOut:tracker.optOut,setCookieDomain:cookie.setApiPublicSuffix,setCookieExpiration:api.setCookieExpiration,verifyPreviewProject:function(e){data.getProjectId()!==e?timer.addEvent("API","Preview projectId ("+data.getProjectId()+") does not match expected ("+e+"), disabling."):directive.previewVerified=!0}};api.initializeHighPriority(e)},api.initializeHighPriority=function(i){var e=window.optimizely,n=[];isArrayLike(e)&&(each(e,function(e){var t=e;isArrayLike(e)?t=e[0]:isNonNullObject(e)&&(t=e.type),i[t]?api.push([i],e,!0):n.push(e)}),window.optimizely=n)},api.storeThirdPartyData=function(e,t,i){integrator.storeThirdPartyData(e,t,!!i),api.setPublicObjects()},api.addToSegment=function(e,t){var i=data.getSegmentIdByIdentifier(e)||e,n=data.getSegment(i);if(n)if(n.audience_id)api.visitor.addToAudience(n.audience_id);else if(n.dimension_id){api.visitor.setDimensionValue(n.dimension_id,t||!0,!1)}else segmenter.addToSegment(i,t);else timer.addEvent("API","Unable to find segment: "+i)},api.bucketUser=function(e,t,i){i=!0===i,directive.shouldOverrideThirdPartyCookie=!0,directive.isEnabled&&!i&&tracker.addActivationEvent(document.location.href),e=String(e),t=String(t);var n=null,r=t.split(VARIATION_ID_DELIMITER),a=data.getExperimentSectionIds(e),o=a&&0!==a.length;if("-1"===r[0]?plan.removeExperiment(e):o&&r.length==a.length?(n=[],each(r,function(e,t){Number(e)<=256?n.push(data.getSectionVariationIds(a[t])[e]):n.push(e)}),n=n.join(VARIATION_ID_DELIMITER)):!o&&1==r.length&&Number(r[0])<=256?n=String(data.getVariationIdByIndex(e,r[0])):1==r.length?n=r[0]:timer.addEvent("API","Error: could not bucket user. Unknown arguments."),n)if(o&&data.getExperimentVariationSectionId(e,n))distributor.preferMVTVariation(e,n);else{plan.addVariation(n,"api.bucketUser",!1,!0)}plan.writeCookie()},api.disable=function(e){e&&"tracking"===e||(timer.addEvent("API","Optimizely disabled"),directive.isEnabled=!1,directive.isNewClientEnabled=!1),directive.shouldTrackEvents=!1},api.finalize=function(){timer.addEvent("API","Finalizing API."),api.setPublicObjects(),api.isFinalized=!0},api.get=function(){if(data.hasSlave())return SLAVE_CLIENT[GLOBAL].get.apply(null,Array.prototype.slice.call(arguments))},api.getVariationNamesMap=function(){return api.variationNamesMap},api.OAuthClientIds=[],api.addOAuthClientId=function(e){api.OAuthClientIds.push(e),api.setPublicObjects()},api.getOAuthClientIds=function(){return api.OAuthClientIds},api.initialize=function(e){api.visitor=e,api.isFinalized=!1,segmenter.addChangeHandler(api.setPublicObjects),plan.addChangeHandler(api.setPublicObjects);var t={$:$,activeExperiments:evaluator.getEvaluatedExperimentIds()||[],allExperiments:data.getExperiments(),all_experiments:data.getExperiments(),allVariations:data.getVariations(),getElementsByClassName:document.getElementsByClassName,revision:data.getRevision(),variationIdsMap:api.variationIdsMap,variation_map:api.variationMap,variationMap:api.variationMap,variationNamesMap:api.variationNamesMap};for(var i in t)api.setProperty(t,i,t[i]);t.data=api.data;var n={},r=[n,api.v1],a=curry(api.push,r);extend(n,{activate:goog.partial(activator.activate,api.visitor),activateGeoDelayedExperiments:goog.partial(activator.activateGeoDelayedExperiments,api.visitor),activateSiteCatalyst:integrator.activateSiteCatalyst,activateUniversalAnalytics:integrator.activateUniversalAnalytics,addOAuthClientId:api.addOAuthClientId,addToAudience:goog.bind(api.visitor.addToAudience,api.visitor),addToSegment:api.addToSegment,bindTrackElement:evaluator.bindTrackElementFromApi,bucketUser:api.bucketUser,bucketVisitor:api.bucketUser,clickTaleRecord:integrator.recordClickTale,clickTalePlayback:integrator.playbackClickTale,customTag:api.registerCustomTag,delayDomReadyEval:evaluator.setDelayDomExecute,delayPageviewTracking:api.delayPageviewTracking,disable:api.disable,log:timer.enableLogging,getAccountId:data.getAdminAccountId,getProjectId:data.getProjectId,googleAnalyticsCustomVariableScope:integrator.googleAnalyticsCustomVariableScope,integrationPrefix:integrator.setPrefix,optOut:tracker.optOut,overrideUrl:user.setCurrentUrl,push:a,removeFromAllAudiences:goog.bind(api.visitor.removeFromAllAudiences,api.visitor),removeFromAllSegments:api.removeFromAllSegments,removeFromAudience:goog.bind(api.visitor.removeFromAudience,api.visitor),removeFromSegment:api.removeFromSegment,sc_activate:integrator.activateSiteCatalyst,sc_svar:integrator.setSiteCatalystSVar,skipPageTracking:api.skipPageTracking,optOutThirdPartyCookies:api.optOutThirdPartyCookies,setDimensionValue:goog.bind(api.visitor.setDimensionValue,api.visitor),setUserId:api.setUserId,storeThirdPartyData:api.storeThirdPartyData,timeout:optly.client.preview.ENABLED?goog.nullFunction:api.disable,trackEvent:tracker.addLogEventFromAPI,verbose:timer.enableVerboseLogging}),data.hasSlave()&&extend(n,{get:api.get}),optly.client.preview.ENABLED&&extend(n,{getPreviewLog:function(){return optly.client.preview.Logger.log},clearPreviewLog:function(){optly.client.preview.Logger.clear()},configureConditionalModeExperiment:function(e,t){distributor.configureConditionalModeExperiment(e,t),timer.addEvent("API","Configuring conditionally activated experiment for preview "+e)}}),api.includeRemoveFromAllReportable&&(n.removeFromReportableAudiences=api.removeFromReportableAudiences),extend(t,n);var o=window.optimizely;isArrayLike(o)&&each(o,function(e){a(e)}),window[GLOBAL]=t},api.push=function(e,t,i){var n=[],r=t;i=!!isDefined(i)&&i;var a=0;isArrayLike(t)?(r=t[0],n=slice(t,1)):isNonNullObject(t)&&(a=isDefined(t.version)?t.version:1,r=t.type,n=[t]);var o,s=e[a];if(s&&(o=s[r]),o){timer.addEvent("API",'Called function "'+r+'"'),o.apply(null,n);var c=0===a?r:"v"+a+"."+r;optly.client.rum.instance.recordApi(c)}else i||timer.addEvent("API",'Error for unknown function "'+r+'"');data.hasSlave()&&SLAVE_CLIENT[GLOBAL].push(t),timer.flushLogs()},api.registerCustomTag=function(e,t){api.isFinalized?timer.addEvent("API","Error: can't add custom tags after Optimizely loads"):(api.customTags=api.customTags||{},2==arguments.length?api.customTags[e]=t:1==arguments.length&&$.extend(!0,api.customTags,e))},api.removeFromSegment=function(e,t){var i=data.getSegmentIdByIdentifier(e)||e;t=!isDefined(t)||t;var n=data.getSegment(i);n?n.audience_id?api.visitor.removeFromAudience(n.audience_id):n.dimension_id?api.visitor.setDimensionValue(n.dimension_id,null):segmenter.removeFromSegment(i,t):timer.addEvent("API","Unable find segment for: "+i)},api.removeFromAllSegments=function(){each(data.getSegmentIds(),function(e){api.removeFromSegment(e,!1)}),segmenter.callChangeHandlers()},api.setPublicObjects=function(){api.variationIdsMap={},api.variationMap={},api.variationNamesMap={},each(plan.getVariationIds(),function(e){var t=data.getVariationExperimentId(e);api.variationIdsMap[t]=e.split(VARIATION_ID_DELIMITER),api.variationMap[t]=data.getVariationIndex(e),api.variationNamesMap[t]=data.getVariationName(e)}),api.updateDataObject();var e={activeExperiments:evaluator.getEvaluatedExperimentIds(),allExperiments:data.getExperiments(),all_experiments:data.getExperiments(),variationIdsMap:api.variationIdsMap,variationMap:api.variationMap,variationNamesMap:api.variationNamesMap,variation_map:api.variationMap};window[GLOBAL].data=api.data,each(e,function(e,t){api.setProperty(window[GLOBAL],e,t)})},api.setProperty=function(t,i,n,e){try{var r="o.";r+=e||i,Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:function(){return optly.client.rum.instance.recordApi(r),n},set:function(e){n=e}})}catch(e){t[i]=n}},api.delayPageviewTracking=function(e){if(!isNumberLike(e))return!1;directive.delayPageviewTracking=Number(e)},api.optOutThirdPartyCookies=function(){directive.optOutThirdPartyCookies=!0},api.getRedirectExperimentState=function(){var e=redirect.getRedirectVariationId();if(e){var t=data.getVariationExperimentId(e);if(t)return{variationId:e,experimentId:t,referrer:redirect.getRedirectReferrer()}}},api.setCookieExpiration=function(e){var t,i="";"number"!=typeof e?(i="must be a number.",t=DEFAULT_TRACKING_COOKIE_EXPIRATION):t=Math.floor(DAY_IN_SECONDS*e),t<MINIMUM_TRACKING_COOKIE_EXPIRATION&&(i="less then minimum.",t=MINIMUM_TRACKING_COOKIE_EXPIRATION),i=i&&"Days argument "+i,timer.addEvent("API",i+" Cookie expiration set to "+t+" seconds."),directive.trackingCookieExpiration=t},api.skipPageTracking=function(){directive.shouldSkipPageTracking=!0},api.doesExperimentTargetCurrentUrl=optly.client.preview.ENABLED?function(e){var t=data.getExperimentUrls(e);return t?condition.testUrlDimensionValues(t,condition.facade.getCurrentUrl()):0!==filter(t=data.getConditions(e,"experiment"),function(e){return"url"===e.type&&condition.testUrls(e)}).length}:goog.nullFunction,api.updateDataObject=function(){api.data={};var e=data.getAudiences();api.setProperty(api.data,"audiences",e||void 0,"data.audiences"),api.setProperty(api.data,"customTags",api.customTags,"data.customTags"),api.setProperty(api.data,"thirdParty",integrator.getAllThirdPartyData(),"data.thirdParty");for(var t={},i=data.getExperimentIds(),n=0;n<i.length;n++){var r=i[n],a={};a.code=data.getExperimentCode(r),a.name=data.getExperimentName(r),a.conditional=data.isExperimentConditionallyActivated(r),a.manual=data.isExperimentManuallyActivated(r),a.section_ids=data.getExperimentSectionIds(r),a.variation_ids=data.getExperimentVariationIds(r),optly.client.preview.ENABLED&&(a.status=data.getExperimentStatus(r),a.targetsUrl=api.doesExperimentTargetCurrentUrl(r),api.conditionallyActivatedExperiments[r]&&(a.conditional_triggered=!0)),t[r]=a}api.setProperty(api.data,"experiments",t,"data.experiments");var o={},s=data.getSegmentIds();for(n=0;n<s.length;n++){var c=s[n],l={name:data.getSegmentName(c)};optly.client.preview.ENABLED&&extend(l,{is_default:data.getSegementIsDefault(c)}),o[c]=l}api.setProperty(api.data,"segments",o,"data.segments");var d={},u=data.getSectionIds();for(n=0;n<u.length;n++){var g=u[n],p={};p.name=data.getSectionName(g),p.variation_ids=data.getSectionVariationIds(g),d[g]=p}api.setProperty(api.data,"sections",d,"data.sections");var m={},v=data.getVariationIds();for(n=0;n<v.length;n++){var f=v[n],y={};y.name=data.getVariationName(f),y.code=data.getVariationCode(f),m[f]=y}api.setProperty(api.data,"variations",m,"data.variations");var E={browser:detect.getBrowserName(user.getBrowserId()),browserVersion:user.getBrowserVersion(),device:user.getDeviceId(),deviceType:user.getDevice().type,platform:user.getPlatform(),mobile:user.isMobile(),mobileId:user.getMobileId(),os:user.getPlatform().id,lists:asyncInfo.getListMembershipStatuses(),location:asyncInfo.getLocation(),ip:asyncInfo.getIP(),matchingRules:asyncInfo.getDynamicCustomerProfileConditions(),referrer:String(document.referrer),segments:segmenter.getSegmentTrackingData(),dimensions:api.visitor.getDimensionValues(),audiences:api.visitor.getAudiences()};for(var h in E)api.setProperty(E,h,E[h],"data.visitor."+h);optly.client.preview.ENABLED&&api.setProperty(E,"url",window.location.toString(),"data.visitor.url");var I={},_=query.getAllParameters();_.reverse();n=0;for(var b=_.length;n<b;n++)try{I[safeDecodeUriComponent(_[n][0])]=safeDecodeUriComponent(_[n][1])}catch(e){timer.addEvent("API","Failed to decode parameter "+_[n][0]+"="+_[n][1])}api.setProperty(E,"params",I,"data.visitor.params"),api.data.visitor=E;var S={},A=evaluator.getEvaluatedExperimentIds()||[];api.setProperty(S,"activeExperiments",A,"data.state.activeExperiments"),api.setProperty(S,"redirectExperiment",api.getRedirectExperimentState(),"data.state.redirectExperiment"),api.setProperty(S,"variationIdsMap",api.variationIdsMap,"data.state.variationIdsMap"),api.setProperty(S,"variationMap",api.variationMap,"data.state.variationMap"),api.setProperty(S,"variationNamesMap",api.variationNamesMap,"data.state.variationNamesMap"),api.setProperty(S,"enabled",directive.isEnabled,"data.state.enabled"),S.integrations={},api.setProperty(S.integrations,"activeOAuthClientIds",api.getOAuthClientIds(),"data.state.integrations.activeOAuthClientIds"),api.data.state=S},api.removeFromReportableAudiences=function(){cookie.get(HOTFIX_ENG_1636_COOKIE)?timer.addEvent("API","skipping because cookie is set"):(each(data.getAudiences(),function(e){data.getAudienceSegmentId(e)&&(timer.addEvent("API","Removing from reportable audience: "+e),api.visitor.removeFromAudience(e))}),cookie.set(HOTFIX_ENG_1636_COOKIE,"1",MINIMUM_TRACKING_COOKIE_EXPIRATION))},api.setUserId=function(e){var t=id.getPPID();e||0===e?"string"==typeof e||"number"==typeof e?(timer.addEvent("API","Setting PPID to "+e),e=String(e),id.setPPID(e)):timer.addEvent("API","Ignoring non-string, non-number PPID: "+e):(timer.addEvent("API","Clearing PPID"),id.unsetPPID()),id.getPPID()!==t&&(timer.addEvent("API","Clearing plan because of PPID change"),plan.reset())},api.v1={event:function(e){tracker.addLogEventFromAPI(e.eventName,e.tags)},user:function(e){e.userId&&api.setUserId(e.userId),e.attributes&&each(e.attributes,function(e,t){api.visitor.setDimensionValue(e,t)})},integration:function(e){e.OAuthClientId&&api.addOAuthClientId(e.OAuthClientId)}},api.data={},api.conditionallyActivatedExperiments={},api.variationIdsMap={},api.variationMap={},api.variationNamesMap={},api.visitor=null,tracker.fixRevenueOptions=function(e,t){var i,n={},r=data.getCustomRevenueGoals();if(r&&e in r&&isNumberLike(r[e])&&(i=Number(r[e])),t)if(isNumberLike(t))i=Number(t);else{if("object"!=typeof t)return log("tracker","Revenue argument %s not a number.",t),null;if("revenue"in(n=extend({},t))){if(!isNumberLike(n.revenue))return log("tracker","Revenue field %s not a number.",n.revenue),null;i=Number(n.revenue),delete n.revenue}}return isDefined(i)&&(n.revenue=i),n},tracker.addLogEventFromAPI=function(e,t){var i=tracker.fixRevenueOptions(e,t);if(null!==i){var n=data.getEnabledExperimentIds(),r={};each(n,function(e){r[e]=!0}),$.extend(i,{experimentIds:r}),tracker.addLogEvent(e,"custom",i)}else log("tracker","Bad options. Will not track this event.")},tracker.addLogEvent=function(e,t,i,n){if(i=i||{},optly.client.preview.Logger.addEvent(e,i),directive.shouldTrackEvents){var r={name:e,type:t,created:n||tracker.currentTimeInSeconds(),options:i};tracker.logEvents.push(r),tracker.shouldSendLogEvents?(tracker.sendLogEvents(),timer.addEvent("Tracker","Tracking event '"+e+"'")):timer.addEvent("Tracker","Queued tracking event '"+e+"'")}},tracker.enableEngagementTracking=function(){tracker.cancelEngagementTracking(),$("html").bind("mousedown",tracker.registerEngagement),$("html").bind("touchstart",tracker.confirmEngagement)},tracker.cancelEngagementTracking=function(){$("html").unbind("touchstart",tracker.confirmEngagement),$("html").unbind("mousedown touchend",tracker.registerEngagement),$("html").unbind("touchmove",tracker.enableEngagementTracking)},tracker.confirmEngagement=function(){$("html").bind("touchend",tracker.registerEngagement),$("html").bind("touchmove",tracker.enableEngagementTracking)},tracker.addActivationEvent=function(t){var e=data.getMatchingGoalIds(t);0<e.length?(tracker.addLogEvent("optly_activate","activate"),each(e,function(e){tracker.addLogEvent(t,"pageview",{goalIds:[e]},tracker.pageTimestamp)})):tracker.addLogEvent(t,"activate")},tracker.getPendingLogEvents=function(){var e=cookie.get(PENDING_LOG_EVENTS_COOKIE_NAME)||"[]",t=[];try{t=json.parse(e)}catch(e){}if(isArrayLike(t))for(var i=0,n=t.length;i<n;i++){var r=t[i];if("string"!=typeof r){t=[];break}try{json.parse(r);t=[];break}catch(e){}}else t=[];return t},tracker.makeLogRequest=function(e,t){timer.addEvent("Tracker","Making a log request."),e+="&cx2="+optly.hashing.hashToHex(tracker.getCanonicalQuery(e),65259),tracker.makeRequest(data.getLogUrlRoot()+"?"+e,t)},tracker.getCanonicalQuery=function(e){var t=map(e.split("&"),function(e){return e.split("=")});return t.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}),map(t,function(e){return e.join("=")}).join("&")},tracker.makeImageRequest=function(e,t){var i=new Image;i.onload=t,e=tracker.stripXHRFlag(e),i.src=e,tracker.images.push(i)},tracker.objectToQuery=function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(window.encodeURIComponent(i)+"="+window.encodeURIComponent(e[i]));return t.join("&")},tracker.makeRequest=function(e,t){if(tracker.XHR_SUPPORTED&&tracker.isXHRQuery(e))try{var i=new XMLHttpRequest;if("withCredentials"in i)return i.onload=t,i.open("GET",e,!0),i.withCredentials=!0,void i.send();tracker.XHR_SUPPORTED=!1,timer.addEvent("Tracker","Found that XHR with credentials is not supported in this browser.")}catch(e){timer.addEvent("Tracker","XHR not supported"),tracker.XHR_SUPPORTED=!1}tracker.makeImageRequest(e,t)},tracker.isXHRQuery=function(e){return-1!==e.indexOf(tracker.XHR_FLAG)},tracker.stripXHRFlag=function(e){return e.replace("&"+tracker.XHR_FLAG,"")},tracker.optOut=function(e,t){e=!isDefined(e)||"true"===String(e),isDefined(t)||(t=window.alert);var i=e?"true":"false";e?(cookie.set(OPT_OUT_COOKIE_NAME,i,directive.trackingCookieExpiration),cookie.set(BUCKET_COOKIE_NAME,i,directive.trackingCookieExpiration),t("You have successfully opted out of Optimizely for this domain.")):(cookie.set(OPT_OUT_COOKIE_NAME,i,directive.trackingCookieExpiration),t("You are NOT opted out of Optimizely for this domain."))},tracker.isOptedOut=function(){return"true"===cookie.get(OPT_OUT_COOKIE_NAME)},tracker.registerEngagement=function(e){tracker.cancelEngagementTracking(),tracker.addLogEvent("engagement","engagement")},tracker.removePendingLogEvent=function(e){for(var t=tracker.getPendingLogEvents(),i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);break}tracker.setPendingLogEventsCookie(t),timer.addEvent("Tracker","Removed a pending log event from the pending events cookie.")},tracker.logEvents=[],tracker.shouldSendLogEvents=!1,tracker.sendLogEvents=function(){var i=["a="+data.getProjectId(),"d="+data.getAdminAccountId(),"y="+data.getIPAnonymization(),"src=js"];directive.shouldOverrideThirdPartyCookie&&i.push("override=true"),each(plan.getVariationIds(),function(e){var t=data.getVariationExperimentId(e);i.push("x"+t+"="+e)}),each(segmenter.getSegmentTrackingData(),function(e,t){t=encodeURIComponent(safeDecodeUriComponent(t)),i.push("s"+e+"="+t)}),i.push("tsent="+tracker.currentTimeInSeconds());var o=[],s=id.getOrGenerateId(),c=id.getPPID();each(tracker.logEvents,function(e){var t=[],i=tracker.getGoalsForEvent(e);e.name&&t.push("n="+encodeURIComponent(e.name)),!0!==e.options.anonymous&&(t.push("u="+s),c&&t.push("p="+encodeURIComponent(c))),tracker.XHR_SUPPORTED&&t.push(tracker.XHR_FLAG),e.created&&t.push("time="+e.created),directive.optOutThirdPartyCookies&&t.push("dtpc="+directive.optOutThirdPartyCookies);var n=!!e.options&&!!e.options.revenue&&e.options.experimentIds||{},r=keys(n),a=filter(data.getEnabledExperimentIds(),function(e){return!n[e]});if(each([{experiments:r,goals:i.concat([data.getSummaryRevenueGoalId()]),extraParameters:["v="+encodeURIComponent(e.options.revenue)]},{experiments:a,goals:i,extraParameters:[]}],function(e){(e.experiments.length||directive.forceTracking)&&o.push(t.concat(e.extraParameters).concat(["f="+e.experiments.join(","),"g="+e.goals.join(",")]).join("&"))}),"custom"===e.type)try{tracker.updateCustomEventList(e.name)}catch(e){}});var e=o.concat(tracker.getPendingLogEvents());tracker.setPendingLogEventsCookie(e);var t=i.join("&"),n=tracker.sentPendingLogEvents?o:e;tracker.sentPendingLogEvents=!0;for(var r=0,a=n.length;r<a;r++){var l=n[r];tracker.makeLogRequest(t+"&"+l,function(){tracker.removePendingLogEvent(l)})}tracker.logEvents=[],tracker.shouldSendLogEvents=!0},tracker.sendVerificationRequest=function(){if(directive.shouldTrackEvents){var e="https://"+data.getWebHost()+"/account/snippet_installed?project_id="+data.getProjectId()+"&wxhr=true";timer.addEvent("Tracker","Making snippet verification request."),tracker.makeRequest(e,null)}},tracker.setPendingLogEventsCookie=function(e){for(var t=json.stringify(e);t.length>PENDING_LOG_EVENTS_COOKIE_MAX_LENGTH;)e=e.slice(0,-1),t=json.stringify(e);cookie.set(PENDING_LOG_EVENTS_COOKIE_NAME,t,PENDING_LOG_EVENTS_COOKIE_AGE)},tracker.updateCustomEventList=function(e){var t=id.getOrGenerateId(),i=optly.client.storage.localStorage.get(CUSTOM_EVENTS_STORAGE_NAME)||{},n=i[t]||(i[t]=[]);n=isArrayLike(n)?n:[],-1!==$.inArray(e,n)&&n.splice($.inArray(e,n),1),n.push(e),100<n.length&&n.shift(),i[t]=n,optly.client.storage.localStorage.set(CUSTOM_EVENTS_STORAGE_NAME,i),cookie.remove(CUSTOM_EVENTS_COOKIE_NAME)},tracker.sendErrorLog=function(e){var t="EXCEPTION: "+(e.name||"no-name"),i=e.message||"no-message",n=(e.stack||"error\nno stack").split("\n").slice(0,2).join(" ");tracker.addLogEvent([t,i,n].join(", "),"custom"),tracker.sendLogEvents()},tracker.getDocumentVisibilityState=function(){return document.visibilityState||document.webkitVisibilityState},tracker.currentTimeInSeconds=function(){return+new Date/1e3},tracker.getGoalsForEvent=function(e){if(e.options.goalIds)return e.options.goalIds;if("activate"===e.type){var t=evaluator.getActiveExperimentIds(),i=redirect.getRedirectVariationId();if(i){var n=data.getVariationExperimentId(i);t.push(n)}return t}return e.name?data.getMatchingGoalIds(e.name):[]},tracker.images=[],tracker.sentPendingLogEvents=!1,tracker.XHR_FLAG="wxhr=true",tracker.XHR_SUPPORTED=!0,tracker.pageTimestamp=tracker.currentTimeInSeconds(),behavior.FIELDS={NAME:"n",TIME:"t",TYPE:"y",CATEGORY:"c",REVENUE:"r",SESSION_ID:"s",OPTIONS:"o"},behavior.EventBase=function(e,t,i,n,r){this[behavior.FIELDS.NAME]=e,this[behavior.FIELDS.TYPE]=t,"string"==typeof i&&0<trim(i).length&&(this[behavior.FIELDS.CATEGORY]=trim(i)),n&&0<keys(n).length&&(this[behavior.FIELDS.OPTIONS]=n),isDefined(r)&&(this[behavior.FIELDS.REVENUE]=r)},behavior.EventBase.prototype.digest=function(){var e=function(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)},t=[];if(t.push(e(behavior.FIELDS.NAME,this[behavior.FIELDS.NAME])),t.push(e(behavior.FIELDS.TYPE,this[behavior.FIELDS.TYPE])),this[behavior.FIELDS.CATEGORY]&&t.push(e(behavior.FIELDS.CATEGORY,this[behavior.FIELDS.CATEGORY])),this[behavior.FIELDS.REVENUE]&&t.push(e(behavior.FIELDS.REVENUE,this[behavior.FIELDS.REVENUE])),!this[behavior.FIELDS.OPTIONS])return t.join("&");var i=this[behavior.FIELDS.OPTIONS]||{},n=filter(keys(i),function(e){return i.hasOwnProperty(e)});n=n.sort();for(var r=0;r<n.length;r++)t.push(e(n[r],i[n[r]]));return t.join("&")},behavior.EventBase.prototype.hash=function(){return this.hash_||(this.hash_=optly.hashing.hashToHex(optly.hashing.toByteString(this.digest()),BEHAVIOR_EVENT_HASH_SEED)),this.hash_},behavior.EventBase.prototype.setHash=function(e){this.hash_=e},behavior.EventBase.prototype.reHash=function(){this.hash_=null,this.hash()},behavior.EventBase.prototype.equals=function(e){if(this.hash()!==e.hash())return!1;if(this[behavior.FIELDS.NAME]!==e[behavior.FIELDS.NAME]||this[behavior.FIELDS.TYPE]!==e[behavior.FIELDS.TYPE]||this[behavior.FIELDS.CATEGORY]!==e[behavior.FIELDS.CATEGORY]||this[behavior.FIELDS.REVENUE]!==e[behavior.FIELDS.REVENUE])return!1;if(!this[behavior.FIELDS.OPTIONS]&&!e[behavior.FIELDS.OPTIONS])return!0;var t=this[behavior.FIELDS.OPTIONS]||{},i=e[behavior.FIELDS.OPTIONS]||{},n=filter(keys(t),function(e){return t.hasOwnProperty(e)}),r=filter(keys(i),function(e){return i.hasOwnProperty(e)});if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++){var o=n[a];if(!i.hasOwnProperty(o)||t[o]!==i[o])return!1}return!0},behavior.EventBase.prototype.getValueOrDefault=function(e,t){var i=getFieldValue(this,e);return isDefined(i)?i:t},behavior.EventBase.prototype.setFieldValue=function(e,t){e!==behavior.FIELDS.NAME&&e!==behavior.FIELDS.TYPE&&e!==behavior.FIELDS.CATEGORY&&e!==behavior.FIELDS.REVENUE&&e!==behavior.FIELDS.OPTIONS||(this[e]=t,this.reHash())},behavior.Event=function(e,t,i){this.eventBase=e,this[behavior.FIELDS.TIME]=t,isDefined(i)&&(this[behavior.FIELDS.SESSION_ID]=i)},behavior.Event.prototype.getValueOrDefault=function(e,t){if(0===e.length)return this;var i={};i[behavior.FIELDS.TIME]=this[behavior.FIELDS.TIME],i[behavior.FIELDS.SESSION_ID]=this[behavior.FIELDS.SESSION_ID];var n=getFieldValue(i,e);return isDefined(n)?n:this.eventBase.getValueOrDefault(e,t)},behavior.Event.prototype.setFieldValue=function(e,t){e===behavior.FIELDS.TIME||e===behavior.FIELDS.SESSION_ID?this[e]=t:this.eventBase.setFieldValue(e,t)},behavior.Policy.MILLIS_IN_30_MINS=18e5,behavior.Policy.isInSameSession=function(e,t){var i=e.getValueOrDefault([behavior.FIELDS.TIME],0),n=t.getValueOrDefault([behavior.FIELDS.TIME],0);return Math.abs(i-n)<behavior.Policy.MILLIS_IN_30_MINS},behavior.Policy.updateSessionId_unguarded=function(e,t){var i;i=behavior.Policy.isInSameSession(e,t)?e.getValueOrDefault([behavior.FIELDS.SESSION_ID]):t.getValueOrDefault([behavior.FIELDS.TIME]),t.setFieldValue(behavior.FIELDS.SESSION_ID,i)},behavior.Policy.updateSessionId=function(e,t){if(e){var i=e.getValueOrDefault([behavior.FIELDS.TIME]),n=e.getValueOrDefault([behavior.FIELDS.SESSION_ID]),r=t.getValueOrDefault([behavior.FIELDS.TIME]);i="number"!=typeof i?r-2*behavior.Policy.MILLIS_IN_30_MINS:i,n="number"!=typeof n?i:n,e=new behavior.Event(new behavior.EventBase("",""),i,n),behavior.Policy.updateSessionId_unguarded(e,t)}else t.setFieldValue(behavior.FIELDS.SESSION_ID,t.getValueOrDefault([behavior.FIELDS.TIME]))},behavior.Policy.sessionize=function(e){var t=e.length;if(0!==t){e[0].setFieldValue(behavior.FIELDS.SESSION_ID,e[0].getValueOrDefault([behavior.FIELDS.TIME]));for(var i=1;i<t;i++)behavior.Policy.updateSessionId_unguarded(e[i-1],e[i])}},behavior.Policy.applyMigrations=function(e){return!1},behavior.Store={EVENTS_KEY:"events",EVENT_QUEUE_KEY:"event_queue",COMPACT_KEYS:{EVENTBASE:"eb",HASH:"h",TIMEBASE:"tb",TIMESTAMPS:"ts",DELTA:"d",INDEX:"i"},baseMap:{},events:[]},behavior.Store.initialize=function(){data.isBehaviorEnabled()&&behavior.Store.populatePersistedEvents()},behavior.Store.getEvents=function(){return data.isBehaviorEnabled()?(0===behavior.Store.events.length&&behavior.Store.initialize(),behavior.Store.events.slice(-behavior.Store.maxEvents)):[]},behavior.Store.populatePersistedEvents=function(){var e=user.getUserData(behavior.Store.EVENTS_KEY)||[],t=user.getUserData(behavior.Store.EVENT_QUEUE_KEY)||[];behavior.Store.migrateEventsAndUpdateStore(e,t),behavior.Policy.sessionize(behavior.Store.events)},behavior.Store.migrateEventsAndUpdateStore=function(e,t){if(0===e.length&&0===t.length)return!(behavior.Store.events=[]);var i=!1,n=e[0]||t[0];return behavior.Store.COMPACT_KEYS.EVENTBASE in n?(e=behavior.Store.unCompact(e),t=behavior.Store.unCompact(t)):(i=!0,e=behavior.Store.migrateFromVerboseFormat(e),t=behavior.Store.migrateFromVerboseFormat(t)),behavior.Store.events=e.concat(t),behavior.Store.events.length>behavior.Store.maxEvents&&(behavior.Store.events=behavior.Store.events.slice(-behavior.Store.maxEvents),i=!0),behavior.Store.updateBaseMapAndMaybeDedupe(behavior.Store.events),behavior.Store.migrateEventBasesAndUpdateStore()&&(i=!0),i},behavior.Store.migrateFromVerboseFormat=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i],r=behavior.Store.makeEventBase(n);t[i]=new behavior.Event(r,n[behavior.FIELDS.TIME])}return t},behavior.Store.migrateEventBasesAndUpdateStore=function(){var e=!1,t=behavior.Store.getAllEventBases();return behavior.Policy.applyMigrations(t)&&(e=!0,behavior.Store.baseMap={},behavior.Store.updateBaseMapAndMaybeDedupe(behavior.Store.events)),e},behavior.Store.getTime=function(){return+new Date},behavior.Store.updateBaseMapAndMaybeDedupe=function(e){for(var t=0;t<e.length;t++)e[t].eventBase=behavior.Store.findOrSetEventBase(e[t].eventBase)},behavior.Store.findOrSetEventBase=function(e){var t=e.hash(),i=behavior.Store.baseMap[t];if(void 0===i)return behavior.Store.baseMap[t]=[e],e;for(var n=0;n<i.length;n++)if(e.equals(i[n]))return i[n];return i.push(e),e},behavior.Store.getAllEventBases=function(){var e=[];for(var t in behavior.Store.baseMap)behavior.Store.baseMap.hasOwnProperty(t)&&(e=e.concat(behavior.Store.baseMap[t]));return e},behavior.Store.CompactEB,behavior.Store.CompactTS,behavior.Store.CompactEvent,behavior.Store.makeEventBase=function(e,t){var i=new behavior.EventBase(e[behavior.FIELDS.NAME],e[behavior.FIELDS.TYPE],e[behavior.FIELDS.CATEGORY],e[behavior.FIELDS.OPTIONS],e[behavior.FIELDS.REVENUE]);return isDefined(t)&&i.setHash(t),i},behavior.Store.unCompact=function(e){for(var t=behavior.Store.COMPACT_KEYS,i=[],n=0;n<e.length;n++)for(var r=e[n],a=behavior.Store.makeEventBase(r[t.EVENTBASE],r[t.HASH]),o=r[t.TIMEBASE],s=r[t.TIMESTAMPS],c=0;c<s.length;c++){var l=s[c],d=new behavior.Event(a,o+l[t.DELTA]);i[l[t.INDEX]]=d}return i},behavior.Store.usageInBytes=function(){var e=user.getUserData(behavior.Store.EVENTS_KEY)||[],t=user.getUserData(behavior.Store.EVENT_QUEUE_KEY)||[];return json.stringify(e).length+json.stringify(t).length},behavior.Store.maxEvents=1e3,behavior.getEvents=function(){try{return behavior.Store.getEvents()}catch(e){log("Behavior","Error "+e.toString()+" getting events")}return[]},behavior.usageInBytes=function(){return behavior.Store.usageInBytes()},behavior.getDefaultAttributes=function(){return(user.getUserData("visitor_profile")||{}).defaultBehavior||{}},optly.client.rum.ENABLED=!0,optly.client.rum.MAX_CHARS_INTEGRATION_OAUTH_CLIENT_IDS=64,optly.client.rum.MAX_CHARS_APIS=1e3,optly.client.rum.RumCollector=function(){this.events={},this.apis={},this.inRumSample=Math.random()<data.rumSamplingRate(),geolocation.cdn3Requested&&(this.events.geoRequest=geolocation.cdn3Requested-optly.client.rum.timebase)},optly.client.rum.now=function(){return(new Date).getTime()-(optly.client.rum.timebase||0)},optly.client.rum.since=function(e){return e?(new Date).getTime()-e.getTime():0},optly.client.rum.timebase=optly.client.rum.now(),optly.client.rum.RumCollector.prototype.sendRum=optly.client.rum.ENABLED?function(){this.inRumSample&&tracker.makeRequest(this.createUrl(),null)}:goog.nullFunction,optly.client.rum.RumCollector.joinMaxLengthRandomly=optly.client.rum.ENABLED?function(e,t,i){for(var n=e.slice(),r=n.length-1;0<r;r--){var a=Math.floor(Math.random()*(r+1)),o=n[r];n[r]=n[a],n[a]=o}for(var s=n.join(t);s.length>i;)n.pop(),s=n.join(t);return s}:function(e,t,i){return""},optly.client.rum.RumCollector.prototype.createUrl=function(){return"https://rum.optimizely.com/rum?"+tracker.objectToQuery(this.getRum())},optly.client.rum.RumCollector.prototype.recordEvent=optly.client.rum.ENABLED?function(e){this.events[e]||(this.events[e]=optly.client.rum.now())}:function(e){},optly.client.rum.RumCollector.prototype.recordApi=optly.client.rum.ENABLED?function(e){this.apis[e]=!0}:goog.nullFunction,optly.client.rum.RumCollector.prototype.getRum=optly.client.rum.ENABLED?function(){var e={user:id.getOrGenerateId(),ppid:id.getPPID(),project:data.getProjectId(),revision:data.getRevision(),sync:optly.client.rum.syncInstall,timebase:optly.client.rum.timebase,render:optly.client.rum.firstRenderTime,sampleRate:data.rumSamplingRate(),numExps:evaluator.getActiveExperimentIds().length,numBehaviorEvents:behavior.getEvents().length,behaviorEventsSize:behavior.usageInBytes(),oldestBehaviorEventAge:optly.client.rum.since(optly.client.rum.getOldestBehaviorEventDate()),integrationOAuthClientIds:optly.client.rum.RumCollector.joinMaxLengthRandomly(api.getOAuthClientIds(),",",optly.client.rum.MAX_CHARS_INTEGRATION_OAUTH_CLIENT_IDS),codeVersion:data.getVersion(),hasSlave:data.hasSlave(),docVisibilityState:tracker.getDocumentVisibilityState(),wxhr:!0,apis:optly.client.rum.RumCollector.joinMaxLengthRandomly(keys(this.apis),"!",optly.client.rum.MAX_CHARS_APIS)};extend(e,optly.client.rum.getResourceTiming()||{}),extend(e,this.events),extend(e,optly.client.rum.getCookieData()||{});var i={};return each(optly.client.storage.localStorage.metrics()||{},function(e,t){i["ls"+e]=t}),extend(e,i),e}:function(){return{}},optly.client.rum.syncInstall=optly.client.rum.ENABLED?function(){try{return!document.getElementsByTagName("body")[0]}catch(e){return null}}():null,optly.client.rum.firstRenderTime=null,optly.client.rum.ENABLED&&function(){try{window.requestAnimationFrame(function(){optly.client.rum.firstRenderTime=optly.client.rum.now()})}catch(e){}}(),optly.client.rum.getOldestBehaviorEventDate=function(){try{return window.optimizely.get("behavior").getEvents()[0].timestamp}catch(e){}},optly.client.rum.getCookieData=optly.client.rum.ENABLED?function(){var t=[AUDIENCE_COOKIE_NAME,BUCKET_COOKIE_NAME,CUSTOM_EVENTS_COOKIE_NAME,PENDING_LOG_EVENTS_COOKIE_NAME,REFERRER_REDIRECT_COOKIE_NAME,SEGMENTS_COOKIE_NAME],i={},n=0,r=0;return each(cookie.getAll(),function(e){0===e.name.indexOf("optimizely")&&(arrayContains(t,e.name)&&(timer.addEvent("RUM","Cookie size for "+e.name+": "+e.raw.length),i[e.name+"Len"]=e.raw.length),n+=e.raw.length),r+=e.raw.length}),extend(i,{allOptimizelyCookiesLen:n,allCookiesLen:r}),i}:goog.nullFunction,optly.client.rum.resourceRegex=/\/\/[^.]+\.optimizely\.(com|test)\/(js|api\/client)\/[\d]+\.js/gi,optly.client.rum.getResourceTiming=optly.client.rum.ENABLED?function(){var e,t=null;try{e=filter(window.performance.getEntries(),function(e){return!!optly.client.rum.resourceRegex.test(e.name)})[0]}catch(e){return t}if(e)for(var i in t={},e)"number"==typeof e[i]&&0!==e[i]&&(t[i]=e[i]);return t}:goog.nullFunction,optly.client.rum.instance=new optly.client.rum.RumCollector,distributor.distributeAll=function(){optly.client.rum.instance.recordEvent("distributeExperiments"),each(data.getExperimentIds(),function(e){if(!evaluator.isInQueue(e))if(data.isExperimentConditionallyActivated(e))distributor.configureConditionalModeExperiment(e);else if(condition.isReadyToTest(e)){if(condition.test(e,{objectType:"experiment"})){timer.addEvent("Distributor","Going to distribute "+data.getExperimentString(e)),distributor.distributeExperiment(e)&&evaluator.enqueue(e)}}else data.isExperimentManuallyActivated(e)||arrayContains(evaluator.getEvaluatedExperimentIds(),e)||activator.addDelayedExperiment(e)})},distributor.distributeExperiment=function(e,t){t=!0===t;var i=plan.getVariationId(e);if(i&&0<i.length)return timer.addEvent("Distributor","Not distributing experiment "+e+" (already in plan)"),!0;if(t||plan.isExperimentIgnored(e))return timer.addEvent("Distributor","Not distributing experiment "+e+" (is ignored)"),optly.client.preview.Logger.setReason(e,"it is ignored"),!1;var n=data.getEnabledVariationIds(e);if(0===n.length)return timer.addEvent("Distributor","Permanently ignoring experiment "+e+" (no enabled variations)"),optly.client.preview.Logger.setReason(e,"it has no enabled variations"),plan.ignoreExperiment(e),!1;var r=data.getExperimentIgnorePercentage(e);if(r>distributor.randomForIgnoring(e))return timer.addEvent("Distributor","Permanently ignoring experiment "+e+"("+r/100+"% likelihood)"),plan.ignoreExperiment(e),!1;var a=n;void 0!==distributor.preferredBucketUserMapping[e]&&(timer.addEvent("Distributor","Taking into account bucketUser variations for experiment "+e),a=distributor.getPotentialPreferredMVTVariations(e));var o=distributor.pickRandomVariationIndex(e,a),s=a[o];return timer.addEvent("Distributor","Picked variation "+s+" [index "+o+" of "+n.length+"]"),plan.addVariation(s,"distributor",!1),!0},distributor.configureConditionalModeExperiment=function(e,t){t=t||{},timer.addEvent("Distributor","Configuring conditionally-activated experiment: "+e),api.conditionallyActivatedExperiments[e]?timer.addEvent("Distributor","Not configuring conditionally-activated experiment (already done): "+e):data.isExperimentEnabled(e)||!0===t.force?(distributor.runConditionalCode(e,t),api.isFinalized&&api.setPublicObjects()):timer.addEvent("Distributor","Not configuring conditionally-activated experiment (not enabled): "+e)},distributor.runConditionalCode=function(experimentId,options){var code=data.getConditionalActivationCode(experimentId),pollingType=!0,conditionalFunction,conditionalCodeResult;if("function"==typeof code)pollingType=!1,conditionalFunction=code;else try{var evalString="("+code+")";conditionalCodeResult=eval("(function() {return "+evalString+";})()"),"function"==typeof conditionalCodeResult&&(pollingType=!1,conditionalFunction=conditionalCodeResult)}catch(e){}var activationOptions={isActive:!1,experimentId:experimentId},activationFunction=function(){activator.activate(api.visitor,experimentId,options),activationOptions.isActive=arrayContains(evaluator.getActiveExperimentIds(),experimentId),timer.addEvent("Distributor","Activating conditionally activated experiment "+experimentId)};if(pollingType){var testOptions={objectType:"experiment",enabledStatus:options.enabledStatus};if(options.force||!condition.isReadyToTest(experimentId)||condition.test(experimentId,testOptions)){var pollForReady=function(){condition.isReadyToTest(experimentId)&&(condition.testCodeResult(null,{value:code})||conditionalCodeResult)?activationFunction():setTimeout(pollForReady,EVALUATION_WAIT_INTERVAL)};pollForReady(),timer.addEvent("Distributor","Set up conditional polling for "+experimentId),api.conditionallyActivatedExperiments[experimentId]=!0}}else try{conditionalFunction(activationFunction,activationOptions),timer.addEvent("Distributor","Set up conditional callback for "+experimentId),api.conditionallyActivatedExperiments[experimentId]=!0}catch(e){timer.addEvent("Distributor","Error running conditional callback function for "+experimentId)}},distributor.getBucketingId=function(){return id.getPPID()||id.getOrGenerateId()},distributor.randomForIgnoring=function(e){return optly.hashing.hashToInt(distributor.getBucketingId(),e,optly.hashing.HashSeed.IGNORING,1e4)},distributor.randomForBucketing=function(e){return optly.hashing.experimentUserHash(distributor.getBucketingId(),e,optly.hashing.HashSeed.BUCKETING)},distributor.getRandomBucketAsFallback=function(e,t){return optly.hashing.hashToInt(distributor.getBucketingId(),e,optly.hashing.HashSeed.FALLBACK,t)},distributor.pickRandomVariationIndex=function(e,t){var i=[],n=data.getExperimentVariationWeights(e);return each(t,function(e){i.push(n[e])}),distributor.chooseWeightedIndex(e,i)},distributor.chooseWeightedIndex=function(e,t){var i=t.length;if(0===i)return null;if(1===i)return 0;for(var n=0,r=0;r<i;r++)n+=t[r];var a=distributor.randomForBucketing(e)*n;for(r=0;r<i;r++){if(a<t[r])return r;a-=t[r]}return distributor.getRandomBucketAsFallback(e,i)},distributor.preferMVTVariation=function(e,t){var i=data.getExperimentVariationSectionId(e,t);distributor.preferredBucketUserMapping[e]=distributor.preferredBucketUserMapping[e]||{},distributor.preferredBucketUserMapping[e][i]=t,timer.addEvent("Distributor","Preferring variation partial "+t+" of section "+i+" of experiment "+e);var n=distributor.getPotentialPreferredMVTVariations(e);1===n.length&&plan.addVariation(n[0],"api.bucketUser",!1,!0)},distributor.getPotentialPreferredMVTVariations=function(t){var i=[];return each(data.getEnabledVariationIds(t),function(e){distributor.containsPreferredMVTVariations(t,e)&&i.push(e)}),i},distributor.containsPreferredMVTVariations=function(e,t){var i=!0;for(var n in distributor.preferredBucketUserMapping[e]){var r=distributor.preferredBucketUserMapping[e][n];-1===t.indexOf(r)&&(i=!1)}return i},distributor.preferredBucketUserMapping={},dcp.alias=function(e){var t=data.getDCPServiceId();if(null!==t){var i=dcp.getAliases(data.getDCPKeyfieldLocators());if(i.optlyDatasource)if(0!==i.otherDatasources.length)if(dcp.maybeInvalidateCachedResults(e)){var n=dcp.makeAliasURLPath(t,i.optlyDatasource.datasourceId,i.optlyDatasource.id);dcp.postAliasRequest(n,i.otherDatasources,e)}else timer.addEvent("DCP","Duplicate alias request; skipping.");else timer.addEvent("DCP","Must specify at least one non-Optimizely datasource to alias");else timer.addEvent("DCP","Must specify Optimizely datasource in alias")}},dcp.aliasDescriptor,dcp.getAliases=function(e){for(var t=null,i=[],n=0;n<e.length;n++){var r=e[n],a=r.dcp_datasource_id||null,o=r.is_optimizely||!1,s=r.type,c=r.name||"";if(null!==a){var l=null;if(s===dcp.keyFieldLocatorType.COOKIE?l=condition.facade.getCookie(c):s===dcp.keyFieldLocatorType.JS_VARIABLE?l=condition.facade.getJSVariable(c):s===dcp.keyFieldLocatorType.QUERY_PARAM?l=condition.facade.getQueryParameter(c):s===dcp.keyFieldLocatorType.UID&&(l=dcp.getUID()),isNumberLike(l)||"string"==typeof l){var d={datasourceId:a,id:l};o?t=d:i.push(d)}}else timer.addEvent("DCP","No DCP datasource id specified")}return{optlyDatasource:t,otherDatasources:i}},dcp.getUID=distributor.getBucketingId,dcp.makeAliasURLPath=function(e,t,i){return map([e,t,i],encodeURIComponent).join("/")},dcp.maybeInvalidateCachedResults=function(e){var t=dcp.getAliases(data.getDCPKeyfieldLocators()),i=e.get()||{},n=i.aliases||{};return!dcp.isAlreadyAliased(t.otherDatasources,n)&&(i.rulesResults=null,e.set(i),!0)},dcp.makeTargetingURL=function(e){var t=dcp.getAliases(data.getDCPKeyfieldLocators());if(!t.optlyDatasource||!t.optlyDatasource.datasourceId)return timer.addEvent("DCP","No Optimizely datasource found in data."),null;var i=t.optlyDatasource.datasourceId,n=t.optlyDatasource.id,r=map([data.getProjectId().toString(),i,n],encodeURIComponent),a=[dcp.BASE_URLS.TARGETING].concat(r).join("/"),o=(e.get()||{}).aliases||{};dcp.isAlreadyAliased(t.otherDatasources,o)||(a+="?"+map(t.otherDatasources,function(e){return encodeURIComponent(e.datasourceId)+"="+encodeURIComponent(e.id)}).join("&"));return a},dcp.isAlreadyAliased=function(e,i){return i=i||{},every(e,function(e){var t=e.datasourceId;return i[t]===e.id})},dcp.getUpdatedAliasData=function(e,t){return t=t||{},each(e,function(e){t[e.datasourceId]=e.id}),t},dcp.postAliasRequest=function(e,i,n){try{var r=new XMLHttpRequest,t=[dcp.BASE_URLS.ALIAS,e].join("/");r.open("POST",t),"withCredentials"in r&&(r.withCredentials=!0),r.setRequestHeader("Content-Type","application/json;charset=UTF-8");var a={};each(i,function(e){a[e.datasourceId]=e.id}),r.onerror=function(){timer.addEvent("DCP","Failed to POST alias request")},r.onload=function(){if(200<=r.status&&r.status<300){var e=n.get()||{},t=e.aliases||{};e.aliases=dcp.getUpdatedAliasData(i,t),n.set(e)}else timer.addEvent("DCP","Alias POST failed with",r.statusText)},r.send(json.stringify({data:a}))}catch(e){timer.addEvent("DCP","Exception %s trying to POST alias request",e)}},dcp.BASE_URLS={ALIAS:"https://vis.optimizely.com/api/alias",TARGETING:"https://tapi.optimizely.com/api/targetingEmbed"},dcp.keyFieldLocatorType={COOKIE:"cookie",JS_VARIABLE:"js_variable",QUERY_PARAM:"query_param",UID:"uid"},asyncRequest.makeDynamicCustomerProfileTargetingRequest=function(){dcp.maybeInvalidateCachedResults(asyncInfo.dcpCache);var e=dcp.makeTargetingURL(asyncInfo.dcpCache);null!==e&&loadScript(e)},asyncRequest.makeListTargetingRequest=function(){loadScript(asyncRequest.getListTargetingUrl())},asyncRequest.getListTargetingUrl=function(){var e=asyncRequest.URLS.ODDS,n={};each(data.getListTargetedKeys(),function(e,t){var i=asyncRequest.getCurrentValueForListTargetedKey(t);"string"==typeof i&&(n[t]=i)}),n.project=data.getProjectId().toString();var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(encodeURIComponent(i)+"="+encodeURIComponent(n[i]));return t.length&&(e+="?"+t.join("&")),e},asyncRequest.getCurrentValueForListTargetedKey=function(e){if(!asyncRequest.isListTargetedKeyWithVariableValue(e))return timer.addEvent("Async Request","Can't determine a value for this list-targeted key: "+e),null;var t=e.split("_"),i=t[0],n=t.slice(1).join("_"),r=void 0;if("c"===i)r=condition.facade.getCookie(n);else if("j"===i)r=condition.facade.getJSVariable(n);else{if("q"!==i)return timer.addEvent("Async Request","Can't determine a value for this list-targeted key: "+e),null;r=condition.facade.getQueryParameter(n)}return"string"!=typeof r&&"number"!=typeof r&&"boolean"!=typeof r?(null==r?timer.addEvent("Async Request","No value is set for this list-targeted key: "+e):timer.addEvent("Async Request","Unacceptable value (must be string, number, or boolean) for this list-targeted key: "+e),null):100<(r=r.toString()).length?(timer.addEvent("Async Request","Withholding the overlong value for this list-targeted key: "+e),null):(timer.addEvent("Async Request","Returning a value for this list-targeted key: "+e),r)},asyncRequest.isListTargetedKeyWithVariableValue=function(e){return!!containsString(e,"_")&&arrayContains(["c","j","q"],e.split("_")[0])},asyncRequest.KeyValue,asyncRequest.URLS={ODDS:"https://odds.optimizely.com/js/geo2.js"},preview_loader.loadPreview=function(){window.optimizelyPreview||(window[GLOBAL]&&window[GLOBAL].unshift||(window[GLOBAL]=[]),window[GLOBAL].unshift(["verifyPreviewProject",data.getProjectId()]),loadScript([preview_loader.HOST,preview_loader.PATH,directive.previewScriptName,".js"].join(""),!0),directive.shouldLoadPreview&&preview_loader.loadSplashScreen('Loading Preview<br /><img alt="loading" src="//'+data.getWebHost()+'/static/img/loading-32.gif" style="padding-top:20px; width: 32px; margin: 0 auto;" />'))},preview_loader.loadSplashScreen=function(e){if(0!==$("body").length){var t='<div id="optimizely-loading" style="position:absolute;top:0;right:0;left:0;bottom:0;background-color:white;opacity:0.9;z-index: 3271000;"><h2 style="color:#9a9a9a;top:40%;position:absolute;font-size:2.25em;text-align:center;width:100%;font-family:\'Lucida Grande\',sans-serif;">';t=t+e+"</h2></div>",$("#optimizely-loading").remove(),$("body").append(t)}else setTimeout(function(){preview_loader.loadSplashScreen(e)},20)},preview_loader.HOST=data.getPreviewHost(),preview_loader.PATH="/js/preview/",query.getAllParameters=function(){var e=window.location.search||"";0===e.indexOf("?")&&(e=e.substring(1));for(var t=e.split("&"),i=[],n=0;n<t.length;n++){var r="",a="",o=t[n].split("=");0<o.length&&(r=o[0]),1<o.length&&(a=o[1]),i.push([r,a])}return i},query.getParameters=function(e){for(var t,i=/optimizely_([^=]+)=([^&]*)/g,n={};t=i.exec(e);)n[t[1]]=t[2];return n},query.getValue=function(e,t){t=t||query.getAllParameters();for(var i=0;i<t.length;i++){var n=t[i];if(n[0]===e){var r=n[1];return safeDecodeUriComponent(r=r.replace(/\+/g," "))}}return null},query.FORCE_PARAMETERS_REGEX=/x(\d+)/,query.processForceParameters=function(){var r=!optly.client.preview.ENABLED&&!data.isForceVariationEnabled();each(query.getParameters(window.location.search),function(e,t){var i=query.FORCE_PARAMETERS_REGEX.exec(e);if(i){if(r)return directive.requestedInvalidForceParameters=!0,void log("Query","Ignored parameter %s",e);var n=i[1];api.bucketUser(n,t,!0),data.isExperimentConditionallyActivated(n)?distributor.configureConditionalModeExperiment(n,{force:!0,skipPageviewTracking:!0}):condition.test(n,{})||activator.activate(api.visitor,n,{force:!0,skipPageviewTracking:!0})}})},query.process=function(){var e=query.getParameters(window.location.search),t=!1;for(var i in e)if(query.FORCE_PARAMETERS_REGEX.exec(i)){t=!0;break}"true"!==e.opt_out&&"false"!==e.opt_out||tracker.optOut("true"===e.opt_out),directive.forceTracking="true"===e.force_tracking,"true"===e.disable||"true"===e.opt_out||tracker.isOptedOut()?(directive.isEnabled=!1,directive.isNewClientEnabled=!1):"classic"===e.disable?directive.isEnabled=!1:"new"===e.disable&&(directive.isNewClientEnabled=!1),directive.isEditor="true"===e.editor,directive.isPersonalizationEditor="true"===e.p13n,directive.shouldLoadPreview="true"===e.show_preview;var n=window.optlyDesktop;directive.isDesktopAppEditor=n&&isDefined(n.p13nInner);var r=cookie.get(TOKEN_COOKIE_NAME);r&&cookie.set(TOKEN_COOKIE_NAME,r,TOKEN_COOKIE_KEEP_ALIVE);var a=e.token||r;data.getInsecurePreview()&&a?directive.previewScriptName="public/"+data.getProjectId():/^[0-9a-f]{64}$/.test(a)?directive.previewScriptName=a:/^[0-9a-f]{32}$/.test(a)?(timer.addEvent("Query","Using legacy MD5 token"),directive.previewScriptName=a):(cookie.remove(TOKEN_COOKIE_NAME),timer.addEvent("Query","Blocked request to load unsafe script: "+a)),directive.shouldLog="true"===e.log,directive.shouldLogVerbosely="true"===e.verbose,directive.shouldTrackEvents=!(directive.shouldLoadPreview||t)||directive.forceTracking},optly.nativity.getNativeGetElementsByClassName=function(){var e=document.getElementsByClassName;if(!optly.nativity.isNativeFunction(e)){var t=(window.optimizely||{}).getElementsByClassName,i=(window.optly||{}).getElementsByClassName;e=optly.nativity.isNativeFunction(t)?t:optly.nativity.isNativeFunction(i)?i:null}return e},optly.nativity.isNativeFunction=function(e){return e&&-1!==String(e).indexOf("[native code]")},segmenter.initialize=function(e){var t=e||visitor;segmenter.loadSegmentsCookie(t),activator.tryToEvaluateSegments(data.getSegmentIds()),segmenter.addChangeHandler(segmenter.saveSegmentsCookie),segmenter.callChangeHandlers(),integrator.loadThirdPartySegments(t)},segmenter.loadSegmentsCookie=function(n){timer.addEvent("Segmenter","Loading segments cookie.");var t=cookie.get(SEGMENTS_COOKIE_NAME);if(t){try{t=json.parse(t)}catch(e){t={}}each(t,function(e,t){var i=data.getSegment(e);timer.addEvent("Segmenter","Segments cookie contains segment id: "+e),i&&i.audience_id?n.addToAudience(i.audience_id):i&&i.dimension_id?n.setDimensionValue(i.dimension_id,t,!1):segmenter.visitorSegments[e]=t})}},segmenter.saveSegmentsCookie=function(){var i={};each(segmenter.visitorSegments,function(e,t){t&&(i[e]=t)}),cookie.set(SEGMENTS_COOKIE_NAME,json.stringify(i),directive.trackingCookieExpiration)},segmenter.addChangeHandler=function(e){segmenter.changeHandlers.push(e)},segmenter.addToSegment=function(e,t){e&&!isNaN(parseInt(e,10))?(t||""===t||(t=!0),segmenter.visitorSegments[e]=t,segmenter.callChangeHandlers()):timer.addEvent("Segmenter","Unable to find segment for ID: "+e)},segmenter.callChangeHandlers=function(){each(segmenter.changeHandlers,function(e){e()})},segmenter.evaluateSegment=function(e){timer.addEvent("Segmenter","Evaluating Segment "+e),segmenter.tellPreviewAboutSegment(e,"add");var t=segmenter.evaluateSegmentValue(e);null!==t&&segmenter.addToSegment(e,t)},segmenter.evaluateSegmentValue=function(e){if(data.getSegmentAPIOnly(e))return null;var t=null,i=null;switch(data.getSegmentValueType(e)){case"browser":t=condition.facade.getBrowserId(),i="unknown";break;case"campaign":t=condition.facade.getCampaign(),i="none";break;case"country":t=condition.facade.getLocation().country,i="unknown";break;case"language":t=condition.facade.getBrowserLanguage(),i="none";break;case"mobile":t=condition.facade.isMobile();break;case"os":t=condition.facade.getPlatform().id,i="unknown";break;case"referrer":t=condition.facade.getReferringDomain(),i="none";break;case"source_type":t=condition.facade.getSourceType(),i="direct";break;default:return"true"}if(null===t){if(segmenter.visitorSegments.hasOwnProperty(e))return null;t=i}return segmenter.standardizeValue(t)},segmenter.getSourceType=function(){var e=condition.facade.getReferrer();if(condition.facade.getQueryParameter("utm_source")||condition.facade.getQueryParameter("utm_campaign")||condition.facade.getQueryParameter("gclid")||condition.facade.getQueryParameter("otm_source"))return"campaign";for(var t=["google\\.\\w{2,3}(\\.\\w{2,3})?/(search|url)","https://(www\\.)?google\\..*?/$","http(s)?://www\\.bing\\.\\w{2,3}(\\.\\w{2,3})?/","r\\.search\\.yahoo\\.\\w{2,3}(\\.\\w{2,3})?/","baidu\\.\\w{2,3}(\\.\\w{2,3})?/"],i=0;i<t.length;i++){var n=t[i];try{if(e.match(n))return"search"}catch(e){log("Segmenter","%s: %s while matching %s",e.name,e.message,n)}}return e&&user.getDomain(e)!==user.getDomain(condition.facade.getCurrentUrl())?"referral":null},segmenter.getSegmentsList=function(){var i=[];return each(segmenter.visitorSegments,function(e,t){t&&i.push(e)}),i},segmenter.getSegmentTrackingData=function(){var i={};return each(segmenter.visitorSegments,function(e,t){t&&(i[String(e)]=t)}),i},segmenter.getSegmentValue=function(e){return segmenter.visitorSegments[e]},segmenter.getSegmentValueFromType=function(i){return each(segmenter.visitorSegments,function(e,t){if(data.getSegmentValueType(e)==i)return t})},segmenter.reset=function(){segmenter.visitorSegments={}},segmenter.handleOfflineSegmentResponse=function(e){var t;for(t in e.map)log("Segmenter","Offline segment request returned: %s, %s",t,e.map[t]),segmenter.addToSegment(t,e.map[t])},segmenter.removeFromSegment=function(e,t){var i=data.getSegmentIdByIdentifier(e)||e;segmenter.visitorSegments[i]?(segmenter.visitorSegments[i]=!1,(void 0===t||t)&&segmenter.callChangeHandlers()):timer.addEvent("Segmenter","Not removing "+e+", not found")},segmenter.standardizeValue=function(e,t,i){return t=!isDefined(t)||t,i=i||segmenter.MAX_VALUE_LENGTH,e=safeDecodeUriComponent(e),e=String(e),t&&(e=e.toLowerCase()),e=e.substring(0,i),encodeURIComponent(e)},segmenter.tellPreviewAboutSegment=optly.client.preview.ENABLED?function(e,t){var i="add"===t?"adding":"removing",n="add"===t?"to":"from",r=optly.client.preview.Logger.getReason(e);r?(optly.client.preview.Logger.addEvent("Not "+i+" visitor "+n+" segment "+data.getSegmentName(e)+" because "+r+".",{type:"explanation"}),optly.client.preview.Logger.deleteReason(e)):optly.client.preview.Logger.addEvent("Segment "+t+" condition matches, "+i+n+" segment "+data.getSegmentName(e),{type:"explanation"})}:goog.nullFunction,segmenter.changeHandlers=[],segmenter.visitorSegments={},segmenter.MAX_VALUE_LENGTH=20,optly.client.Facade=function(){},extend(optly.client.Facade.prototype,{getBrowserId:user.getBrowserId,getBrowserVersion:user.getBrowserVersion,getMobileId:user.getMobileId,isMobile:user.isMobile,getBrowser:function(){return{id:this.getBrowserId(),version:this.getBrowserVersion(),mobileId:this.getMobileId()}},getCampaign:function(){return this.getQueryParameter("utm_campaign")},getCookie:cookie.get,getDevice:user.getDevice,getIP:asyncInfo.getIP,getJSVariable:function(e){try{return window[e]}catch(e){return null}},getBehaviorEvents:behavior.getEvents,getBrowserLanguage:user.getBrowserLanguage,getDefaultBehaviorAttributes:behavior.getDefaultAttributes,getLocation:asyncInfo.getLocation,getCurrentUrl:user.getCurrentUrl,getNewVsReturning:user.getNewVsReturning,getIsFirstSession:user.isFirstSession,getAllQueryParameters:query.getAllParameters,getPlatform:user.getPlatform,getReferrer:user.getReferrer,getThirdPartyData:function(e){var t=e.split("."),i=t[0],n=t.slice(1);return integrator.getThirdPartyData(i,n)},hasPPID:id.hasPPID,getReferringDomain:function(){return user.getDomain(this.getReferrer())},getSegmentsList:segmenter.getSegmentsList,getSourceType:segmenter.getSourceType,getDocumentReferrer:function(){return document.referrer},getQueryParameter:function(e){return query.getValue(e,this.getAllQueryParameters())},getCustomTags:function(){return api.customTags},getCustomTagValue:function(e){return(this.getCustomTags()||{})[e]},getTriggeredCustomEvents:function(){var e=(optly.client.storage.localStorage.get(CUSTOM_EVENTS_STORAGE_NAME)||{})[id.getOrGenerateId()]||[];return isArrayLike(e)?e:[]},hasSegment:function(e){return arrayContains(this.getSegmentsList(),e)},triggeredCustomEvent:function(e){return arrayContains(this.getTriggeredCustomEvents(),e)},getDate:function(){return new Date},getListMembershipStatus:asyncInfo.getListMembershipStatus,getDynamicCustomerProfileConditions:asyncInfo.getDynamicCustomerProfileConditions}),condition.facade=new optly.client.Facade,rules.Rule,rules.getValueOrDefault=function(e,t,i){if(e.getValueOrDefault)return e.getValueOrDefault(t,i);var n=getFieldValue(e,t);return void 0===n&&(n=i),n},rules.maybeTrimLowerCase=function(e){return"string"==typeof e?trim(e).toLowerCase():e},rules.clause={WHERE:"where",GROUP_BY:"groupBy",AGGREGATE:"aggregate",HAVING:"having",ORDER_BY:"orderBy",SELECT:"select",LIMIT:"limit",FROM:"from"},rules.DEFAULT_FIELD=["*"],rules.booleanOperators={eq:function(e){var t=map(e,rules.maybeTrimLowerCase);return t[0]==t[1]},is:function(e){return e[0]===e[1]},gt:function(e){return e[0]>e[1]},lt:function(e){return e[0]<e[1]},gte:function(e){return e[0]>=e[1]},lte:function(e){return e[0]<=e[1]},in:function(e){return arrayContains(map(e[1]||[],rules.maybeTrimLowerCase),rules.maybeTrimLowerCase(e[0]))},between:function(e){return e[1]<=e[0]&&e[0]<=e[2]},contains:function(e){var t=map(e,function(e){return"string"==typeof e?e.toLowerCase():e});return-1!==(t[0]||"").indexOf(t[1])},regex:function(e){try{var t,i;return"string"==typeof e[1]?(t=e[1],i="i"):(t=e[1][0]||"",i=e[1][1]||""),new RegExp(t,i).test(e[0])}catch(e){return log("Rules",'In operator "regex", error: '+(e.message||"invalid RegExp /"+[t,i].join("/"))),!1}},exists:function(e){return void 0!==e[0]},and:function(e){return every(e,function(e){return e})},or:function(e){return any(e,function(e){return e})},not:function(e){return!e[0]}},rules.arithmeticOperators={"+":function(e){return(e[0]||0)+(e[1]||0)},"-":function(e){return(e[0]||0)-(e[1]||0)},"/":function(e){return(e[0]||0)/(e[1]||1)},"%":function(e){return(e[0]||0)%(e[1]||1)}},rules.aggregateOperators={sum:function(e,t){for(var i=e[0]||rules.DEFAULT_FIELD,n=0,r=0;r<t.length;r++)n+=rules.getValueOrDefault(t[r],i,0);return n},avg:function(e,t){if(0==t.length)return 0;for(var i=e[0]||rules.DEFAULT_FIELD,n=0,r=0;r<t.length;r++)n+=rules.getValueOrDefault(t[r],i,0);return n/t.length},max:function(e,t){for(var i=e[0]||rules.DEFAULT_FIELD,n=Number.NEGATIVE_INFINITY,r=0;r<t.length;r++)n=Math.max(n,rules.getValueOrDefault(t[r],i,Number.NEGATIVE_INFINITY));return n},min:function(e,t){for(var i=e[0]||rules.DEFAULT_FIELD,n=Number.POSITIVE_INFINITY,r=0;r<t.length;r++)n=Math.min(n,rules.getValueOrDefault(t[r],i,Number.POSITIVE_INFINITY));return n},count:function(e,t){return t.length}},rules.functions={now:function(){return+new Date}},rules.getScalarOperator=function(e){return e in rules.booleanOperators?rules.booleanOperators[e]:e in rules.arithmeticOperators?rules.arithmeticOperators[e]:null},rules.operate=function(e,t){if(t.hasOwnProperty("value"))return t.value;if(t.hasOwnProperty("field"))return rules.getValueOrDefault(e,t.field);if(t.hasOwnProperty("eval"))return t.eval in rules.functions?rules.functions[t.eval]():void log("Rules","Unknown function: "+t.eval);if(t.op){var i=rules.getScalarOperator(t.op);if(i){var n=goog.partial(rules.operate,e);return i(map(t.args||[],function(e){return n(e)}),e)}log("Rules","Unknown operator: "+t.op)}else log("Rules","No operator specified: "+json.stringify(t))},rules.DEFAULT_GROUP_BY_VALUE="_",rules.groupBy=function(e,t){if(void 0===e||!isArrayLike(e)||0===e.length){var i={},n={};return n[rules.DEFAULT_FIELD]=rules.DEFAULT_GROUP_BY_VALUE,i[rules.DEFAULT_FIELD+"="+rules.DEFAULT_GROUP_BY_VALUE]={fieldValues:n,events:t},i}for(var r=map(e,function(e){return e.field}),a={},o=0;o<t.length;o++){for(var s=t[o],c=[],l={},d=0;d<r.length;d++){var u=r[d],g=rules.getValueOrDefault(s,u,rules.DEFAULT_GROUP_BY_VALUE),p=u.join(".");l[p]=g,c.push(encodeURIComponent(p)+"="+encodeURIComponent(String(g)))}var m=c.join("&");a.hasOwnProperty(m)||(a[m]={fieldValues:l,events:[]}),a[m].events.push(s)}return a},rules.generateAlias=function(e,t){return"_"+e+"_"+t.join(".")},rules.aggregate=function(c,e){var l={};return each(e,function(e,t){l[e]={};for(var i=0;i<c.length;i++){var n=c[i],r=n.op;if(r in rules.aggregateOperators){var a=(n.args&&n.args[0]||{}).field||rules.DEFAULT_FIELD,o=rules.generateAlias(r,a),s=rules.aggregateOperators[r]([a],t.events);l[e][o]=s}else log("Rules","Unknown aggregate operator "+r)}}),l},rules.project=function(e,n){var r=[];return each(e,function(e,t){var i=extend({},t.fieldValues);extend(i,n[e]||{}),r.push(i)}),r},rules.orderBy=function(c,e){return isArrayLike(c)?0==c.length?e:e.sort(function(e,t){for(var i=0;i<c.length;i++){var n=c[i],r="ASC"===(n.direction||"ASC")?1:-1,a=n.field,o=rules.getValueOrDefault(e,a,0),s=rules.getValueOrDefault(t,a,0);if(o<s)return-r;if(s<o)return r}return 0}):(log("Rules","groupBy rule must be an array"),e)},rules.rewrite=function(e){var s=[],c={};function l(e,t){if(isArrayLike(e)&&("and"!==e[0]&&"or"!==e[0]&&"not"!==e[0]&&log("Rules","Unexpected operation "+e[0]+". Continuing optimistically."),e={op:e[0],args:e.slice(1)}),e.hasOwnProperty("field")||e.hasOwnProperty("value")||e.hasOwnProperty("eval"))return e;if(t&&e.op in rules.aggregateOperators){var i=(e.args&&e.args[0]||{}).field||rules.DEFAULT_FIELD,n=rules.generateAlias(e.op,i);return n in c||(s.push({op:e.op,args:e.args}),c[n]=!0),{field:[n]}}for(var r=[],a=e.args||[],o=0;o<a.length;o++)r[o]=l(a[o],t);return{op:e.op,args:r}}var t={};e.hasOwnProperty(rules.clause.WHERE)&&(t[rules.clause.WHERE]=l(e[rules.clause.WHERE],!1)),e.hasOwnProperty(rules.clause.HAVING)&&(t[rules.clause.HAVING]=l(e[rules.clause.HAVING],!0)),(e.hasOwnProperty(rules.clause.AGGREGATE)||0<s.length)&&(t[rules.clause.AGGREGATE]=(e[rules.clause.AGGREGATE]||[]).concat(s));for(var i=[rules.clause.GROUP_BY,rules.clause.ORDER_BY,rules.clause.SELECT,rules.clause.LIMIT],n=0;n<i.length;n++)e.hasOwnProperty(i[n])&&(t[i[n]]=e[i[n]]);return e.hasOwnProperty(rules.clause.FROM)&&(t[rules.clause.FROM]=rules.rewrite(e[rules.clause.FROM])),t},rules.verify=function(e,t){t=t||0;var i=[];if(e.hasOwnProperty(rules.clause.WHERE)?e[rules.clause.WHERE].op?e[rules.clause.WHERE].op in rules.booleanOperators||i.push("Non-boolean WHERE clause operator"):i.push("Missing WHERE clause operator"):i.push("Missing WHERE clause"),e.hasOwnProperty(rules.clause.HAVING)&&(e[rules.clause.HAVING].op?e[rules.clause.HAVING].op in rules.booleanOperators||i.push("Non-boolean HAVING clause operator"):i.push("Missing HAVING clause operator")),e.hasOwnProperty(rules.clause.GROUP_BY)&&!e.hasOwnProperty(rules.clause.AGGREGATE)&&i.push("No AGGREGATE clause specified with GROUP_BY clause"),e.hasOwnProperty(rules.clause.SELECT)){var n=e[rules.clause.SELECT];if(isArrayLike(n))for(var r=0;r<n.length;r++)n[r].op&&n[r].op in rules.aggregateOperators&&i.push('In SELECT clause, aggregate operator "'+n[r].op+'" specified in selector at index '+r);else i.push("SELECT clause must be an array")}if(e.hasOwnProperty(rules.clause.LIMIT)){var a=e[rules.clause.LIMIT];(!isNumberLike(a)||Number(a)<=0||Number(a)!=Math.floor(Number(a)))&&i.push("LIMIT must be a positive integer")}return 0<t&&(i=map(i,function(e){return"Sub-rule "+t+": "+e})),e.hasOwnProperty(rules.clause.FROM)&&(i=i.concat(rules.verify(e[rules.clause.FROM],t+1))),i},rules.select=function(e,t){return map(t,function(t){return map(e,function(e){return rules.operate(t,e)})})},rules.executeRecursively=function(t,e){var i=e;if(t.hasOwnProperty(rules.clause.FROM)&&(i=rules.executeRecursively(t[rules.clause.FROM],i)),i=filter(i,function(e){return rules.operate(e,t[rules.clause.WHERE])}),t.hasOwnProperty(rules.clause.AGGREGATE)){var n=rules.groupBy(t[rules.clause.GROUP_BY],i),r=rules.aggregate(t[rules.clause.AGGREGATE],n);i=rules.project(n,r)}if(t.hasOwnProperty(rules.clause.HAVING)&&(i=filter(i,function(e){return rules.operate(e,t[rules.clause.HAVING])})),t.hasOwnProperty(rules.clause.ORDER_BY)&&(i=rules.orderBy(t[rules.clause.ORDER_BY],i)),t.hasOwnProperty(rules.clause.LIMIT)){var a=Number(t[rules.clause.LIMIT]);i=i.slice(0,a)}return t.hasOwnProperty(rules.clause.SELECT)&&(i=rules.select(t[rules.clause.SELECT],i)),i},rules.execute=function(e,t){e=rules.rewrite(e);var i=rules.verify(e);if(0<i.length)throw new Error("Rule "+json.stringify(e)+" has violations: "+i.join("\n"));return rules.executeRecursively(e,t)},rules.isSatisfied=function(t,e){try{return 0<rules.execute(t,e).length}catch(e){return log("Rules","Error "+e.toString()+" while evaluating rule "+json.stringify(t)),!1}},optly.Visitor=function(){this.audiences={},this.dimensions={},this.persistentAudiences={},this.segmentationAudiences={}},optly.Visitor.prototype.initialize=function(){timer.addEvent("Visitor","Initializing"),this.loadPersistentAudiences(),each(segmenter.getSegmentsList(),goog.bind(function(e){timer.addEvent("Visitor","Found segment "+e);var t=data.getSegment(e);t&&t.audience_id?(timer.addEvent("Visitor","Adding to audience "+t.audience_id),this.setInAudience(t.audience_id,!0,{updateSegment:!1})):t&&t.dimension_id&&(timer.addEvent("Visitor","Setting dimension value "+t.dimension_id),this.saveDimensionValue(t.dimension_id,segmenter.getSegmentValue(e),!1))},this))},optly.Visitor.prototype.isInAudience=function(e){var t=this.persistentAudiences.hasOwnProperty(e)||this.segmentationAudiences.hasOwnProperty(e);if(!this.audiences.hasOwnProperty(e)||!t)try{this.audiences[e]=this.testAudienceConditions(e)}catch(e){timer.addEvent("Visitor","Error: "+e.message)}return this.audiences[e]},optly.Visitor.prototype.setInAudience=function(e,t,i){if(i=extend({persist:!0,savePersistentAudiences:!0,updateSegment:!0},i),data.getAudience(e)){this.audiences[e]=t;var n=data.getAudienceSegmentId(e);n?this.segmentationAudiences[e]=t:i.persist?this.persistentAudiences[e]=t:delete this.persistentAudiences[e],n&&i.updateSegment&&this.updateSegment(n,t),!n&&i.persist&&i.savePersistentAudiences&&this.persistAudiences()}else timer.addEvent("Visitor","Unable to find audience "+e)},optly.Visitor.prototype.addToAudience=function(e){this.setInAudience(e,!0)},optly.Visitor.prototype.removeFromAudience=function(e){this.setInAudience(e,!1)},optly.Visitor.prototype.removeFromAllAudiences=function(){each(this.audiences,goog.bind(function(e){this.setInAudience(e,!1,{persist:!!this.persistentAudiences.hasOwnProperty(e)})},this))},optly.Visitor.prototype.getAudiences=function(){return this.audiences},optly.Visitor.prototype.getDimensionValue=function(e){var t=void 0;if(this.dimensions.hasOwnProperty(e))t=this.dimensions[e];else try{t=this.calculateDimensionValue(e)}catch(e){timer.addEvent("Visitor","Error: "+e.message)}return t},optly.Visitor.prototype.getDimensionValues=function(){return this.dimensions},optly.Visitor.prototype.saveDimensionValue=function(e,t,i){return i=!isDefined(i)||i,isDefined(t)&&null!==t&&String(t)?(i&&(t=segmenter.standardizeValue(String(t),!1)),this.dimensions[e]=t):delete this.dimensions[e],this.dimensions[e]},optly.Visitor.prototype.setDimensionValue=function(e,t,i){var n=data.getDimensionIdByApiName(e)||e;if(data.getDimension(n))if("custom_dimension"===data.getDimensionType(n)){t=this.saveDimensionValue(n,t,i);var r=data.getDimensionSegmentId(n);r&&this.updateSegment(r,t),timer.addEvent("Visitor",'Set dimension "'+n+'" to "'+t+'"')}else timer.addEvent("Visitor",'Unknown dimension "'+n+'"');else timer.addEvent("Visitor","Unable to find dimension "+e)},optly.Visitor.prototype.calculateDimensionValue=function(e){var t,i,n=data.getDimensionType(e)||"";if(!data.getDimension(e))throw new Error(goog.DEBUG?"Unable to find dimension for id: "+e:e);if("custom_dimension"===n)throw new Error(goog.DEBUG?"calculateDimensionValue called on custom dimension "+e:e);return(t=optly.Visitor.getConditionGetter(n))&&(i=t(data.getDimensionName(e))),timer.addEvent("Visitor","Got dimension ("+n+") value "+e+": "+json.stringify(i)),i},optly.Visitor.prototype.testAudienceConditions=function(e){var t=data.getAudience(e);if(!t)throw new Error("Unable to find audience for id: "+e);var i=condition.compoundTest(this,t.conditions);return timer.addEvent("Visitor","Checking if in audience "+e+": "+i),i},optly.Visitor.prototype.updateSegment=function(e,t){t?segmenter.addToSegment(e,t):segmenter.removeFromSegment(e)},optly.Visitor.prototype.loadPersistentAudiences=function(){var e=cookie.get(AUDIENCE_COOKIE_NAME);e&&0<e.length&&each(e.split(","),goog.bind(function(e){this.setInAudience(e,!0,{persist:!0,savePersistentAudiences:!1})},this))},optly.Visitor.prototype.persistAudiences=function(){var t=[];each(this.persistentAudiences,goog.bind(function(e){this.audiences[e]&&t.push(e)},this)),t.sort(),cookie.set(AUDIENCE_COOKIE_NAME,t.join(","),DEFAULT_TRACKING_COOKIE_EXPIRATION)},optly.Visitor.getConditionGetter=function(e){return{browser:goog.bind(condition.facade.getBrowser,condition.facade),browser_version:goog.bind(condition.facade.getBrowser,condition.facade),behavior:goog.bind(condition.facade.getBehaviorEvents,condition.facade),campaign:goog.partial(segmenter.getSegmentValueFromType,"campaign"),cookies:goog.bind(condition.facade.getCookie,condition.facade),custom_tag:goog.bind(condition.facade.getCustomTagValue,condition.facade),default_behavior:goog.bind(condition.facade.getDefaultBehaviorAttributes,condition.facade),device:goog.bind(condition.facade.getDevice,condition.facade),event:goog.bind(condition.facade.triggeredCustomEvent,condition.facade),first_session:goog.bind(condition.facade.getIsFirstSession,condition.facade),has_ppid:goog.bind(condition.facade.hasPPID,condition.facade),ip:goog.bind(condition.facade.getIP,condition.facade),language:goog.bind(condition.facade.getBrowserLanguage,condition.facade),list:goog.bind(condition.facade.getListMembershipStatus,condition.facade),location:goog.bind(condition.facade.getLocation,condition.facade),query:goog.bind(condition.facade.getQueryParameter,condition.facade),platform:goog.bind(condition.facade.getPlatform,condition.facade),referrer:goog.bind(condition.facade.getReferrer,condition.facade),segment:goog.bind(condition.facade.hasSegment,condition.facade),source_type:goog.partial(segmenter.getSegmentValueFromType,"source_type"),third_party_dimension:goog.bind(condition.facade.getThirdPartyData,condition.facade),time_and_day:goog.bind(condition.facade.getDate,condition.facade),url:goog.bind(condition.facade.getCurrentUrl,condition.facade),visitor:goog.bind(condition.facade.getNewVsReturning,condition.facade),dynamic_customer_profile:goog.bind(condition.facade.getDynamicCustomerProfileConditions,condition.facade)}[e]};var visitor=new optly.Visitor;rule_builder.MILLIS_IN_A_DAY=864e5,rule_builder.aggregateField=function(e,t){return isString(t)&&(t=[t]),t=t||rules.DEFAULT_FIELD,[rules.generateAlias(e,t)]},rule_builder.groupField=function(e){return isString(e)&&(e=[e]),[(e=e||rules.DEFAULT_FIELD).join(".")]};var OP_MAP={"<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","==":"eq"},hE;function canonicalizeOperator(e){return e=trim((e||"").toString()),OP_MAP[e]||e}function buildPicker(e,t,i){var n={where:t};if(e.count&&(n.limit=e.count),e.modifier===rule_builder.FREQUENCY_FILTERS.MOST_FREQUENT){var r=rule_builder.getFieldKeyPathForSource(e.name,i),a=rule_builder.aggregate("count"),o=rule_builder.aggregateField("count");return extend(n,{select:[{field:rule_builder.groupField(r)}],groupBy:rule_builder.groupBy([r]),aggregate:[a],orderBy:[{field:o,direction:"DESC"}]})}return extend(n,{orderBy:[{field:[behavior.FIELDS.TIME],direction:"DESC"}]})}rule_builder.fieldComparison=function(e,t,i){return isString(t)&&(t=[t]),{op:canonicalizeOperator(e),args:[{field:t},{value:i}]}},rule_builder.relativeTimeComparison=function(e,t){return{op:canonicalizeOperator(e),args:[{op:"-",args:[{eval:"now"},{field:[behavior.FIELDS.TIME]}]},{value:t*rule_builder.MILLIS_IN_A_DAY}]}},rule_builder.rangeTimeComparison=function(e){return isArrayLike(e)?{op:"between",args:[{field:[behavior.FIELDS.TIME]},{value:e[0]||+new Date(0)},{value:e[1]||+new Date}]}:(timer.addEvent("Rule builder","rangeTimeComparison passed invalid range "+json.stringify(e)),null)},rule_builder.groupBy=function(e){for(var t=[],i=0;i<e.length;i++)t[i]={field:e[i]};return t},rule_builder.aggregate=function(e,t){return isString(t)&&(t=[t]),{op:e,args:[{field:t=t||rules.DEFAULT_FIELD}]}},rule_builder.SOURCE_TYPES={BEHAVIOR:"events",DEFAULT_BEHAVIOR:"default_behavior",CUSTOM_BEHAVIOR:"custom_behavior",DCP:"dcp"},rule_builder.FREQUENCY_FILTERS={MOST_FREQUENT:"most_frequent",LEAST_FREQUENT:"least_frequent"},rule_builder.RECENCY_FILTERS={MOST_RECENT:"most_recent",LEAST_RECENT:"least_recent"},rule_builder.TOP_LEVEL_BEHAVIOR_FIELDS=(hE={},each(behavior.FIELDS,function(e,t){hE[t]=!0}),hE),rule_builder.getFieldKeyPathForSource=function(e,t){t=t||rule_builder.SOURCE_TYPES.BEHAVIOR;var i=[];return isString(e)?(i=[e],t!==rule_builder.SOURCE_TYPES.BEHAVIOR||e in rule_builder.TOP_LEVEL_BEHAVIOR_FIELDS||(i=[behavior.FIELDS.OPTIONS,e])):i=e,i},rule_builder.BehaviorTagFilterSpec,rule_builder.BehaviorAudienceSpec,rule_builder.buildFromSpec=function(o){if(!(o.action||o.filters&&0!==o.filters.length))throw new Error('Audience spec must have an "action" field or at least one "filter" '+json.stringify(o));var s=rule_builder.fieldComparison("gt",behavior.FIELDS.TIME,0),c=[],l=[];if(o.action&&(l.push(rule_builder.fieldComparison("eq",behavior.FIELDS.NAME,o.action.value)),o.action.type&&l.push(rule_builder.fieldComparison("eq",behavior.FIELDS.TYPE,o.action.type))),o.time)if("last_days"===o.time.type)l.push(rule_builder.relativeTimeComparison("lte",o.time.days));else if("range"===o.time.type){var e=rule_builder.rangeTimeComparison([o.time.start,o.time.stop]);e&&l.push(e)}else timer.addEvent("Rule builder",'Audience spec has bad "time" type',o.time.type);if(s={op:"and",args:l},o.count&&c.push({where:rule_builder.fieldComparison(o.count.comparator,"0",o.count.value),from:{select:[{field:rule_builder.aggregateField("count")}],where:s,aggregate:[rule_builder.aggregate("count")]}}),o.filters&&each(o.filters,function(e){var t,i,n=rule_builder.getFieldKeyPathForSource(e.name,o.source);if(e.modifier===rule_builder.FREQUENCY_FILTERS.MOST_FREQUENT?(t=rule_builder.aggregate("count"),i=rule_builder.aggregateField("count")):e.modifier===rule_builder.RECENCY_FILTERS.MOST_RECENT&&(t=rule_builder.aggregate("max",behavior.FIELDS.TIME),i=rule_builder.aggregateField("max",behavior.FIELDS.TIME)),t){var r=n,a=rule_builder.groupField(r);c.push({where:rule_builder.fieldComparison(e.comparator,"0",e.value),from:{select:[{field:a}],where:s,groupBy:rule_builder.groupBy([r]),aggregate:[t],orderBy:[{field:i,direction:"DESC"}],limit:1}})}else l.push(rule_builder.fieldComparison(e.comparator,n,e.value))}),o.pick){if(0<c.length)throw new Error('A "pick" clause must not be specified with "count" or "most_recent", "most_frequent" modifiers'+json.stringify(o));return[buildPicker(o.pick,s,o.source)]}return 0<c.length?c:[{where:s}]},optly.timeAndDayInterval.DELIM="_",optly.timeAndDayInterval.DAYS_DELIM=",",optly.timeAndDayInterval.TIME_DELIM=":",optly.timeAndDayInterval.serialize=function(e){return e.start_time+optly.timeAndDayInterval.DELIM+e.end_time+optly.timeAndDayInterval.DELIM+e.days.join(optly.timeAndDayInterval.DAYS_DELIM)},optly.timeAndDayInterval.deserialize=function(e){var t=e.split(optly.timeAndDayInterval.DELIM);if(3!==t.length)throw new Error("Invalid time and day string "+e);var i=t[2].split(optly.timeAndDayInterval.DAYS_DELIM);return{start_time:t[0],end_time:t[1],days:i}},optly.timeAndDayInterval.timeStringToMinutes=function(e){var t=e.split(optly.timeAndDayInterval.TIME_DELIM);if(2!==t.length)throw new Error("optly.timeAndDayInterval.timeStringToMinutes: Invalid time string "+e);return 60*parseInt(t[0],10)+parseInt(t[1],10)},optly.timeAndDayInterval.test=function(e,t){var i=optly.timeAndDayInterval.deserialize(e),n=optly.timeAndDayInterval.timeStringToMinutes(i.start_time),r=optly.timeAndDayInterval.timeStringToMinutes(i.end_time),a=60*t.getHours()+t.getMinutes(),o=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][t.getDay()];return n<=a&&a<=r&&-1!==$.inArray(o,i.days)},condition.DimensionCondition,condition.test=function(e,t){var i=!!t.manualActivation,n=t.objectType?t.objectType:"experiment",r="experiment"===n,a=t.enabledStatus,o=t.visitor||visitor;timer.addEvent("Condition","Testing "+n+" "+e);var s=r&&(isDefined(a)?!!a:data.isExperimentEnabled(e)),c=r&&data.isExperimentManuallyActivated(e),l=data.getConditions(e,n);if(r&&!s)return timer.addEvent("Condition","Failed for "+n+" "+e+" (paused)"),optly.client.preview.Logger.setReason(e,"it is paused"),!1;if(r&&!i&&c)return timer.addEvent("Condition"," Failed for "+n+" "+e+" (manual activation mode)"),optly.client.preview.Logger.setReason(e,"it is set to use manual activation mode"),!1;if(l){if(!condition.testLegacyConditions(l,e,n))return timer.addEvent("Condition","Failed for "+n+" "+e+" (condition failed)"),!1}else if(!condition.testAudienceConditions(o,e,n))return!1;return!0},condition.testAudienceConditions=function(e,t,i){var n=[],r=[];if("experiment"===i)n=data.getExperimentAudienceIds(t),r=data.getExperimentUrls(t)||[];else{if("segment"!==i)return timer.addEvent("Condition","Not a valid objectType: "+i),!1;var a=data.getSegmentAudienceId(t);a&&(n=[a])}return 0<n.length&&(timer.addEvent("Condition","Testing audiences for "+i+" "+t+": "+n),!any(n,goog.bind(e.isInAudience,e)))?(timer.addEvent("Condition","Failed to match any audiences for "+i+" "+t),!1):!(0<r.length&&(timer.addEvent("Condition","Testing URLs for "+i+" "+t),!condition.testUrlDimensionValues(r,condition.facade.getCurrentUrl())))||(timer.addEvent("Condition","Failed to match any URL for "+i+" "+t),!1)},condition.testUrlDimensionValues=function(e,t){var i=[],n=[];each(e,function(e){e.negate?n.push(e):i.push(e)});var r=function(e){return any(e,function(e){return condition.testUrl(t,e)})};return!r(n)&&(0===i.length||r(i))},condition.testLegacyConditions=function(e,s,t){var c="experiment"===(t=t||"experiment"),l=!0,d=condition.legacyTestFunctions;return each(e,function(e){var t=e.type;if(c&&e.only_first_time&&plan.containsExperiment(s)&&!optly.client.preview.ENABLED)timer.addEvent("Condition",t+" condition passed because it only gets checked when bucketing",!0);else{var i=d[t],n=!e.not,r=i(e),a=r!==n,o="the visitor "+(r?"passed":"failed")+" a "+t+" targeting condition  when it needed to "+(n?"pass":"fail");if(timer.addEvent("Condition","Found that "+o,!a),a)return l=!1,optly.client.preview.Logger.setReason(s,o),!1}}),l},condition.testBrowsers=function(e){var t=condition.facade.getBrowser();return any(e.values,function(e){return condition.testBrowser(t,{value:e})})},condition.compareVersion=function(e,t){if(!t)return 0;for(var i=t.toString().split("."),n=e.toString().split("."),r=0;r<i.length;r++){if(!isDefined(n[r]))return-1;if(isNaN(Number(n[r]))){if(n[r]!==i[r])return-1}else{if(Number(n[r])<Number(i[r]))return-1;if(Number(n[r])>Number(i[r]))return 1}}return 0},condition.testBrowser=user.LEGACY_BROWSER?function(e,t){var i=t.value,n=e.id,r=e.version,a=e.mobileId;if(a&&"unknown"!==a)return timer.addEvent("Condition",a,!0),"mobile"===i||i===a;if(0===i.indexOf(n)){var o=i.substr(n.length);return 0===condition.compareVersion(r,o)}return!1}:goog.nullFunction,condition.testBrowserVersion=function(e,t){var i=t.value,n=e.id,r=e.version;if(0===i.indexOf(n)){var a=i.substr(n.length);return 0===condition.compareVersion(r,a)}return!1},condition.testBehavior=function(t,e){try{var i=[],n=json.parse(e.value);return i=isDefined(n.version)?rule_builder.buildFromSpec(n):[n],every(i,function(e){return rules.isSatisfied(e,t)})}catch(e){}return!1},condition.testDefaultBehavior=function(e,t){try{e=e||{};var i=json.parse(t.value);return rules.isSatisfied(i,[e])}catch(e){}return!1},condition.testCampaign=function(e,t){var i=t.value;return"string"==typeof i&&("regex"===t.match?e=safeDecodeUriComponent(e):i=segmenter.standardizeValue(i)),"none"===e&&(e=null),condition.hasMatch(i,t.match,e)},condition.testCode=function(e){return condition.testCodeResult(null,e)},condition.testCodeResult=function(e,t){var i=t.value;if(void 0===i)return!0;try{return Boolean(evaluator.executeCode(i))}catch(e){return!1}},condition.testCookies=function(e){for(var t,i=e.names||[],n=e.values||[],r=0;r<i.length;r++)if(t=i[r],condition.testCookie(condition.facade.getCookie(t),{value:n[r]||void 0}))return!0;return!1},condition.testCookie=function(e,t){return condition.hasMatch(t.value,t.match,e)},condition.testTimeAndDay=function(e,t){return optly.timeAndDayInterval.test(t.value,e)},condition.testList=function(e,t){if(null===e||!isDefined(e))return!1;var i=t.value;return isDefined(i)?e.toString()===i:""===e||!1!==e},condition.testCustomDimension=function(e,t){var i=t.value;return isDefined(i)?i==e:isDefined(e)},condition.testCustomTags=function(e){return any(e.values,function(e){var t=e.key;return condition.testCustomTag(condition.facade.getCustomTagValue(t),{value:e.value})})},condition.testCustomTag=function(e,t){return condition.hasMatch(t.value,t.match,e)},condition.testDevice=function(e,t){var i=t.value;return"unknown"!==e.id?e.id===i:"tablet"===i?"tablet"===e.type:"mobile"===i?e.isMobile&&"tablet"!==e.type:"desktop"===i&&!e.isMobile},condition.testEvents=function(e){return any(e.values,function(e){var t=condition.facade.triggeredCustomEvent(e);return condition.testEvent(t)})},condition.testEvent=function(e){return e},condition.testFirstSession=function(e){return e},condition.testHasPPID=function(e){return e},condition.testIPs=function(e){var t=condition.facade.getIP();return any(e.values,goog.partial(condition.testIP,t))},condition.testIP=function(e,t){if(null===e)return!1;var i=t.value;switch(t.match){case"exact":if(e==i&&""!=e)return!0;break;case"prefix":if(0==e.indexOf(i))return!0;break;case"regex":try{var n=new RegExp(i)}catch(e){return!1}if(n.test(e))return!0;break;case"cidr":try{return new optly.CIDR(i).containsIP(e)}catch(e){return!1}}return!1},condition.testLanguages=function(e){var t=condition.facade.getBrowserLanguage();return any(e.values,function(e){return condition.testLanguage(t,{value:e})})},condition.testLanguage=function(e,t){var i=t.value;return"any"===i||0===e.indexOf(i)},condition.testLocations=function(e){var t=condition.facade.getLocation();return any(e.values,function(e){return condition.testLocation(t,{value:e})})},condition.testLocation=function(e,t){if(null===e)return!1;var i=t.value.split("|"),n=$.trim(i[0]),r=$.trim(i[1]),a=$.trim(i[2]),o=$.trim(i[3]);switch(i.length){case 1:if(e.country===n)return!0;break;case 2:if(e.region===r&&e.country===n)return!0;break;case 3:if(e.city===a&&(e.region===r||""===r)&&e.country===n)return!0;break;case 4:if(e.continent===o)return!0}return!1},condition.testPlatform=function(e,t){var i=t.value.split("_"),n=i[0],r=i.slice(1);return n===e.id&&(0===r.length||(1<r.length?0<=condition.compareVersion(e.version,r[0])&&condition.compareVersion(e.version,r[1])<=0:0===condition.compareVersion(e.version,r[0])))},condition.testQueries=function(e){return 0===e.values.length||any(e.values,function(e){var t=e.key;return condition.testQueryParam(condition.facade.getQueryParameter(t),{value:e.value})})},condition.testQueryParam=function(e,t){return condition.hasMatch(t.value,t.match,e)},condition.testReferrers=function(e){var t=condition.facade.getDocumentReferrer();return any(e.values,goog.partial(condition.testReferrer,t))},condition.testReferrer=function(e,t){var i=t.value,n=t.match;return timer.addEvent("Condition","Testing referrer "+e+" against  "+i+" ("+n+")",!0),optly.match.matchUrl(e,i,n)},condition.testSegments=function(e){var t=condition.facade.getSegmentsList();return any(e.values,function(e){return condition.testSegment(inArray(e,t))})},condition.testSegment=function(e){return!!e},condition.testSourceType=function(e,t){return t.value===e},condition.testThirdPartyDimension=function(e,t){return isArrayLike(e)?any(e,goog.partial(condition.hasMatch,t.value,t.match)):condition.hasMatch(t.value,t.match,e)},condition.testUrls=function(e){var t=condition.facade.getCurrentUrl();return any(e.values,goog.partial(condition.testUrl,t))},condition.testUrl=function(e,t){var i=t.value,n=t.match;return timer.addEvent("Condition","Testing URL "+e+" against  "+i+" ("+n+")",!0),optly.match.matchUrl(e,i,n)},condition.testVisitor=function(e){var t=condition.facade.getNewVsReturning();return condition.testVisitorValue(t,e)},condition.testVisitorValue=function(e,t){switch(t.value){case"new":return"returning"!==e;case"returning":return"returning"===e}return!0},condition.testDynamicCustomerProfileCondition=function(e,t){return null!==e&&!!e[t.value]},condition.compoundTest=function(t,e){var i={and:function(e){return every(e,goog.partial(condition.compoundTest,t))},or:function(e){return any(e,goog.partial(condition.compoundTest,t))},not:function(e){if(1!==e.length)throw new Error(goog.DEBUG&&'"not" argument too long: '+json.stringify(e));return!condition.compoundTest(t,e[0])}};if(isArrayLike(e)){if(e[0]in i)return i[e[0]](e.slice(1));throw new Error(goog.DEBUG&&"Not an operator")}var n=e.dimension_id,r=data.getDimensionType(n),a=e.value;if(!r)throw new Error(goog.DEBUG&&"No dimension type for dimension: "+n);var o=condition.matchers[r];if(!o)throw new Error(goog.DEBUG&&"Unknown dimension type: "+r);return o(t.getDimensionValue(n),{value:a,match:e.match||"exact"})},condition.isReadyToTest=function(e){var t=!0;if(data.usesAudiences(e)){var i=[data.getSegmentAudienceId(e)];i[0]||(i=data.getExperimentAudienceIds(e)),t=every(i,function(e){var t=data.getAudience(e);return!t.conditions||condition.compoundReadyToTest(t.conditions)})}else data.isGeotargetingEnabled(e)&&(t=condition.matchersReadyToTest.ip(null)||condition.matchersReadyToTest.location(null));return t||timer.addEvent("Condition","Not ready to test (geotargeting): "+e),t},condition.compoundReadyToTest=function(e){if(isArrayLike(e))return every(e.slice(1),condition.compoundReadyToTest);var t=e.dimension_id,i=data.getDimensionType(t)||"",n=condition.matchersReadyToTest[i];return!n||n(e)},condition.legacyTestFunctions={browser:condition.testBrowsers,code:condition.testCode,cookies:condition.testCookies,custom_tag:condition.testCustomTags,event:condition.testEvents,ip:condition.testIPs,language:condition.testLanguages,location:condition.testLocations,query:condition.testQueries,referrer:condition.testReferrers,segment:condition.testSegments,url:condition.testUrls,visitor:condition.testVisitor},condition.matchers={browser:condition.testBrowser,browser_version:condition.testBrowserVersion,behavior:condition.testBehavior,campaign:condition.testCampaign,code:condition.testCodeResult,cookies:condition.testCookie,custom_dimension:condition.testCustomDimension,custom_tag:condition.testCustomTag,default_behavior:condition.testDefaultBehavior,device:condition.testDevice,event:condition.testEvent,first_session:condition.testFirstSession,ip:condition.testIP,language:condition.testLanguage,list:condition.testList,location:condition.testLocation,query:condition.testQueryParam,platform:condition.testPlatform,referrer:condition.testReferrer,segment:condition.testSegment,source_type:condition.testSourceType,time_and_day:condition.testTimeAndDay,third_party_dimension:condition.testThirdPartyDimension,url:condition.testUrl,visitor:condition.testVisitorValue,dynamic_customer_profile:condition.testDynamicCustomerProfileCondition,has_ppid:condition.testHasPPID},condition.matchersReadyToTest={ip:function(e){return optly.client.rum.instance.recordEvent("checkGeo"),null!==condition.facade.getIP()},location:function(e){return optly.client.rum.instance.recordEvent("checkGeo"),null!==condition.facade.getLocation()},list:function(e){var t=e.dimension_id;return null!==condition.facade.getListMembershipStatus(data.getDimensionName(t)||"")},dynamic_customer_profile:function(e){var t=condition.facade.getDynamicCustomerProfileConditions();return isNonNullObject(t)&&e.value in t}},condition.hasMatch=function(e,t,i){var n=isDefined(i)&&null!==i,r=isDefined(e)&&null!==e;switch(t||(r?"exact":"exists")){case"exists":return n;case"exact":return n&&String(i)===e;case"substring":return n&&containsString(String(i),e);case"regex":try{if(r&&n){var a=new RegExp(e);return containsRegEx(String(i),a)}return!1}catch(e){return!1}case"range":var o=e.split(":"),s=parseFloat(o[0]),c=parseFloat(o[1]),l=parseFloat(i);return s<=l&&l<=c;default:return!1}},template.evaluate=function(e){e=$.trim(e);var t="";if(window[GLOBAL]&&window[GLOBAL][GLOBAL_DATA]){var i=e.match(template.URL_PARAM_REGEX);if(i){var n=i[1],r=window[GLOBAL][GLOBAL_DATA].visitor.params[n];void 0===r&&(r=""),t=r}else{for(var a=e.split("."),o=window[GLOBAL],s=0,c=a.length;s<c;s++)if(null==(o=o[a[s]])){o="";break}t=""+o}}return timer.addEvent("Template",e+" evaluated to: '"+t+"'"),t},template.render=function(e){return e.replace(template.TEMPLATE_REGEX,template.replacer)},template.replacer=function(e,t){return template.evaluate(t)},template.TEMPLATE_REGEX=/\{\{ *optimizely\.([^\n\r{}<>]*)\}\}/g,template.URL_PARAM_REGEX=/^data\.visitor\.params\.(.*)$/,feature_detect.requiredFeatures=[function(){var e=detect.detect();if("ie"===e.browserId){try{var t=Number(e.browserVersion)}catch(e){return}if(t<7)throw new Error("IE is only supported on version 8+ (detected "+t+")");if(t<8&&"windows"===e.platform.id&&e.platform.version&&arrayContains(["xp","vista"],e.platform.version.toLowerCase()))throw new Error("IE7 is not supported")}},function(){return json.parse(json.stringify({a:123}))}],feature_detect.check=function(){var t=[];if(each(feature_detect.requiredFeatures,function(e){try{e()}catch(e){t.push(e.message)}}),0<t.length)throw new Error("Feature(s) not supported: "+t.join("; "))},optly.client.diagnostic.ENABLED=!1,plan.CodeStep,plan.EventStep,plan.Step,plan.addChangeHandler=function(e){plan.changeHandlers.push(e)},plan.addVariation=function(e,t,i,n){i=!0===i,n=!0===n;var r=!1,a=data.getVariationExperimentId(e);if(a&&(n||!plan.containsExperiment(a))){if(r=!0,n&&plan.containsExperiment(a))for(var o=0;o<plan.variations.length;o++)plan.variations[o].experimentId===a&&plan.variations.splice(o,1);plan.variations.push({experimentId:a,id:e,source:t}),i&&evaluator.enqueue(a),plan.variationExperimentIds[a]=!0,plan.callChangeHandlers(),timer.addEvent("Plan","Added experiment "+a+" and variation id "+e+" to the plan, source is "+t,!0)}return r},plan.buildMultivariateId=function(e,t){for(var i=[],n=data.getExperimentSectionIds(e),r=0;r<n.length;r++){var a=t[n[r]];if(a===IGNORED_VARIATION_ID)return"";i.push(a)}return i.join(VARIATION_ID_DELIMITER)},plan.containsExperiment=function(e){return e in plan.ignoredExperimentIds||e in plan.variationExperimentIds},plan.filterUrlSpecificVariationCode=function(e){for(var t=e.split(VARIATION_CODE_DELIMITER),i=[],n=!0,r=0,a=t.length;r<a;r++){var o=$.trim(t[r]);if(o===VARIATION_URL_END)n=!0;else if(""!==o){var s=VARIATION_URL_START_RE.exec(o);if(s&&13===s.length){var c=s[2]?s[2].split(VARIATION_URL_DELIMITER):[],l=s[4]?s[4].split(VARIATION_URL_DELIMITER):[],d=s[6]?s[6]:"substring",u=s[8]?s[8].split(VARIATION_URL_DELIMITER):[],g=s[10]?s[10].split(VARIATION_URL_DELIMITER):[];if(0<c.length){var p=plan.zipConditions(c,u,d);n=condition.testUrls(p)}if(n&&0<l.length){var m=plan.zipConditions(l,g,d);n=!condition.testUrls(m)}}else n&&i.push(o)}}return i.join(VARIATION_CODE_DELIMITER)},plan.getProjectClickGoalWithCustomTargetingSteps=function(e){for(var t=data.getProjectClickGoalsWithCustomTargeting(),i=0,n=t.length;i<n;i++){var r={eventName:t[i].event_name,selector:t[i].selector,type:"event '"+t[i].event_name+"' (click goal)",waitUntilSelectorReady:!0};"revenue"in t[i]&&(r.revenue=t[i].revenue),e.push(r)}},plan.getSteps=function(e){void 0===e?e=[]:isNumberLike(e)&&(e=[e]),e=e;var t=plan.getVariationIds(e),i=[],n=[],r=[],a=[];plan.getProjectClickGoalWithCustomTargetingSteps(i),each(e,function(e){plan.getExperimentSteps(e,i,r,n,a)}),each(t,function(e){plan.getVariationSteps(e,n,a)});var o=[];return appendArray(o,n),appendArray(o,r),appendArray(o,a),appendArray(o,i),o},plan.getVariationId=function(t){var i=null;return each(plan.variations,function(e){t==e.experimentId&&(i=e.id)}),i},plan.getVariationIds=function(t){var i=[],n=!isDefined(t);return t=t||[],each(plan.variations,function(e){(n||arrayContains(t,e.experimentId))&&i.push(e.id)}),i},plan.ignoreExperiment=function(e,t){!(t=!0===t)&&plan.containsExperiment(e)||(plan.ignoredExperimentIds[e]=!0,plan.callChangeHandlers())},plan.isExperimentIgnored=function(e){return e in plan.ignoredExperimentIds},plan.removeExperiment=function(e){plan.ignoredExperimentIds[e]&&delete plan.ignoredExperimentIds[e],plan.variationExperimentIds[e]&&delete plan.variationExperimentIds[e];for(var t=0;t<plan.variations.length;t++)plan.variations[t].experimentId===e&&plan.variations.splice(t,1);plan.callChangeHandlers()},plan.log=function(){directive.shouldLog&&(each(plan.ignoredExperimentIds,function(e){var t=data.getExperimentName(e);timer.addEvent("Plan","Ignore experiment '"+t+"' ("+e+")")}),each(plan.variations,function(e,t){var i=data.getVariationExperimentId(e.id),n=data.getVariationName(e.id);timer.addEvent("Plan",data.getExperimentString(i)+' in variation "'+n+'" ('+e.id+")")}))},plan.readCookie=function(){var t=cookie.get(BUCKET_COOKIE_NAME);if(t){try{t=json.parse(t)}catch(e){t={}}var n={};each(t,function(e,t){t=String(t);var i=data.getVariationExperimentId(t);1<data.getExperimentSectionIds(i).length&&-1===t.indexOf(VARIATION_ID_DELIMITER)?(n[i]=n[i]||{},n[i][e]=t):t!==IGNORED_VARIATION_ID?plan.addVariation(t,"cookie",!1)||(plan.foreignBucketMap[e]=t):plan.ignoreExperiment(e)}),each(n,function(e,t){var i=plan.buildMultivariateId(e,t);0<i.length?plan.addVariation(i,"cookie",!1):plan.ignoreExperiment(e)})}},plan.writeCookie=function(){var i={};each(plan.foreignBucketMap,function(e,t){i[e]=t}),each(plan.variations,function(e){var t=data.getVariationExperimentId(e.id);i[t]=e.id}),each(plan.ignoredExperimentIds,function(e){i[e]=IGNORED_VARIATION_ID}),each(data.getBlacklistedExperiments(),function(e){e in i&&delete i[e]}),cookie.set(BUCKET_COOKIE_NAME,json.stringify(i),directive.trackingCookieExpiration)},plan.callChangeHandlers=function(){each(plan.changeHandlers,function(e){e()})},plan.getExperimentSteps=function(i,n,e,t,r){each(data.getExperimentEvents(i),function(t,e){each(e,function(e){n.push({eventName:e.eventName,experimentIds:e.experimentIds,revenue:e.revenue,selector:t,type:"event '"+e.eventName+"' (experiment "+i+")",waitUntilSelectorReady:!0})})});var a=data.getExperimentCss(i);a&&e.push({code:function(){$("body").append("<style>"+a+"</style>")},selector:"body",type:"global css (experiment "+i+")",waitUntilSelectorReady:!0});var o=data.getExperimentSteps(i);if(o)each(o.forced,function(e){t.push(e)}),each(o.safe,function(e){r.push(e)});else{var s=data.getExperimentCode(i);s&&plan.appendStepsFromCode(s,t,r)}},plan.getVariationSteps=function(e,t,i){var n=data.getVariationPages(e);if(n)each(n,function(e){!e.steps||e.includes&&!condition.testUrls({values:e.includes})||e.excludes&&condition.testUrls({values:e.excludes})||(t.push.apply(t,e.steps.forced),i.push.apply(i,e.steps.safe))});else{var r=data.getVariationCode(e);r=plan.filterUrlSpecificVariationCode(r),plan.appendStepsFromCode(r,t,i,e)}},plan.appendStepsFromCode=function(e,t,i,n){if(containsString(e,"_optimizely_redirect"))t.push({code:e,type:"code forced (redirect)",variationId:n});else{for(var r=e.split("\n"),a=!1,o=!1,s=[],c=plan.jQueryExpression,l=plan.rearrangeExpression,d=[];0<r.length;){var u=trim(r.shift()),g=0<d.length;if(u){if(containsRegEx(u,/_optimizely_evaluate\s{0,9}=\s{0,9}force/i)){o=!0;continue}if(containsRegEx(u,/_optimizely_evaluate\s{0,9}=\s{0,9}safe/i)||containsRegEx(u,/_optimizely_evaluate\s{0,9}=\s{0,9}end_force/i)){o=!1;continue}if(containsRegEx(u,/_optimizely_evaluate\s{0,9}=\s{0,9}editor_only/i)){a=!0;continue}if(containsRegEx(u,/_optimizely_evaluate\s{0,9}=\s{0,9}end_editor_only/i)){a=!1;continue}if(plan.commentRegex.exec(u))continue;if(a)continue;if(o)s.push(u);else{if(!g){var p=c.exec(u),m=[];if(p){m.push(p[1].replace(/^['"]|['"]$/g,""));var v=l.exec(u);v&&4<v.length&&m.push(v[4]),i.push({code:u,selector:m,type:"safe jquery",waitUntilSelectorReady:!0,variationId:n})}else g=!0}g&&d.push(u)}}}0<s.length&&t.push({code:s.join("\n"),type:"forced evaluation",variationId:n}),0<d.length&&i.push({code:d.join("\n"),type:"safe non-jquery",waitUntilDocumentReady:!0,variationId:n})}},plan.reset=function(){timer.addEvent("Plan","Resetting visitor buckets"),plan.foreignBucketMap={},plan.ignoredExperimentIds={},plan.variationExperimentIds={},plan.variations=[],plan.writeCookie()},plan.zipConditions=function(e,t,i){for(var n={values:[]},r=0,a=e.length;r<a;r++)n.values.push({value:e[r],match:t[r]||i});return n},plan.changeHandlers=[],plan.foreignBucketMap={},plan.ignoredExperimentIds={},plan.rearrangeExpression=/^\$j?\(['"](.+?)['"]\)\.detach\(\)\.(appendTo|insertAfter|insertBefore|prependTo)\(['"](.+?)['"]\);(?:\s|(?:\/\/.*|\/\*(?:[^*]|\*(?!\/))*\*\/))*$/,plan.commentRegex=/^(?:\s|(?:\/\/.*|\/\*(?:[^*]|\*(?!\/))*\*\/))*$/,plan.jQueryExpression=/^\$j?\((['"].+?['"]|document)\)\..+;(?:\s|(?:\/\/.*|\/\*(?:[^*]|\*(?!\/))*\*\/))*$/,plan.variationExperimentIds={},plan.variations=[],iapi.evaluateSegments=function(e){segmenter.reset(),segmenter.initialize(e)},iapi.initialize=function(e){window[GLOBAL].iapi={evaluateSegments:goog.partial(iapi.evaluateSegments,e)}},evaluator.bindTrackElementFromApi=function(e,t){if(e&&t)if(evaluator.isDocumentReady)timer.addEvent("Evaluator","Bound event "+t+" to selector "+e),evaluator.bindTrackElement(e,t);else{var i={eventName:t,selector:e,type:"event '"+t+"' (click goal)",waitUntilSelectorReady:!0};timer.addEvent("Evaluator","Add step to bind event "+i.eventName+" to selector "+i.selector),evaluator.steps.push(i)}},evaluator.evaluate=function(e,t){if(directive.isEnabled){isArrayLike(e)?evaluator.tellPreviewAboutExperiments(e):(e=[],evaluator.tellPreviewAboutExperiments(t)),e=e.concat(evaluator.evaluateQueue),evaluator.evaluateQueue=[];for(var i=0;i<e.length;i++)arrayContains(evaluator.evaluatedExperimentIds,e[i])||evaluator.evaluatedExperimentIds.push(e[i]);var n=plan.getSteps(e);appendArray(evaluator.steps,n),evaluator.doSteps()}},evaluator.doSteps=function(){var e=!1;for(evaluator.timeoutId=null,timer.addEvent("Evaluator",evaluator.waitCount+" times waited");!e&&0<evaluator.steps.length;){timer.addEvent("Evaluator",evaluator.steps.length+" steps remaining");var t=evaluator.steps.shift();if(e=evaluator.shouldWaitBeforeStep(t))evaluator.steps.unshift(t);else if(t.eventName){evaluator.doneWithSafeSteps(),timer.addEvent("Evaluator","Bound event "+t.eventName+" to selector "+t.selector);var i={};t.revenue&&(i={revenue:t.revenue,experimentIds:t.experimentIds}),evaluator.bindTrackElement(t.selector,t.eventName,i)}else t.code&&(timer.addEvent("Evaluator","Run code: "+t.code.toString()),evaluator.evaluateCode(t.code,t.variationId))}if(e){var n=0===evaluator.waitCount?FIRST_EVALUATION_WAIT_INTERVAL:EVALUATION_WAIT_INTERVAL;evaluator.timeoutId=setTimeout(evaluator.doSteps,n),evaluator.waitCount++}else timer.addEvent("Evaluator",evaluator.waitCount+" total times waited"),evaluator.doneWithSafeSteps()},evaluator.executeCode=function(fnOrCode){return"string"==typeof fnOrCode?eval(fnOrCode):fnOrCode()},evaluator.doneWithSafeSteps=function(){optly.client.rum.instance.recordEvent("flash"),activator.hasDelayedExperiments()||optly.client.rum.instance.recordEvent("flashGeo")},evaluator.enqueue=function(e){evaluator.evaluateQueue=evaluator.evaluateQueue||[],evaluator.evaluateQueue.push(e)},evaluator.getActiveExperimentIds=function(){return evaluator.evaluatedExperimentIds.concat(evaluator.evaluateQueue)},evaluator.getEvaluatedExperimentIds=function(){return evaluator.evaluatedExperimentIds},evaluator.isInQueue=function(e){return inArray(e,evaluator.evaluateQueue)},evaluator.evaluateProjectCode=function(){var e=data.getProjectCode();e&&(timer.addEvent("Evaluator","Running project level javascript."),evaluator.evaluateCode(e))},evaluator.evaluateCode=function(fn,variationId){if(fn){var isStringCode=!1,code;if("string"==typeof fn?(code=fn,isStringCode=!0):code=fn.toString(),redirect.getRedirectURL(code)){if(timer.addEvent("Evaluator","Redirect detected"),!redirect.okToRedirect(code))return void timer.addEvent("Evaluator","NOT OK to redirect");timer.addEvent("Evaluator","OK to redirect");var noCookieRedirect=redirect.detectNoCookieRedirect(code);timer.addEvent("Evaluator","setting a redirect cookie"+(variationId?" for variation: "+variationId:"")),redirect.setRedirectCookie(noCookieRedirect,variationId),redirect.setReferrerCookie()}isStringCode&&eval("var $j = $;");try{if(redirect.getRedirectURL(code)){$("head").append("<style type='text/css'>body{display:none;visibility:hidden;}</style>"),timer.addEvent("Evaluator","Hiding body before redirect");var isStandardRedirect=redirect.redirectRegexParams.test(code)||redirect.redirectRegex.test(code)||redirect.redirectRegexLegacy.test(code),keepBodyHidden=/_keep_body_hidden=(\S+)/.test(code);isStandardRedirect||keepBodyHidden?timer.addEvent("Evaluator","Standard redirect detected - Will not unhide body."):setTimeout(function(){document.body&&(document.body.style.visibility="visible",document.body.style.display="block",timer.addEvent("Evaluator","Unhiding body -- did not redirect"),optly.client.rum.instance.recordEvent("bodyUnhidden"))},1700)}evaluator.executeCode(fn)}catch(e){var shouldLog=directive.shouldLog;directive.shouldLog=!0,timer.addEvent("Evaluator","Error: "+e.message),timer.addEvent("Evaluator","Code: "+code),directive.shouldLog=shouldLog,timer.addEvent("Evaluator","Failed to run code: "+e.message)}}},evaluator.bindTrackElement=function(e,t,i){if(i=i||{},!evaluator.alreadyBoundClickTrackingEvents[e]||!evaluator.alreadyBoundClickTrackingEvents[e][t]){var n=function(e){tracker.addLogEvent(t,"custom",i)},r="touchmove",a="touchend",o="touchstart",s=$(e);if(0<s.length){var c=function(){s.unbind(a,n),s.unbind(r,c),s.unbind("mousedown",n)},l=function(){c(),s.bind(r,c),s.bind(a,n)};s.bind("mousedown",n),s.bind(o,l)}else{s=$("html");c=function(){s.undelegate(e,a,n),s.undelegate(e,r,c),s.undelegate(e,"mousedown",n)},l=function(){c(),s.delegate(e,a,n),s.delegate(e,r,c)};s.delegate(e,"touchstart",l),s.delegate(e,"mousedown",n)}evaluator.alreadyBoundClickTrackingEvents[e]||(evaluator.alreadyBoundClickTrackingEvents[e]={}),evaluator.alreadyBoundClickTrackingEvents[e][t]="mousedown touchstart"}},evaluator.handleDocumentReady=function(e){optly.client.rum.instance.recordEvent("docReady"),evaluator.isDocumentReady=!0,null!==evaluator.timeoutId&&(timer.addEvent("Evaluator","Document is ready"),clearTimeout(evaluator.timeoutId),0<evaluator.delayDomExecuteMilliseconds?setTimeout(evaluator.doSteps,evaluator.delayDomExecuteMilliseconds):evaluator.doSteps())},evaluator.setDelayDomExecute=function(e){evaluator.delayDomExecuteMilliseconds=e},evaluator.shouldWaitBeforeStep=function(e){var t=!1;if(e.waitUntilDocumentReady&&!evaluator.isDocumentReady)timer.addEvent("Evaluator","Document not ready yet"),t=!0;else if(e.waitUntilSelectorReady&&!evaluator.isDocumentReady){var i=e.selector;if(i){i=isArrayLike(i)?i:[i];for(var n=0;n<i.length;n++){var r=i[n];if(null!=r&&r.length)0===$("document"==r?document:r).length&&(timer.addEvent("Evaluator","'"+r+"' not found"),t=!0)}}}return t},evaluator.tellPreviewAboutExperiments=function(e){e||(e=data.getExperimentIds());for(var t=0;t<e.length;t++){var i=e[t],n=optly.client.preview.Logger.getReason(i);n?(optly.client.preview.Logger.addEvent("Not activating "+data.getExperimentString(i)+" because "+n+".",{type:"explanation"}),optly.client.preview.Logger.deleteReason(i)):optly.client.preview.Logger.addEvent("Activating "+data.getExperimentString(i)+".",{type:"activation",experimentId:i})}},evaluator.alreadyBoundClickTrackingEvents={},evaluator.evaluatedExperimentIds=[],evaluator.evaluateQueue=evaluator.evaluateQueue||[],evaluator.delayDomExecuteMilliseconds=0,evaluator.isDocumentReady=!1,evaluator.steps=[],evaluator.timeoutId=null,evaluator.waitCount=0,$(function(){setTimeout(function(){evaluator.handleDocumentReady()},50)}),optly.CIDR=function(e){this.cidrString=$.trim(e);var t=optly.CIDR.parseCIDR(this.cidrString);if(null===t)throw new Error("Invalid CIDR specification");this.maskedAddress=t.maskedAddress,this.mask=t.mask},optly.CIDR.IP,optly.CIDR.NetworkMask,optly.CIDR.NUM_IP_OCTETS=4,optly.CIDR.prototype.containsIP=function(e){var t=optly.CIDR.parseIP(e);if(null===t)throw new Error("Invalid ip: "+e);for(var i=0;i<optly.CIDR.NUM_IP_OCTETS;i++)if((t[i]&this.mask[i])!==this.maskedAddress[i])return!1;return!0},optly.CIDR.parseCIDR=function(e){var t=e.split("/");if(2!=t.length)return null;var i=parseInt(t[1],10);if(isNaN(i)||i<0||32<i)return null;var n=optly.CIDR.parseIP(t[0]);if(null===n)return null;for(var r=optly.CIDR.makeMask(i),a=0;a<optly.CIDR.NUM_IP_OCTETS;a++)n[a]=n[a]&r[a];return{maskedAddress:n,mask:r}},optly.CIDR.parseIP=function(e){var t=e.split(".");if(t.length!=optly.CIDR.NUM_IP_OCTETS)return null;for(var i=[],n=0;n<optly.CIDR.NUM_IP_OCTETS;n++){var r=optly.CIDR.parseOctet(t[n]);if(null===r)return null;i[n]=r}return i},optly.CIDR.parseOctet=function(e){if(3<e.length)return null;var t=parseInt(e,10);return isNaN(t)?null:e!==t.toString()?null:t<0||255<t?null:t},optly.CIDR.ONES_LOOKUP_TABLE=[0,128,192,224,240,248,252,254,255],optly.CIDR.makeMask=function(e){if(e<0||32<e)return null;for(var t=[],i=0;i<optly.CIDR.NUM_IP_OCTETS;i++)t[i]=0;var n=Math.floor(e/8),r=e%8;for(i=0;i<n;i++)t[i]=255;return n<optly.CIDR.NUM_IP_OCTETS&&(t[n]=optly.CIDR.ONES_LOOKUP_TABLE[r]),t},optly.match.matchUrl=function(e,t,i){switch(e=optly.match.stripVarFromQuery(e),i){case"exact":return(e=optly.match.stripUrl(e))===optly.match.stripUrl(t);case"regex":try{return Boolean(e.match(t))}catch(e){return!1}case"simple":return(e=optly.match.simplifyUrl(e))===(t=optly.match.simplifyUrl(t));case"substring":return e=optly.match.stripUrl(e,!0),t=optly.match.stripUrl(t,!0),-1!==e.indexOf(t);default:return!1}},optly.match.removeParameters=function(e){var t=e.indexOf("?");return-1!==t&&(e=e.substring(0,t)),-1!==(t=e.indexOf("#"))&&(e=e.substring(0,t)),e},optly.match.simplifyUrl=function(e){return optly.match.stripUrl(optly.match.removeParameters(e))},optly.match.stripUrl=function(e,t){e=(e=e.replace("/?","?")).toLowerCase().replace(/[/&?]+$/,"");var i=optly.match.REQUIRED_PREFIXES_TO_STRIP.slice(0);t||(i=i.concat(optly.match.OPTIONAL_PREFIXES_TO_STRIP));for(var n=i.length,r=0;r<n;r++){var a=i[r],o=new RegExp("^"+a);e=e.replace(o,"")}return e},optly.match.stripVarFromQuery=function(e){var t=e.split("?");if(t[1]){var i=t[1].split("&"),n=[];return $.each(i,function(){0!==this.indexOf(optly.match.QUERY_PREFIX)&&n.push(this)}),t[1]=n.join("&"),t.join("?")}return e},optly.match.REQUIRED_PREFIXES_TO_STRIP=["https?://.*?.?optimizelyedit.(com|test)/","https?://.*.?optimizelypreview.(com|test)/","https?://(edit|preview)(-hrd|-devel)?.optimizely.(com|test)/","https?://.*?.?optimizelyedit(-hrd)?.appspot.com/","https?://"],optly.match.OPTIONAL_PREFIXES_TO_STRIP=["www."],optly.match.QUERY_PREFIX="optimizely_",optly.taint.createDeconstructingFunction=function(n){return function(e){if("object"==typeof e&&optly.taint.isObjectPrototypeTainted()){var t=null;for(var i in e)e.hasOwnProperty(i)&&(t=n.call(this,i,e[i]));return t}return n.apply(this,arguments)}},optly.taint.createCleanJQueryEach=function(r,a){return function(e,t,i){if((void 0===e.length||a.isFunction(e))&&optly.taint.isObjectPrototypeTainted()){if(i){for(var n in e)if(e.hasOwnProperty(n)&&!1===t.apply(e[n],i))break}else for(var n in e)if(e.hasOwnProperty(n)&&!1==!t.call(e[n],n,e[n]))break}else r.apply(this,arguments);return e}},optly.taint.createCleanJQueryInit=function(n,o){var s=function(e,t,i){return new n(e,t,i)},c=optly.nativity.getNativeGetElementsByClassName();return function(e,t,i){var n=s,r=document.getElementsByClassName;if(!optly.nativity.isNativeFunction(r)&&c&&(n=function(e,t,i){document.getElementsByClassName=c;var n=s(e,t,i);return document.getElementsByClassName=r,n}),"string"==typeof e&&t&&"object"===o.type(t)&&optly.taint.isObjectPrototypeTainted()){var a=n(e,void 0,i);return a.attr(t),a}return n(e,t,i)}},optly.taint.fixJQueryTaintIssues=function(e){e.fn.attr=optly.taint.createDeconstructingFunction(e.fn.attr),e.fn.css=optly.taint.createDeconstructingFunction(e.fn.css),e.fn.extend=optly.taint.createDeconstructingFunction(e.fn.extend),e.each=optly.taint.createCleanJQueryEach(e.each,e),e.fn.init=optly.taint.createCleanJQueryInit(e.fn.init,e)},optly.taint.isObjectPrototypeTainted=function(){for(var e in{})return!0;return!1},main=function(){TEST_MODULE||optly.taint.fixJQueryTaintIssues($),timer.addEvent("Main","Started, revision "+data.getRevision());try{feature_detect.check()}catch(e){return void timer.addEvent("Main","Disabling: "+e.message)}if(query.process(),(directive.isEditor||directive.isPersonalizationEditor)&&(window.optimizelyDataApi={getProjectId:data.getProjectId}),directive.isDesktopAppEditor)timer.addEvent("Main","Disabling because in desktop app editor.");else{if(directive.isPersonalizationEditor)return timer.addEvent("Main","Disabling because personalization editor flag is set."),void loadScript("https://"+data.getWebHost()+"/js/innie.js?_="+ +new Date);if(api.initializePriorityOneApiCalls(),tracker.isOptedOut())return timer.addEvent("Main","Disabling because opted out"),void timer.flushLogs();!optly.client.preview.ENABLED||directive.previewVerified?!directive.previewScriptName||optly.client.preview.ENABLED?optly.client.preview.ENABLED||!directive.shouldLoadPreview||directive.previewScriptName?(directive.isSomeClientEnabled()&&evaluator.evaluateProjectCode(),api.initializePriorityOneApiCalls(),user.initialize(),asyncInfo.loadFromStore(),data.isListTargetingEnabled()&&asyncRequest.makeListTargetingRequest(),data.isDynamicCustomerProfileTargetingEnabled()&&asyncRequest.makeDynamicCustomerProfileTargetingRequest(),null!==data.getDCPServiceId()&&setTimeout(function(){dcp.alias(asyncInfo.dcpCache)},0),plan.readCookie(),segmenter.initialize(),redirect.initialize(),visitor.initialize(),api.initialize(visitor),optly.client.rum.instance.recordEvent("apiInitialize"),iapi.initialize(),query.processForceParameters(),directive.requestedInvalidForceParameters?preview_loader.loadSplashScreen("Force parameters are disabled for this project. See Project Code Settings."):(main.log(),directive.isEditor&&loadScript("https://"+data.getWebHost()+"/js/innie.js?_="+ +new Date),directive.isEnabled&&(distributor.distributeAll(),plan.writeCookie(),tracker.enableEngagementTracking(),directive.shouldSkipPageTracking||(0<directive.delayPageviewTracking?setTimeout(function(){tracker.addActivationEvent(document.location.href)},directive.delayPageviewTracking):tracker.addActivationEvent(document.location.href)),tracker.sendLogEvents(),integrator.makeThirdPartyRequests()),plan.log(),directive.isEditor?api.finalize():directive.isEnabled&&(optly.client.rum.instance.recordEvent("beginEvaluate"),evaluator.evaluate(),api.finalize(),timer.flushLogs(),data.isInstallationVerified()||tracker.sendVerificationRequest()),setTimeout(function(){activator.activateGeoDelayedExperiments(api.visitor)},GEO_TIMEOUT),setTimeout(function(){!optly.client.preview.ENABLED&&directive.shouldTrackEvents&&optly.client.rum.instance.sendRum()},GEO_TIMEOUT+1e3),timer.addEvent("Main","End of main"),optly.client.rum.instance.recordEvent("mainEnd"))):preview_loader.loadSplashScreen("This preview link has expired. Please return to Optimizely and preview again to get a new link."):preview_loader.loadPreview():timer.addEvent("Main","Disabling because preview project not verified.")}},main.log=function(){timer.addEvent("Info","Is Classic Optimizely enabled: "+directive.isEnabled),timer.addEvent("Info","Diagnostic enabled: "+optly.client.diagnostic.ENABLED),timer.addEvent("Info","Force variation enabled: "+data.isForceVariationEnabled()),timer.addEvent("Info","Browser type: "+user.getBrowserId()),timer.addEvent("Info","Browser version: "+user.getBrowserVersion());var e=user.getMobileId();"unknown"!==e&&timer.addEvent("Info","Mobile browser type: "+e),timer.addEvent("Info","New vs returning: "+user.getNewVsReturning()),timer.addEvent("Info","Source type: "+segmenter.getSourceType()),timer.addEvent("Info","User ID: "+id.getOrGenerateId())};var catchMain=optly.client.diagnostic.ENABLED?function(){try{main()}catch(e){tracker.sendErrorLog(e)}}:main;optly.client.preview.ENABLED||catchMain()},SLAVE_CLIENT={optimizely:[]};optimizelyCode(),optly.Cleanse.finish()}();